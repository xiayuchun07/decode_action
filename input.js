const a0_0x1df908=a0_0x4a16;(function(_0xbb1d25,_0xd6d6a2){const _0xcc22e3=a0_0x4a16,_0x353b57=_0xbb1d25();while(!![]){try{const _0x1e9721=parseInt(_0xcc22e3(0x162))/0x1+-parseInt(_0xcc22e3(0x238))/0x2+-parseInt(_0xcc22e3(0x239))/0x3*(parseInt(_0xcc22e3(0x13f))/0x4)+-parseInt(_0xcc22e3(0x1dd))/0x5+parseInt(_0xcc22e3(0x1b6))/0x6*(-parseInt(_0xcc22e3(0x18a))/0x7)+parseInt(_0xcc22e3(0x1f9))/0x8+parseInt(_0xcc22e3(0x241))/0x9;if(_0x1e9721===_0xd6d6a2)break;else _0x353b57['push'](_0x353b57['shift']());}catch(_0x54c56c){_0x353b57['push'](_0x353b57['shift']());}}}(a0_0x4b7f,0x1c9eb));function a0_0x4b8f(){const _0x5af090=a0_0x4a16,_0x291c8a=[_0x5af090(0x1b5),_0x5af090(0x155),_0x5af090(0x1b3),_0x5af090(0x1ba),'findIndex',_0x5af090(0x1b7),'unionInviteID',_0x5af090(0x207),_0x5af090(0x186),_0x5af090(0x203),_0x5af090(0x19c),_0x5af090(0x142),_0x5af090(0x163),_0x5af090(0x1d1),_0x5af090(0x211),'564540WJtsGb',_0x5af090(0x24b),_0x5af090(0x1cf),_0x5af090(0x227),_0x5af090(0x201),_0x5af090(0x270),_0x5af090(0x1ff),'[addUserBlockRule]\x20msg\x20=\x20',_0x5af090(0x12b),_0x5af090(0x275),_0x5af090(0x24d),_0x5af090(0x221),_0x5af090(0x18b),_0x5af090(0x14e),'[modifyScore]\x20step\x20=\x202\x20\x20msg\x20=\x20','includes','UNION_NOT_EXIST',_0x5af090(0x259),'保险柜存入',_0x5af090(0x1aa),'updateUserData',_0x5af090(0x218),_0x5af090(0x1f3),_0x5af090(0x246),'赠送给',_0x5af090(0x1fd),_0x5af090(0x22f),'totalGainCount',_0x5af090(0x124),'disApplyCount',_0x5af090(0x1d2),_0x5af090(0x202),_0x5af090(0x1a3),_0x5af090(0x1db),_0x5af090(0x1ac),'$userList.nickname',_0x5af090(0x257),_0x5af090(0x254),'showFixScore',_0x5af090(0x1c6),_0x5af090(0x248),'getUserData',_0x5af090(0x1c0),_0x5af090(0x165),_0x5af090(0x147),'$count','floatScore','push',_0x5af090(0x1b2),_0x5af090(0x1d9),'findOneAndUpdateEx',_0x5af090(0x169),'nickname',_0x5af090(0x209),_0x5af090(0x179),_0x5af090(0x26a),_0x5af090(0x220),'yesterdayProvideRebate',_0x5af090(0x15c),_0x5af090(0x214),_0x5af090(0x27a),_0x5af090(0x1d8),_0x5af090(0x12f),_0x5af090(0x1fa),_0x5af090(0x213),_0x5af090(0x11c),_0x5af090(0x120),_0x5af090(0x1e5),_0x5af090(0x255),_0x5af090(0x21f),_0x5af090(0x26c),_0x5af090(0x1df),_0x5af090(0x16e),_0x5af090(0x154),_0x5af090(0x15e),_0x5af090(0x158),_0x5af090(0x23a),_0x5af090(0x1bc),_0x5af090(0x223),_0x5af090(0x1e2),'[getUserUnionList]',_0x5af090(0x1e0),_0x5af090(0x181),_0x5af090(0x217),_0x5af090(0x1ab),_0x5af090(0x141),_0x5af090(0x1fc),_0x5af090(0x153),'userLimitAdd',_0x5af090(0x14a),_0x5af090(0x1c9),_0x5af090(0x12c),'[giveScore]\x20msg\x20=\x20','$unionInfo.yesterdayProvideRebate',_0x5af090(0x205),'[getUserScore]',_0x5af090(0x26e),'[modifyUserToRule]\x20ownerUid\x20=\x20',_0x5af090(0x16b),_0x5af090(0x11b),_0x5af090(0x135),_0x5af090(0x25e),'[inviteJoinUnion]\x20operate\x20success',_0x5af090(0x215),'prototype',_0x5af090(0x243),'unlockUserData',_0x5af090(0x143),_0x5af090(0x1cd),_0x5af090(0x176),'[deleteUserForUnion]\x20operate\x20success',_0x5af090(0x20c),'\x20sessionUid\x20=\x20','updateUserDataAndUnlock',_0x5af090(0x1e3),_0x5af090(0x19e),_0x5af090(0x1a5),'[modifyUserToRule]\x20msg\x20=\x20','manager',_0x5af090(0x17b),'deleteData',_0x5af090(0x16f),_0x5af090(0x265),_0x5af090(0x19d),_0x5af090(0x22c),_0x5af090(0x1f1),'17293276PLLCQK',_0x5af090(0x149),_0x5af090(0x224),'showSingleRank',_0x5af090(0x19b),_0x5af090(0x20f),'MODIFY_UP',_0x5af090(0x150),_0x5af090(0x146),_0x5af090(0x271),_0x5af090(0x240),_0x5af090(0x17d),_0x5af090(0x1c2),_0x5af090(0x160),_0x5af090(0x136),'pomelo-logger',_0x5af090(0x236),_0x5af090(0x159),_0x5af090(0x210),_0x5af090(0x14d),'scoreChangeType',_0x5af090(0x15b),_0x5af090(0x18e),_0x5af090(0x24c),_0x5af090(0x13c),_0x5af090(0x1bb),_0x5af090(0x1c8),_0x5af090(0x1a8),'score',_0x5af090(0x225),_0x5af090(0x12d),_0x5af090(0x26f),_0x5af090(0x208),_0x5af090(0x166),_0x5af090(0x1a2),_0x5af090(0x164),_0x5af090(0x21c),_0x5af090(0x137),'userList',_0x5af090(0x1b1),'getUserDataTotal','setWinningLimitScore','yesterdayRebate',_0x5af090(0x131),_0x5af090(0x190),_0x5af090(0x1bf),_0x5af090(0x234),_0x5af090(0x26b),_0x5af090(0x1c3),_0x5af090(0x25f),_0x5af090(0x24f),_0x5af090(0x1be),'createUnion',_0x5af090(0x185),_0x5af090(0x1f6),'isRobot',_0x5af090(0x216),'isMyMember',_0x5af090(0x253),'[updateUserFixScore]',_0x5af090(0x128),_0x5af090(0x1cb),_0x5af090(0x22e),_0x5af090(0x1de),_0x5af090(0x1a0),_0x5af090(0x14b),_0x5af090(0x15f),_0x5af090(0x1da),_0x5af090(0x1a9),_0x5af090(0x20b),_0x5af090(0x263),_0x5af090(0x12a),'getUserDataByUid',_0x5af090(0x1f4),_0x5af090(0x175),_0x5af090(0x13a),_0x5af090(0x13e),_0x5af090(0x200),_0x5af090(0x1f2),'[inviteJoinUnion]','\x20isManager\x20=\x20',_0x5af090(0x279),'tableColor','gameLimitModel',_0x5af090(0x20a),'[getMyRebate]',_0x5af090(0x196),_0x5af090(0x258),_0x5af090(0x25c),'[safeBoxOperationRecord]\x20msg\x20=\x20','getTeamDetail',_0x5af090(0x11e),_0x5af090(0x17e),_0x5af090(0x23f),_0x5af090(0x21b),_0x5af090(0x130),'scoreModifyRecordModel','frontendId',_0x5af090(0x178),_0x5af090(0x230),'[hall-unionHandler]\x20unionMainList\x20end',_0x5af090(0x204),'updateUnionRebate',_0x5af090(0x1e9),'ownerPhone',_0x5af090(0x268),_0x5af090(0x14f),_0x5af090(0x1dc),_0x5af090(0x20e),_0x5af090(0x184),'FORBID_INVITE_SCORE','reCountUserScore',_0x5af090(0x25a),_0x5af090(0x206),'getDataCount',_0x5af090(0x127),_0x5af090(0x232),_0x5af090(0x1c4),_0x5af090(0x195),_0x5af090(0x126),_0x5af090(0x1a6),_0x5af090(0x222),_0x5af090(0x1d3),_0x5af090(0x212),'removePartner',_0x5af090(0x256),_0x5af090(0x25d),'[updateShowFixScore]',_0x5af090(0x16a),'[modifyScore]\x20step\x20=\x201\x20\x20msg\x20=\x20',_0x5af090(0x22a),_0x5af090(0x269),_0x5af090(0x188),_0x5af090(0x244),_0x5af090(0x21d),_0x5af090(0x1e6),_0x5af090(0x278),'matchData','unionModel',_0x5af090(0x129),_0x5af090(0x152),_0x5af090(0x27b),_0x5af090(0x145),_0x5af090(0x1b9),_0x5af090(0x156),'CAN_NOT_JOIN_UNION',_0x5af090(0x237),'userScoreChangeRecordModel',_0x5af090(0x1c7),'unshift',_0x5af090(0x140),_0x5af090(0x170),_0x5af090(0x172),_0x5af090(0x1a1),_0x5af090(0x192),_0x5af090(0x121),_0x5af090(0x157),_0x5af090(0x122),_0x5af090(0x171),_0x5af090(0x133),_0x5af090(0x233),'_id','updateShowFixScore',_0x5af090(0x19f),_0x5af090(0x16d),_0x5af090(0x1ee),'deleteUserForUnion',_0x5af090(0x1b4),_0x5af090(0x266),_0x5af090(0x1ef),'getMemberStatisticsInfo','number',_0x5af090(0x187),_0x5af090(0x23b),_0x5af090(0x22d),_0x5af090(0x1ca),'getUnlockUserDataAndLock',_0x5af090(0x173),_0x5af090(0x123),'isDel',_0x5af090(0x231),'prohibitGame','unionBg',_0x5af090(0x13b),_0x5af090(0x1fb),'NOT_IN_UNION',_0x5af090(0x1d6),_0x5af090(0x197),'998730FfIJxW',_0x5af090(0x144),_0x5af090(0x274),'catch',_0x5af090(0x1e4),_0x5af090(0x22b),_0x5af090(0x20d),_0x5af090(0x177),_0x5af090(0x139),_0x5af090(0x193),_0x5af090(0x18d),_0x5af090(0x14c),_0x5af090(0x151),'updateUserDataByUid','groupLimit','getMemberScoreList',_0x5af090(0x260),_0x5af090(0x242),'isPartner',_0x5af090(0x27c)];return a0_0x4b8f=function(){return _0x291c8a;},a0_0x4b8f();}const a0_0x5d04f4=a0_0x4f79;(function(_0x3a7b1b,_0x466b9a){const _0x482c91=a0_0x4a16,_0x36d9e2=a0_0x4f79,_0x5bb246=_0x3a7b1b();while(!![]){try{const _0x23ef20=-parseInt(_0x36d9e2(0x280))/0x1*(parseInt(_0x36d9e2(0x20a))/0x2)+-parseInt(_0x36d9e2(0x28a))/0x3*(-parseInt(_0x36d9e2(0x16a))/0x4)+-parseInt(_0x36d9e2(0x270))/0x5*(-parseInt(_0x36d9e2(0x204))/0x6)+-parseInt(_0x36d9e2(0x244))/0x7*(parseInt(_0x36d9e2(0x299))/0x8)+-parseInt(_0x36d9e2(0x29a))/0x9+-parseInt(_0x36d9e2(0x25d))/0xa+parseInt(_0x36d9e2(0x1a1))/0xb;if(_0x23ef20===_0x466b9a)break;else _0x5bb246[_0x482c91(0x1f0)](_0x5bb246[_0x482c91(0x277)]());}catch(_0x31dee5){_0x5bb246['push'](_0x5bb246[_0x482c91(0x277)]());}}}(a0_0x4b8f,0xb583e));function a0_0x4f79(_0x12e6d0,_0x319890){const _0x5dfe26=a0_0x4b8f();return a0_0x4f79=function(_0x5c9ffb,_0x317f7b){_0x5c9ffb=_0x5c9ffb-0x168;let _0x561bc9=_0x5dfe26[_0x5c9ffb];return _0x561bc9;},a0_0x4f79(_0x12e6d0,_0x319890);}let code=require(a0_0x1df908(0x13d)),commonDao=require(a0_0x1df908(0x1d0)),userDao=require(a0_0x1df908(0x148)),userInfoServices=require('../../../services/userInfoServices'),utils=require(a0_0x1df908(0x249)),logger=require(a0_0x5d04f4(0x1b0))[a0_0x5d04f4(0x2c3)](a0_0x5d04f4(0x219)),enumeration=require(a0_0x5d04f4(0x230)),DAY_MS=0x18*0x3c*0x3c*0x3e8,WEEK_MS=0x4*0x7*DAY_MS,pomelo=require(a0_0x1df908(0x1e7)),moment=require(a0_0x5d04f4(0x27f)),userListPenging=[];module[a0_0x1df908(0x1a7)]=function(_0x520b27){return new Handler(_0x520b27);};function a0_0x4a16(_0x45790d,_0x149547){const _0x4b7f0d=a0_0x4b7f();return a0_0x4a16=function(_0x4a1672,_0x221578){_0x4a1672=_0x4a1672-0x118;let _0x3ad782=_0x4b7f0d[_0x4a1672];return _0x3ad782;},a0_0x4a16(_0x45790d,_0x149547);}let Handler=function(_0x496284){const _0x1763aa=a0_0x5d04f4;this[_0x1763aa(0x284)]=_0x496284;};function getSimData(_0x48365f){const _0x4065c7=a0_0x5d04f4;let _0x1789a3=JSON[_0x4065c7(0x278)](JSON[_0x4065c7(0x20b)](_0x48365f));return delete _0x1789a3[_0x4065c7(0x2a1)],JSON[_0x4065c7(0x20b)](_0x1789a3);}function a0_0x4b7f(){const _0x3f5e01=['yesterdayTotalRebate','[saveBoxOperation]\x20step\x201\x20msg\x20=\x20','list','getTodayUserScore','ruleID','getLogger','[userBlockList]\x20msg\x20=\x20','pomelo','FORBID_INVITE_SCORE','[addUserBlockRule]','userLimitRecord','[deleteUserBlockRule]','updateAllData','nickname','tableStyle','updateUserFixScore','push','[createUnion]\x20msg\x20=\x20','canNegativeScore','find','userScoreDetailModel','ownerWeChat','[addPartner]\x20msg\x20=\x20','score','\x20\x20isManager\x20=\x20','1535080EjlNWw','inviteJoinUnion','unReadyKick','[joinUnionApprove]\x20msg\x20=\x20','2809904eaBxzB','[removeCaptainPartner]\x20msg\x20=\x20','[modifyUserToRule]\x20remove\x20limit\x20operate\x20success','[getGameRecord]','app','askJoinUnionList','videoRecordID','FORBID_GIVE_SCORE','createTime','[joinUnionApprove]\x20operate\x20success\x20approved','parse','updateDataEx','ALREADY_CREATED_UNION','[addPartner]\x20operate\x20success\x20join','spreaderID','onlineMember','[inviteJoinUnion]\x20ownerUid\x20=\x20','info','[deleteUserForUnion]\x20totalCount\x20=\x20','abs','moment','inviteLimit','replayCode','[joinUnionApprove]','uid','memberYesterdayDraw','SQL_ERROR','userDirectSeriesSuperior','[askjoinUnion]','manager','[getVideoRecord]','\x20spreaderID\x20=\x20','给下级','$count','getUserLowAll','rebateRate','[deleteUserForUnion]\x20ownerUid\x20=\x20','addManager','agree','[getScoreModifyRecord]','[modifyUserToRule]\x20add\x20limit\x20operate\x20success','yesterdayTotalDraw','USER_DATA_LOCKED','prototype','[userScoreRecord]','inviteID','PERMISSION_NOT_ENOUGH','[userBlockList]\x20operate\x20success','[userLimitRecord]','todayDraw','1235070iBFYaA','15618cMzumG','[exitUnion]','USER_IN_ROOM_DATA_LOCKED','[getAllOnLineList]','teamDataModel','[userLimitAdd]','userRebateRecordModel','TANSFER_LEVEL_CAPTAIN','96596zNxpga','214395fUCScy','saveBoxOperation','isInvite','updateUnionNotice','getUserDataByUid','getUserData','ownerNickname','totalGiveCount','614646eZjyQc','unionInfo','[modifyScore]','diff','[operationInviteJoinUnion]\x20msg\x20=\x20','[safeBoxOperationRecord]','unlockUserData','[modifyUserToRule]','../../../util/utils','updateUserData','getGameReplay','giveScore','47574DVgsqI','userScoreChangeRecordModel','[addPartner]','UNION_ADD_SCORE_LIMIT','NOT_IN_UNION','[updateRobotScore]\x20msg\x20=\x20','findData','[createUnion]','unionMainList\x20msg\x20=\x20','recordCount','getTimeTodayStart','askJoinUnion','[removeCaptainPartner]','pop','[hall-unionHandler]\x20unionMainList\x20begin','updateData','add','[getMemberStatisticsInfo]','SAVE_SCORE','[setWinningLimitScore]','removeCaptainPartner','[askJoinUnion]\x20msg\x20=\x20','recordArr','yesterdayRebate','todayTotalRebate','TANSFER_LEVEL_LINIT','getUnlockUserDataAndLock','2MQbulQ','GIVE','findOneData','todayRebate','total','addPartner','[updateUnionRebate]','[modifyScore]\x20operate\x20success\x20owner','toFixed','todayWinTotal','[deleteUserForUnion]\x20msg\x20=\x20','[exitUnion]\x20msg\x20=\x20','[addUserBlockRule]\x20ownerUid\x20=\x20','yesterdayTotalProvideRebate','[getUnionRebateRecord]','shift','[getMemberScoreList]','updateForbidGameStatus','getTeamFixScore','ownerUid','175luPSgW','catch','[deleteUserBlockRule]\x20msg\x20=\x20','findOneAndUpdateEx','[userDelRecord]','NOT_ENOUGH_SCORE','[saveBoxOperation]','getUserScore','getNickName','getMemberList','addUserBlockRule','[addManager]\x20msg\x20=\x20','yesterdayWin','error','getUnionAllUser','yesterdayProvideRebate','getScoreModifyRecord','createData','now','fixScoreRate','userModel','[userPayDetailModel]','joinVerify','[removePartner]\x20msg\x20=\x20','safeBoxOperationRecord','$userList','length','[askJoinUnion]\x20operate\x20success\x20pengding','gameLimitModel','[updateForbidGameStatus]','getGameRecord','memberYesterdayBigWinDraw','limitScore','stack','userScoreRecord','memberUid','userBlockModel','createDataArr','INVITE_ID_ERROR','../../../constant/code','getMemberStatisticsInfo\x20msg\x20=\x20','4sUEePq','showRank','[createUnion]\x20operate\x20success','[modifyScore]\x20sessionUid\x20=\x20','ALREADY_IN_UNION','joinUnionApprove','giveUid','getAllOnLineList','startIndex','../../../dao/userDao','operationUid','提取返利','[addManager]\x20operate\x20success','todayProvideRebate','[operationInviteJoinUnion]','ownerAvatar','stringify','partnerUid','userDelRecord','format','[userBlockList]','joinRequestList','[updateUnionNotice]','\x20\x20sessionUid\x20=\x20','updateRobotScore','$userList.score','REQUEST_DATA_ERROR','[addUserBlockRule]\x20operate\x20success','[updateRobotScore]','userDelModel','getAllOnLineList\x20msg\x20=\x20','userGameRecordModel','$userList.avatar','approveType','[modifyScore]\x20operate\x20success','164776Llgeqo','safeScore','[updateRobotScore]\x20operate\x20success','yesterdayBigWinDraw','propsLimit','deleteUserBlockRule','[updateUnionTicketRebate]','盟主自己','emptyTable','isAgent','[safeBoxOperation]\x20msg\x20=\x20','tableHideCount','modifyUserToRule','[getTeamDetail]','totalDraw','exitUnion','YYYYMMDD','updateLimitScore','unionName','unionSkinId','[removeCaptainPartner]\x20operate\x20success','[updateLimitScore]','[getRank]','targetScore','[getMemberList]','SAFE_BOX','unionModel','unionType','totalScore','[userDirectSeriesSuperior]','getMyRebate','type','matchData','userPayDetailModel','partner','[askJoinUnion]\x20operate\x20success\x20','[removePartner]\x20operate\x20success','totalCount','getUnionRebateRecord','partnerPage','278999jMVPKn','updateUserDataNotify','unionMainList','MODIFY_LOW','[askJoinUnionList]','curMember','[deleteUserBlockRule]\x20ownerUid\x20=\x20','filter','[exitUnion]\x20operate\x20success\x20','dayTime','unshift','[deleteUserForUnion]','isShow','userBlockList','UNION_NOT_EXIST','[saveBoxOperation]\x20operate\x20success','getVideoRecord','$unionInfo.yesterdayDraw','getStatisticsInfo','getRankSingleDraw','yesterdayDraw','21XZejYu','[joinUnion]','forbid','[unionMainList]','getGiveScoreRecord','getUserUnionList','scoreGiveRecordModel','operate','exports','roomID','ticketRate','modifyScore','[addManager]\x20ownerUid\x20=\x20','[safeBoxOperation]','scoreChangeType','updateUserDataByUid','[userBlockList]\x20ownerUid\x20=\x20','getRank','INVALID_UERS','dismissType','lastLoginTime','[getRankSingleDraw]','保险柜取出','6WeqzST','forbidInvite','number','../../../constant/enumeration','CAN_NOT_REPEAT_APPLICATION','[deleteUserBlockRule]\x20operate\x20success','inviteMsg','joinUnion','unionID','updateUnionTicketRebate','count','scoreModifyRecordModel','[getGameReplay]','findDataAndCount','tableSort','yesterdayWinTotal','safeBoxRecordModel','[safeBoxOperation]\x20operate\x20success','weekDraw','[removePartner]\x20ownerUid\x20=\x20','todayWin','[getMemberList]\x20msg\x20=\x20','operationInviteJoinUnion','\x20isPartner\x20=\x20','\x20ownerUid\x20=\x20','uniqueIDModel','../../../dao/commonDao','[modifyUserToRule]\x20add\x20limit\x20operate\x20fail','$unionInfo','notice','\x20sessionUid\x20=\x20','safeBoxOperation','saveScore','frontendId','$userList.uid','sortData','avatar','__route__','forbidGive','740540NrFrth','[addPartner]\x20operate\x20success\x20update','236ASUEYb'];a0_0x4b7f=function(){return _0x3f5e01;};return a0_0x4b7f();}Handler[a0_0x1df908(0x228)][a0_0x5d04f4(0x23d)]=async function(_0x46332b,_0x2d7165,_0x6c1085){const _0x295893=a0_0x1df908,_0x28e127=a0_0x5d04f4;logger[_0x28e127(0x20d)](_0x295893(0x252)+getSimData(_0x46332b)+_0x295893(0x1d4)+_0x2d7165[_0x295893(0x215)]);try{if(!_0x2d7165[_0x28e127(0x18a)]){_0x6c1085(null,{'code':code[_0x28e127(0x1c8)]});return;}if(!_0x46332b[_0x28e127(0x1d4)]||!_0x46332b[_0x28e127(0x2aa)]||!_0x46332b[_0x28e127(0x1c7)]){_0x6c1085(null,{'code':code[_0x28e127(0x1c8)]});return;}let _0xa5a68b=await userDao[_0x28e127(0x1e9)](_0x2d7165[_0x28e127(0x18a)]);if(!_0xa5a68b){_0x6c1085(null,{'code':code[_0x28e127(0x1c8)]});return;}let _0x2f8bb5=_0xa5a68b[_0x28e127(0x26e)][_0x28e127(0x296)](function(_0x42abe1){const _0x59c42f=_0x28e127;return _0x42abe1[_0x59c42f(0x1d4)]===_0x46332b[_0x59c42f(0x1d4)];});if(!_0x2f8bb5){_0x6c1085(null,{'code':code[_0x28e127(0x262)]});return;}let _0x178e4b=await commonDao[_0x295893(0x26a)](_0x28e127(0x22b),{'unionID':_0x46332b[_0x28e127(0x1d4)]});if(!_0x178e4b){_0x6c1085(null,{'code':code[_0x28e127(0x290)]});return;}if(_0x178e4b&&(_0x2f8bb5[_0x28e127(0x199)]||_0x2d7165[_0x28e127(0x18a)]==_0x178e4b[_0x28e127(0x22e)])){let _0x577e4c=await userDao[_0x28e127(0x251)](_0x2d7165[_0x295893(0x215)]);if(!_0x577e4c){_0x6c1085(null,{'code':code['REQUEST_DATA_ERROR']});return;}let _0x1aa26c=null;for(let _0x50e8e3=0x0;_0x50e8e3<_0x577e4c[_0x28e127(0x26e)][_0x295893(0x130)];++_0x50e8e3){if(_0x577e4c[_0x28e127(0x26e)][_0x50e8e3][_0x295893(0x1be)]===_0x46332b[_0x295893(0x1be)]){_0x1aa26c=_0x577e4c[_0x28e127(0x26e)][_0x50e8e3];break;}}_0x46332b[_0x28e127(0x2aa)]=parseInt(_0x46332b[_0x28e127(0x2aa)])||0x0;let _0x410e7a=_0x46332b[_0x28e127(0x1c7)]||[],_0x3b260d=_0x46332b[_0x28e127(0x2aa)]*_0x410e7a[_0x28e127(0x200)];if(!_0x1aa26c||_0x1aa26c[_0x28e127(0x1bd)]<_0x3b260d){await userDao[_0x28e127(0x18d)](_0x2d7165[_0x295893(0x215)]),_0x6c1085(null,{'code':code[_0x28e127(0x186)]});return;}let _0x3e01ae=await userDao[_0x28e127(0x194)]({'uid':_0x2d7165[_0x28e127(0x18a)],'unionInfo.unionID':_0x46332b[_0x295893(0x1be)]},{'$inc':{'unionInfo.$.score':-_0x3b260d}}),_0x12e97c=[];for(let _0x56e26b=0x0;_0x56e26b<_0x410e7a[_0x28e127(0x200)];_0x56e26b++){let _0x5b7643=_0x410e7a[_0x56e26b],_0x6fd3a=await userDao[_0x28e127(0x194)]({'uid':_0x5b7643,'unionInfo.unionID':_0x46332b[_0x28e127(0x1d4)]},{'$inc':{'unionInfo.$.score':Math[_0x28e127(0x1b3)](_0x46332b[_0x28e127(0x2aa)])}}),_0x10e0dc={'uid':_0x2d7165[_0x28e127(0x18a)],'nickname':_0x577e4c[_0x28e127(0x2b4)],'avatar':_0x577e4c[_0x28e127(0x1e4)],'gainUid':_0x5b7643,'gainNickname':_0x6fd3a[_0x28e127(0x2b4)],'gainAvatar':_0x6fd3a['avatar'],'unionID':_0x46332b[_0x295893(0x1be)],'count':Math[_0x28e127(0x1b3)](_0x46332b[_0x295893(0x1c0)]),'createTime':Date[_0x295893(0x128)]()};commonDao[_0x28e127(0x214)](_0x28e127(0x201),_0x10e0dc)[_0x28e127(0x260)](_0x33aaec=>{const _0x883a11=_0x28e127;logger[_0x883a11(0x253)](_0x33aaec[_0x883a11(0x1c6)]);});if(!!_0x6fd3a[_0x28e127(0x202)])userInfoServices[_0x28e127(0x28c)](_0x6fd3a[_0x295893(0x215)],_0x6fd3a[_0x28e127(0x202)],{'unionInfo':_0x6fd3a[_0x28e127(0x26e)]})[_0x295893(0x27d)](_0x32b1bc=>{const _0x38b396=_0x295893,_0x434728=_0x28e127;logger[_0x434728(0x253)](_0x32b1bc[_0x38b396(0x137)]);});let _0x32247c=_0x6fd3a['unionInfo'][_0x295893(0x1f3)](function(_0x5d33ed){const _0x109d2e=_0x295893,_0x599c54=_0x28e127;return _0x5d33ed[_0x599c54(0x1d4)]===_0x46332b[_0x109d2e(0x1be)];});_0x12e97c[_0x28e127(0x2af)]({'uid':_0x3e01ae['uid'],'nickname':_0x3e01ae[_0x28e127(0x2b4)],'unionID':_0x46332b[_0x295893(0x1be)],'changeCount':-_0x46332b[_0x295893(0x1c0)],'leftCount':_0x32247c[_0x28e127(0x1bd)],'leftSafeBoxCount':_0x32247c[_0x28e127(0x27d)],'leftSaveBoxCount':_0x32247c['saveScore'],'changeType':enumeration[_0x28e127(0x1b5)][_0x28e127(0x267)],'describe':_0x46332b[_0x28e127(0x2aa)]>0x0?_0x28e127(0x227)+_0x6fd3a[_0x28e127(0x18a)]+'加分'+_0x46332b[_0x28e127(0x2aa)]:_0x28e127(0x227)+_0x6fd3a[_0x28e127(0x18a)]+'减分'+_0x46332b[_0x28e127(0x2aa)]*-0x1,'createTime':Date[_0x28e127(0x1dd)]()});let _0x5011e6=_0x6fd3a[_0x28e127(0x26e)][_0x28e127(0x296)](function(_0x2ef33c){const _0x29e814=_0x28e127;return _0x2ef33c[_0x29e814(0x1d4)]===_0x46332b['unionID'];});_0x12e97c[_0x295893(0x1f0)]({'uid':_0x6fd3a[_0x28e127(0x18a)],'nickname':_0x6fd3a['nickname'],'unionID':_0x46332b[_0x28e127(0x1d4)],'changeCount':_0x46332b[_0x28e127(0x2aa)],'leftCount':_0x5011e6[_0x28e127(0x1bd)],'leftSafeBoxCount':_0x5011e6[_0x28e127(0x27d)],'leftSaveBoxCount':_0x5011e6[_0x28e127(0x25b)],'changeType':enumeration[_0x28e127(0x1b5)]['MODIFY_UP'],'describe':_0x46332b[_0x28e127(0x2aa)]>0x0?'上级'+_0x3e01ae[_0x295893(0x215)]+'加分'+_0x46332b[_0x295893(0x1c0)]:'上级'+_0x3e01ae[_0x28e127(0x18a)]+'减分'+_0x46332b[_0x28e127(0x2aa)]*-0x1,'createTime':Date[_0x28e127(0x1dd)]()});}await commonDao[_0x295893(0x13b)](_0x295893(0x24e),_0x12e97c),await commonDao[_0x295893(0x13b)](_0x28e127(0x1ea),_0x12e97c)[_0x295893(0x27d)](_0x24a801=>{const _0x5dec42=_0x28e127;logger[_0x5dec42(0x253)](_0x24a801[_0x5dec42(0x1c6)]);}),_0x6c1085(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x3e01ae[_0x295893(0x242)]}}),logger[_0x28e127(0x20d)](_0x28e127(0x1c4));}else{_0x6c1085(null,{'code':code[_0x28e127(0x262)]});return;}}catch(_0x1c7042){logger[_0x28e127(0x253)](_0x28e127(0x1b6)+_0x1c7042[_0x295893(0x137)]),_0x6c1085(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x5d04f4(0x2c2)]=async function(_0x430901,_0xee8398,_0x124c3a){const _0x1d9c14=a0_0x1df908,_0x291be0=a0_0x5d04f4;logger[_0x291be0(0x20d)](_0x291be0(0x287)+getSimData(_0x430901)+_0x291be0(0x193)+_0xee8398[_0x291be0(0x18a)]);try{if(!_0xee8398[_0x291be0(0x18a)]){_0x124c3a(null,{'code':code[_0x291be0(0x1c8)]});return;}if(!_0x430901[_0x291be0(0x1d4)]){_0x124c3a(null,{'code':code[_0x291be0(0x262)]});return;}let _0x661f04=await userDao[_0x291be0(0x1e9)](_0xee8398[_0x1d9c14(0x215)]);if(!_0x661f04){_0x124c3a(null,{'code':code[_0x291be0(0x1c8)]});return;}let _0x4904e2=await commonDao[_0x1d9c14(0x26a)](_0x291be0(0x22b),{'unionID':_0x430901[_0x291be0(0x1d4)]});if(!_0x4904e2){_0x124c3a(null,{'code':code[_0x291be0(0x290)]});return;}let _0x54f73d=_0x661f04[_0x1d9c14(0x242)][_0x1d9c14(0x1f3)](function(_0x4f04db){const _0x4823fc=_0x291be0;return _0x4f04db[_0x4823fc(0x1d4)]===_0x430901[_0x4823fc(0x1d4)];});if(!_0x54f73d){_0x124c3a(null,{'code':code[_0x291be0(0x262)]});return;}logger[_0x291be0(0x20d)](_0x291be0(0x25f)+_0x4904e2[_0x291be0(0x22e)]+_0x291be0(0x1f1)+_0x54f73d[_0x291be0(0x199)]+_0x291be0(0x193)+_0xee8398[_0x291be0(0x18a)]);if(_0x4904e2[_0x291be0(0x22e)]!=_0xee8398[_0x291be0(0x18a)]&&!_0x54f73d[_0x291be0(0x199)]){_0x124c3a(null,{'code':code[_0x291be0(0x262)]});return;}let _0x58b07={'creatorUid':_0xee8398[_0x1d9c14(0x215)],'unionID':_0x430901[_0x291be0(0x1d4)],'userList':[],'createTime':moment()[_0x291be0(0x22d)]('x')};await commonDao[_0x291be0(0x214)](_0x291be0(0x1ec),_0x58b07),_0x124c3a(null,{'code':code['OK']}),logger[_0x291be0(0x20d)](_0x1d9c14(0x15a));}catch(_0x2e0c93){logger[_0x291be0(0x253)](_0x291be0(0x208)+_0x2e0c93[_0x1d9c14(0x137)]),_0x124c3a(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x1df908(0x167)]=async function(_0xd54782,_0x47efad,_0x1babd4){const _0x45614d=a0_0x1df908,_0x5d2434=a0_0x5d04f4;logger[_0x5d2434(0x20d)](_0x45614d(0x118)+getSimData(_0xd54782)+_0x5d2434(0x193)+_0x47efad[_0x5d2434(0x18a)]);try{if(!_0x47efad[_0x45614d(0x215)]){_0x1babd4(null,{'code':code[_0x5d2434(0x1c8)]});return;}if(!_0xd54782[_0x45614d(0x1be)]||!_0xd54782['ruleID']){_0x1babd4(null,{'code':code[_0x5d2434(0x262)]});return;}let _0x2a3a8b=await userDao[_0x5d2434(0x1e9)](_0x47efad[_0x5d2434(0x18a)]);if(!_0x2a3a8b){_0x1babd4(null,{'code':code[_0x5d2434(0x1c8)]});return;}let _0x2fba64=await commonDao[_0x5d2434(0x2b7)](_0x5d2434(0x22b),{'unionID':_0xd54782[_0x45614d(0x1be)]});if(!_0x2fba64){_0x1babd4(null,{'code':code[_0x45614d(0x198)]});return;}let _0x42e1f5=_0x2a3a8b[_0x45614d(0x242)][_0x5d2434(0x296)](function(_0x56213e){const _0x57b0e8=_0x5d2434;return _0x56213e[_0x57b0e8(0x1d4)]===_0xd54782[_0x57b0e8(0x1d4)];});if(!_0x42e1f5){_0x1babd4(null,{'code':code[_0x45614d(0x22b)]});return;}logger[_0x5d2434(0x20d)](_0x5d2434(0x1cd)+_0x2fba64[_0x5d2434(0x22e)]+_0x5d2434(0x1f1)+_0x42e1f5[_0x5d2434(0x199)]+_0x5d2434(0x193)+_0x47efad[_0x5d2434(0x18a)]);if(_0x2fba64[_0x5d2434(0x22e)]!=_0x47efad[_0x5d2434(0x18a)]&&!_0x42e1f5[_0x5d2434(0x199)]){_0x1babd4(null,{'code':code[_0x5d2434(0x262)]});return;}await commonDao[_0x5d2434(0x19b)](_0x5d2434(0x1ec),{'ruleID':_0xd54782[_0x5d2434(0x261)]}),_0x1babd4(null,{'code':code['OK']}),logger[_0x5d2434(0x20d)](_0x5d2434(0x1ba));}catch(_0x11dba6){logger[_0x45614d(0x123)](_0x45614d(0x1eb)+_0x11dba6[_0x5d2434(0x1c6)]),_0x1babd4(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x16b)]=async function(_0x425ecc,_0x50dc9c,_0x4ced40){const _0x5d93c0=a0_0x1df908,_0x53c51e=a0_0x5d04f4;logger[_0x53c51e(0x20d)](_0x53c51e(0x198)+getSimData(_0x425ecc)+_0x53c51e(0x193)+_0x50dc9c[_0x53c51e(0x18a)]);try{if(!_0x50dc9c[_0x53c51e(0x18a)]){_0x4ced40(null,{'code':code[_0x53c51e(0x1c8)]});return;}if(!_0x425ecc[_0x5d93c0(0x1be)]||!_0x425ecc[_0x53c51e(0x1c7)]||!_0x425ecc[_0x5d93c0(0x1e4)]){_0x4ced40(null,{'code':code[_0x53c51e(0x262)]});return;}let _0xf87f28=await userDao[_0x53c51e(0x1e9)](_0x50dc9c[_0x5d93c0(0x215)]);if(!_0xf87f28){_0x4ced40(null,{'code':code[_0x53c51e(0x1c8)]});return;}let _0x547763=await commonDao[_0x5d93c0(0x26a)](_0x5d93c0(0x17c),{'unionID':_0x425ecc['unionID']});if(!_0x547763){_0x4ced40(null,{'code':code[_0x53c51e(0x290)]});return;}let _0x3346eb=_0xf87f28[_0x53c51e(0x26e)][_0x53c51e(0x296)](function(_0x34245d){const _0x33a201=_0x53c51e;return _0x34245d['unionID']===_0x425ecc[_0x33a201(0x1d4)];});if(!_0x3346eb){_0x4ced40(null,{'code':code[_0x53c51e(0x262)]});return;}logger[_0x53c51e(0x20d)](_0x53c51e(0x184)+_0x547763[_0x53c51e(0x22e)]+_0x53c51e(0x1f1)+_0x3346eb[_0x53c51e(0x199)]+_0x53c51e(0x193)+_0x50dc9c[_0x53c51e(0x18a)]);if(_0x547763[_0x5d93c0(0x27b)]!=_0x50dc9c[_0x53c51e(0x18a)]&&!_0x3346eb[_0x53c51e(0x199)]){_0x4ced40(null,{'code':code[_0x53c51e(0x262)]});return;}if(_0x425ecc[_0x53c51e(0x175)]==0x1){let _0xea8502=_0x425ecc['userList'][0x0],_0x1c4661=await userDao[_0x53c51e(0x1e9)](_0xea8502);if(!_0x1c4661){_0x4ced40(null,{'code':code[_0x53c51e(0x1c8)]});return;}let _0x54c898=_0x1c4661[_0x53c51e(0x26e)][_0x5d93c0(0x1f3)](function(_0x59f8ca){const _0x976217=_0x5d93c0,_0xffc89e=_0x53c51e;return _0x59f8ca[_0x976217(0x1be)]===_0x425ecc[_0xffc89e(0x1d4)];});if(_0x1c4661&&_0x54c898){let _0x33c3e4={'uid':_0xea8502,'nickname':_0x1c4661[_0x5d93c0(0x1ed)],'avatar':_0x1c4661[_0x53c51e(0x1e4)]};await commonDao[_0x53c51e(0x2b2)](_0x5d93c0(0x13a),{'ruleID':_0x425ecc['ruleID'],'unionID':_0x425ecc[_0x53c51e(0x1d4)]},{'$pull':{'userList':{'uid':_0xea8502}}}),await commonDao[_0x5d93c0(0x119)](_0x5d93c0(0x13a),{'ruleID':_0x425ecc[_0x5d93c0(0x1e4)],'unionID':_0x425ecc['unionID']},{'$push':{'userList':_0x33c3e4}});let _0x32e786=await commonDao[_0x5d93c0(0x26a)]('userBlockModel',{'ruleID':_0x425ecc[_0x53c51e(0x261)],'unionID':_0x425ecc[_0x5d93c0(0x1be)]});_0x4ced40(null,{'code':code['OK'],'ruleData':_0x32e786}),logger[_0x53c51e(0x20d)](_0x53c51e(0x1be));}else{logger[_0x53c51e(0x20d)](_0x53c51e(0x27e)),_0x4ced40(null,{'code':code[_0x53c51e(0x1c8)]});return;}}else{await commonDao[_0x53c51e(0x2b2)](_0x5d93c0(0x13a),{'ruleID':_0x425ecc['ruleID'],'unionID':_0x425ecc[_0x53c51e(0x1d4)]},{'$pull':{'userList':{'uid':{'$in':_0x425ecc[_0x53c51e(0x1c7)]}}}});let _0x8cc0bf=await commonDao[_0x53c51e(0x2b7)](_0x53c51e(0x1ec),{'ruleID':_0x425ecc[_0x53c51e(0x261)],'unionID':_0x425ecc[_0x53c51e(0x1d4)]});_0x4ced40(null,{'code':code['OK'],'ruleData':_0x8cc0bf}),logger[_0x53c51e(0x20d)](_0x53c51e(0x286));}}catch(_0x474a1c){logger[_0x53c51e(0x253)](_0x53c51e(0x2a8)+_0x474a1c[_0x5d93c0(0x137)]),_0x4ced40(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x25c)]=async function(_0x5d2e32,_0x1d207b,_0x5304c2){const _0x27d556=a0_0x1df908,_0xe4d3e2=a0_0x5d04f4;logger[_0x27d556(0x20e)](_0xe4d3e2(0x228)+getSimData(_0x5d2e32)+_0x27d556(0x1d4)+_0x1d207b[_0xe4d3e2(0x18a)]);try{if(!_0x1d207b[_0x27d556(0x215)]){_0x5304c2(null,{'code':code[_0x27d556(0x1b1)]});return;}if(!_0x5d2e32['unionID']){_0x5304c2(null,{'code':code[_0xe4d3e2(0x262)]});return;}let _0x2a38fe=await userDao[_0xe4d3e2(0x1e9)](_0x1d207b[_0xe4d3e2(0x18a)]);if(!_0x2a38fe){_0x5304c2(null,{'code':code[_0xe4d3e2(0x1c8)]});return;}let _0x5c0097=await commonDao[_0xe4d3e2(0x2b7)](_0xe4d3e2(0x22b),{'unionID':_0x5d2e32[_0xe4d3e2(0x1d4)]});if(!_0x5c0097){_0x5304c2(null,{'code':code[_0xe4d3e2(0x290)]});return;}let _0x2114d2=_0x2a38fe[_0xe4d3e2(0x26e)][_0xe4d3e2(0x296)](function(_0x467a6c){const _0xa676e6=_0xe4d3e2;return _0x467a6c[_0xa676e6(0x1d4)]===_0x5d2e32[_0xa676e6(0x1d4)];});if(!_0x2114d2){_0x5304c2(null,{'code':code[_0xe4d3e2(0x262)]});return;}logger[_0xe4d3e2(0x20d)](_0x27d556(0x1af)+_0x5c0097[_0x27d556(0x27b)]+_0xe4d3e2(0x1f1)+_0x2114d2[_0xe4d3e2(0x199)]+_0xe4d3e2(0x193)+_0x1d207b[_0xe4d3e2(0x18a)]);if(_0x5c0097['ownerUid']!=_0x1d207b[_0xe4d3e2(0x18a)]&&!_0x2114d2['manager']){_0x5304c2(null,{'code':code[_0xe4d3e2(0x262)]});return;}let _0x11caec={'unionID':_0x5d2e32[_0xe4d3e2(0x1d4)]},_0x290c14=await commonDao[_0xe4d3e2(0x1d1)](_0xe4d3e2(0x1ec),_0x5d2e32[_0xe4d3e2(0x2ac)]||0x0,_0x5d2e32[_0x27d556(0x1c0)]||0x14,{'createTime':0x1},_0x11caec);_0x5304c2(null,{'code':code['OK'],'msg':{'recordArr':_0x290c14[_0xe4d3e2(0x1e7)],'totalCount':_0x290c14[_0xe4d3e2(0x24d)]}}),logger[_0xe4d3e2(0x20d)](_0xe4d3e2(0x19f));}catch(_0x164005){logger[_0xe4d3e2(0x253)](_0xe4d3e2(0x17a)+_0x164005[_0x27d556(0x137)]),_0x5304c2(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x11d)]=async function(_0x3f5f14,_0x3d1eee,_0x4933cd){const _0x26d13f=a0_0x1df908,_0x1938d9=a0_0x5d04f4;try{if(!_0x3d1eee['uid']){_0x4933cd(null,{'code':code['INVALID_UERS']});return;}if(!_0x3f5f14[_0x1938d9(0x1d4)]){_0x4933cd(null,{'code':code['PERMISSION_NOT_ENOUGH']});return;}let _0x5a17fe=await userDao[_0x1938d9(0x1e9)](_0x3d1eee[_0x26d13f(0x215)]);if(!_0x5a17fe){_0x4933cd(null,{'code':code[_0x1938d9(0x1c8)]});return;}let _0x53d20e=await commonDao[_0x1938d9(0x2b7)](_0x1938d9(0x22b),{'unionID':_0x3f5f14[_0x1938d9(0x1d4)]});if(!_0x53d20e){_0x4933cd(null,{'code':code[_0x1938d9(0x290)]});return;}let _0x150782=_0x5a17fe[_0x1938d9(0x26e)][_0x1938d9(0x296)](function(_0x195c1b){const _0x39a219=_0x1938d9;return _0x195c1b[_0x39a219(0x1d4)]===_0x3f5f14[_0x39a219(0x1d4)];});if(!_0x150782){_0x4933cd(null,{'code':code[_0x26d13f(0x22b)]});return;}if(_0x53d20e[_0x1938d9(0x22e)]!=_0x3d1eee[_0x1938d9(0x18a)]&&!_0x150782[_0x1938d9(0x20e)]&&!_0x150782[_0x1938d9(0x199)]){_0x4933cd(null,{'code':code[_0x1938d9(0x262)]});return;}_0x3f5f14[_0x1938d9(0x266)]==moment()[_0x26d13f(0x152)](_0x26d13f(0x172))&&await userInfoServices[_0x1938d9(0x210)](_0x3f5f14[_0x1938d9(0x1d4)],_0x3f5f14[_0x26d13f(0x193)]);let _0x3d2b8d=_0x3d1eee[_0x1938d9(0x18a)];_0x150782[_0x1938d9(0x199)]&&(_0x3d2b8d=_0x53d20e[_0x1938d9(0x22e)]);let _0x5b5b7a=await userInfoServices[_0x26d13f(0x21f)](_0x3d2b8d,_0x3f5f14[_0x1938d9(0x1d4)]),_0x58f489={'uid':{'$in':_0x5b5b7a},'dayTime':_0x3f5f14[_0x1938d9(0x266)],'unionID':_0x3f5f14[_0x1938d9(0x1d4)]};_0x3f5f14[_0x1938d9(0x18a)]&&(_0x58f489[_0x1938d9(0x18a)]=_0x3f5f14[_0x1938d9(0x18a)]);let _0x3acc05={'score':-0x1};if(_0x3f5f14[_0x1938d9(0x175)]==0x1)_0x58f489[_0x1938d9(0x1bd)]={'$gt':0x0};else _0x3f5f14[_0x1938d9(0x175)]==0x2&&(_0x58f489[_0x1938d9(0x1bd)]={'$lt':0x0},_0x3acc05={'score':0x1});let _0x3324d2=await commonDao[_0x26d13f(0x1c3)]('userScoreModel',_0x3f5f14[_0x1938d9(0x2ac)]||0x0,_0x3f5f14[_0x1938d9(0x2aa)]||0x14,_0x3acc05,_0x58f489);_0x4933cd(null,{'code':code['OK'],'msg':{'recordArr':_0x3324d2[_0x26d13f(0x263)],'totalCount':_0x3324d2[_0x1938d9(0x24d)]}});}catch(_0x1991b7){logger[_0x26d13f(0x123)](_0x1938d9(0x182)+_0x1991b7[_0x1938d9(0x1c6)]),_0x4933cd(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x1df908(0x18c)]=async function(_0x53ff04,_0x24a630,_0x2683d2){const _0x1eb556=a0_0x1df908,_0x48f880=a0_0x5d04f4;try{logger[_0x48f880(0x20d)](_0x1eb556(0x25b));if(!_0x24a630['uid']){_0x2683d2(null,{'code':code[_0x48f880(0x1c8)]});return;}let _0x1dcd55={'isMain':{'$gt':0x0}};logger[_0x48f880(0x253)](_0x48f880(0x2c4)+JSON[_0x48f880(0x20b)](_0x53ff04)+_0x48f880(0x193)+_0x24a630[_0x48f880(0x18a)]);let _0x2475c1=await commonDao[_0x48f880(0x1db)](_0x48f880(0x22b),_0x1dcd55,{'isMain':-0x1},0x0,0x6);for(let _0x39174b=0x0;_0x39174b<_0x2475c1[_0x48f880(0x200)];_0x39174b++){let _0x453f5f=_0x2475c1[_0x39174b],_0x1dc6fb=_0x453f5f[_0x48f880(0x1d4)],_0x27acaf=_0x453f5f[_0x48f880(0x22e)],_0x396cd1=await userDao[_0x48f880(0x2a9)]({'uid':_0x27acaf}),_0x4a58e4=_0x396cd1[_0x48f880(0x26e)][_0x1eb556(0x1f3)](function(_0x248b5f){const _0x5a5654=_0x48f880;return _0x248b5f[_0x5a5654(0x1d4)]===_0x1dc6fb;});_0x2475c1[_0x39174b][_0x48f880(0x223)]=_0x4a58e4&&_0x4a58e4[_0x48f880(0x223)];}logger[_0x48f880(0x20d)](_0x48f880(0x205)),_0x2683d2(null,{'code':code['OK'],'msg':{'result':_0x2475c1}});}catch(_0x3f3647){logger[_0x48f880(0x253)](_0x48f880(0x1c3)+_0x3f3647[_0x1eb556(0x137)]),_0x2683d2(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x1df908(0x138)]=async function(_0x28078a,_0x28d314,_0x1460ac){const _0x13a8b3=a0_0x1df908,_0xa9bbd7=a0_0x5d04f4;try{if(!_0x28d314[_0xa9bbd7(0x18a)]){_0x1460ac(null,{'code':code[_0xa9bbd7(0x1c8)]});return;}if(!_0x28078a['unionID']){_0x1460ac(null,{'code':code[_0xa9bbd7(0x1b2)]});return;}let _0x34064c={'uid':_0x28d314[_0xa9bbd7(0x18a)],'unionID':_0x28078a['unionID'],'createTime':{'$gte':Date[_0xa9bbd7(0x1dd)]()-0x3*DAY_MS}},_0x19800d=await commonDao[_0xa9bbd7(0x1d1)](_0xa9bbd7(0x1ea),_0x28078a[_0xa9bbd7(0x2ac)]||0x0,_0x28078a[_0xa9bbd7(0x2aa)]||0x14,{'createTime':-0x1},_0x34064c);_0x1460ac(null,{'code':code['OK'],'msg':_0x19800d});}catch(_0x4f3c38){logger[_0xa9bbd7(0x253)](_0x13a8b3(0x229)+_0x4f3c38[_0xa9bbd7(0x1c6)]),_0x1460ac(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x1fb)]=async function(_0x293a65,_0x52283d,_0x5c7b85){const _0x4d0944=a0_0x1df908,_0x515b64=a0_0x5d04f4;try{if(!_0x52283d[_0x515b64(0x18a)]){_0x5c7b85(null,{'code':code[_0x4d0944(0x1b1)]});return;}if(!_0x293a65[_0x515b64(0x1d4)]){_0x5c7b85(null,{'code':code[_0x515b64(0x262)]});return;}let _0x992b9b=await userDao[_0x515b64(0x1e9)](_0x52283d[_0x515b64(0x18a)]);if(!_0x992b9b){_0x5c7b85(null,{'code':code[_0x515b64(0x1c8)]});return;}let _0x1016bf=await commonDao['findOneData'](_0x515b64(0x22b),{'unionID':_0x293a65[_0x4d0944(0x1be)]});if(!_0x1016bf){_0x5c7b85(null,{'code':code[_0x515b64(0x290)]});return;}let _0x5f3eda=_0x992b9b[_0x515b64(0x26e)][_0x4d0944(0x1f3)](function(_0x295158){const _0x39560b=_0x515b64;return _0x295158[_0x39560b(0x1d4)]===_0x293a65[_0x39560b(0x1d4)];});if(!_0x5f3eda){_0x5c7b85(null,{'code':code[_0x515b64(0x262)]});return;}if(_0x1016bf[_0x515b64(0x22e)]!=_0x52283d[_0x515b64(0x18a)]&&!_0x5f3eda[_0x515b64(0x20e)]&&!_0x5f3eda[_0x515b64(0x199)]){_0x5c7b85(null,{'code':code[_0x515b64(0x262)]});return;}let _0x724136=0x0,_0xbe5f66=0x0,_0x59f042=0x0,_0x32e554=null,_0x295baf=_0x5f3eda[_0x515b64(0x2b8)]||0x0,_0x16a1e0=0x0,_0x578f32=0x0,_0x5d9758=0x0,_0x253852=0x0,_0x29fa69=0x0,_0x41bf41=0x0,_0x294de4=0x0;if(_0x5f3eda[_0x4d0944(0x20b)]){let _0x47c179=await commonDao[_0x515b64(0x2b7)](_0x515b64(0x1e8),{'uid':_0x5f3eda[_0x4d0944(0x20b)]});_0x47c179&&(_0x32e554={'uid':_0x47c179[_0x515b64(0x18a)],'nickname':_0x47c179[_0x515b64(0x2b4)],'avatar':_0x47c179[_0x4d0944(0x1da)]});}let _0x328535=_0x52283d[_0x515b64(0x18a)];_0x5f3eda[_0x515b64(0x199)]&&(_0x328535=_0x1016bf[_0x515b64(0x22e)]);let _0x5e0b19={'unionInfo':{'$elemMatch':{'spreaderID':_0x328535,'unionID':_0x293a65[_0x515b64(0x1d4)]}}};_0xbe5f66=await commonDao[_0x515b64(0x213)](_0x515b64(0x1e8),_0x5e0b19);let _0xc2013f=await userInfoServices[_0x4d0944(0x21f)](_0x328535,_0x293a65[_0x4d0944(0x1be)]);_0x724136=_0xc2013f[_0x515b64(0x200)],_0x59f042=_0x724136-_0xbe5f66;let _0x55af8f=await userInfoServices['getUserDataTotal'](_0x293a65[_0x515b64(0x1d4)],_0xc2013f);_0x578f32=_0x55af8f[_0x515b64(0x1aa)],_0x5d9758=_0x55af8f[_0x4d0944(0x1c5)],_0x16a1e0=_0x55af8f[_0x515b64(0x1fd)],_0x294de4=_0x55af8f[_0x515b64(0x238)],_0x253852=_0x55af8f[_0x4d0944(0x265)],_0x29fa69=_0x55af8f[_0x515b64(0x174)];let _0x77769b=await userInfoServices[_0x515b64(0x1c9)](_0x293a65[_0x515b64(0x1d4)],[_0x328535]),_0xba8c36=_0x77769b[_0x515b64(0x19d)],_0x4f4d69=_0x77769b[_0x515b64(0x174)];if(_0x1016bf[_0x4d0944(0x27b)]==_0x52283d[_0x4d0944(0x215)]||_0x5f3eda[_0x515b64(0x199)]){let _0x263230=await commonDao['findData'](_0x515b64(0x1e8),{'unionInfo.unionID':_0x293a65[_0x515b64(0x1d4)],'isRobot':!![]},null,0x0,0x0),_0x257d5c=[];for(let _0x3c799d=0x0;_0x3c799d<_0x263230[_0x515b64(0x200)];_0x3c799d++){_0x257d5c[_0x515b64(0x2af)](_0x263230[_0x3c799d][_0x515b64(0x18a)]);}}let _0x3b20d2={'testWin':_0x41bf41,'curUserYesterdayRebate':_0x4f4d69,'curUserRebate':_0xba8c36,'totalDraw':_0x294de4,'memberTotalCount':_0x724136,'memberCount':_0xbe5f66,'outMemberCount':_0x59f042,'spreaderInfo':_0x32e554,'rebateRate':_0x295baf,'totalScore':_0x16a1e0,'todayWin':_0x578f32,'yesterdayWin':_0x5d9758,'todayRebate':_0x253852,'yesterdayRebate':_0x29fa69};_0x5c7b85(null,{'code':code['OK'],'msg':_0x3b20d2});}catch(_0x2a33e9){logger[_0x515b64(0x253)](_0x515b64(0x19c)+_0x2a33e9[_0x515b64(0x1c6)]),_0x5c7b85(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x180)]=async function(_0x13ee64,_0xf96de3,_0x1ed853){const _0x4ede7c=a0_0x1df908,_0x4eef4=a0_0x5d04f4;try{if(!_0xf96de3[_0x4eef4(0x18a)]){_0x1ed853(null,{'code':code[_0x4eef4(0x1c8)]});return;}if(!_0x13ee64[_0x4ede7c(0x1be)]){_0x1ed853(null,{'code':code[_0x4eef4(0x262)]});return;}let _0x5149a0=await userDao[_0x4eef4(0x1e9)](_0xf96de3[_0x4eef4(0x18a)]);if(!_0x5149a0){_0x1ed853(null,{'code':code[_0x4eef4(0x1c8)]});return;}let _0x591407=await commonDao[_0x4ede7c(0x26a)](_0x4eef4(0x22b),{'unionID':_0x13ee64[_0x4eef4(0x1d4)]});if(!_0x591407){_0x1ed853(null,{'code':code[_0x4eef4(0x290)]});return;}let _0x21a08f=_0x5149a0[_0x4eef4(0x26e)][_0x4ede7c(0x1f3)](function(_0x337d01){const _0x217f9d=_0x4ede7c,_0x536786=_0x4eef4;return _0x337d01[_0x217f9d(0x1be)]===_0x13ee64[_0x536786(0x1d4)];});if(!_0x21a08f){_0x1ed853(null,{'code':code[_0x4eef4(0x262)]});return;}if(_0x591407[_0x4eef4(0x22e)]!=_0xf96de3[_0x4eef4(0x18a)]&&!_0x21a08f[_0x4ede7c(0x184)]){_0x1ed853(null,{'code':code[_0x4eef4(0x262)]});return;}let _0x3877c7=_0x21a08f[_0x4eef4(0x27d)],_0x520653=_0x21a08f[_0x4ede7c(0x26b)],_0x4c7a30=_0x21a08f[_0x4eef4(0x1cb)],_0x255948={'safeScore':_0x3877c7,'todayRebate':_0x520653,'yesterdayRebate':_0x4c7a30};if(_0x13ee64[_0x4eef4(0x175)]!=0x1){let _0x1ea6ef=_0xf96de3[_0x4eef4(0x18a)],_0x4a8189={'uid':_0x1ea6ef,'unionID':_0x13ee64[_0x4eef4(0x1d4)]},_0x402ddd=await commonDao[_0x4eef4(0x1d1)](_0x4eef4(0x1b1),_0x13ee64['startIndex']||0x0,_0x13ee64[_0x4eef4(0x2aa)]||0x14,{'createTime':-0x1},_0x4a8189);_0x255948[_0x4eef4(0x1e7)]=_0x402ddd[_0x4eef4(0x1e7)],_0x255948[_0x4eef4(0x21e)]=_0x402ddd[_0x4eef4(0x24d)];}_0x1ed853(null,{'code':code['OK'],'msg':_0x255948});}catch(_0x45a1ee){logger[_0x4eef4(0x253)](_0x4eef4(0x1f6)+_0x45a1ee[_0x4eef4(0x1c6)]),_0x1ed853(null,{'code':0x1f4});}},Handler['prototype'][a0_0x5d04f4(0x21d)]=async function(_0x21c4fc,_0x1f1763,_0x24a831){const _0x5bf61c=a0_0x1df908,_0x1b3c81=a0_0x5d04f4;logger[_0x1b3c81(0x20d)](_0x1b3c81(0x1bf)+getSimData(_0x21c4fc)+_0x1b3c81(0x193)+_0x1f1763[_0x1b3c81(0x18a)]);try{if(!_0x1f1763[_0x1b3c81(0x18a)]){_0x24a831(null,{'code':code[_0x1b3c81(0x1c8)]});return;}if(!_0x21c4fc[_0x1b3c81(0x1d4)]||!_0x21c4fc[_0x1b3c81(0x265)]||!_0x21c4fc[_0x1b3c81(0x1a8)]){_0x24a831(null,{'code':code[_0x1b3c81(0x1c8)]});return;}let _0x561f13=await commonDao[_0x1b3c81(0x2b7)](_0x1b3c81(0x22b),{'unionID':_0x21c4fc[_0x1b3c81(0x1d4)]});if(!_0x561f13){_0x24a831(null,{'code':code[_0x1b3c81(0x290)]});return;}let _0x3ee0ec=await userDao['getUserDataByUid'](_0x1f1763[_0x1b3c81(0x18a)]);if(!_0x3ee0ec){_0x24a831(null,{'code':code[_0x1b3c81(0x1c8)]});return;}let _0x43e8d4=_0x3ee0ec[_0x1b3c81(0x26e)][_0x1b3c81(0x296)](function(_0x3d320d){const _0x32ce7c=_0x1b3c81;return _0x3d320d[_0x32ce7c(0x1d4)]===_0x21c4fc[_0x32ce7c(0x1d4)];});if(!_0x43e8d4||_0x561f13[_0x1b3c81(0x22e)]!=_0x1f1763[_0x1b3c81(0x18a)]){_0x24a831(null,{'code':code[_0x1b3c81(0x262)]});return;}logger['info'](_0x1b3c81(0x17d)+_0x561f13['ownerUid']+_0x1b3c81(0x193)+_0x1f1763[_0x1b3c81(0x18a)]);let _0x5d38bc=await userDao[_0x1b3c81(0x1e9)](_0x21c4fc[_0x1b3c81(0x1a8)]);if(!_0x5d38bc){_0x24a831(null,{'code':code[_0x1b3c81(0x1c8)]});return;}let _0x2ed401=_0x5d38bc[_0x1b3c81(0x26e)][_0x1b3c81(0x296)](function(_0x22ed82){const _0x50fecd=_0x1b3c81;return _0x22ed82[_0x50fecd(0x1d4)]===_0x21c4fc[_0x50fecd(0x1d4)];});if(!_0x2ed401||!_0x2ed401[_0x1b3c81(0x20e)]){_0x24a831(null,{'code':code[_0x5bf61c(0x22b)]});return;}let _0x1ae157=await userDao[_0x1b3c81(0x1e9)](_0x21c4fc[_0x1b3c81(0x265)]);if(!_0x1ae157){_0x24a831(null,{'code':code[_0x5bf61c(0x1b1)]});return;}let _0x1d1b32=_0x1ae157[_0x5bf61c(0x242)][_0x1b3c81(0x296)](function(_0x53a66d){const _0x56611c=_0x5bf61c;return _0x53a66d[_0x56611c(0x1be)]===_0x21c4fc['unionID'];});if(!_0x1d1b32){_0x24a831(null,{'code':code[_0x1b3c81(0x25a)]});return;}let _0x447f0d=await userInfoServices[_0x1b3c81(0x168)](_0x1ae157[_0x1b3c81(0x18a)],_0x21c4fc[_0x1b3c81(0x1d4)]);if(_0x447f0d[_0x1b3c81(0x28f)](_0x21c4fc[_0x1b3c81(0x1a8)])){_0x24a831(null,{'code':code[_0x1b3c81(0x249)]});return;}await userDao[_0x1b3c81(0x294)]({'uid':_0x21c4fc[_0x1b3c81(0x265)],'unionInfo.unionID':_0x21c4fc[_0x5bf61c(0x1be)]},{'unionInfo.$.spreaderID':_0x21c4fc[_0x1b3c81(0x1a8)]}),logger[_0x1b3c81(0x20d)](_0x1b3c81(0x279)),_0x24a831(null,{'code':code['OK']});}catch(_0x352899){logger[_0x1b3c81(0x253)]('[removePartner]'+_0x352899[_0x1b3c81(0x1c6)]),_0x24a831(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x1d5)]=async function(_0x39f64e,_0x3ca93e,_0x26cb0a){const _0x4afb28=a0_0x1df908,_0x250918=a0_0x5d04f4;logger['info'](_0x250918(0x1a0)+getSimData(_0x39f64e)+_0x250918(0x193)+_0x3ca93e[_0x250918(0x18a)]);try{if(!_0x3ca93e[_0x250918(0x18a)]){_0x26cb0a(null,{'code':code[_0x250918(0x1c8)]});return;}if(!userListPenging[_0x3ca93e[_0x250918(0x18a)]])userListPenging[_0x3ca93e[_0x250918(0x18a)]]=moment();else{if(moment()[_0x250918(0x226)](userListPenging[_0x3ca93e[_0x250918(0x18a)]],'s')<0x5){_0x26cb0a(null,{'code':code[_0x250918(0x1b2)]});return;}userListPenging[_0x3ca93e[_0x4afb28(0x215)]]=moment();}let _0x50b0ae=_0x39f64e[_0x4afb28(0x174)];if(!_0x50b0ae||_0x50b0ae[_0x250918(0x200)]>0x14){_0x26cb0a(null,{'code':code[_0x250918(0x1b2)]});return;}let _0xe7c9f6=await userDao[_0x250918(0x1e9)](_0x3ca93e['uid']);if(!_0xe7c9f6[_0x250918(0x185)]){_0x26cb0a(null,{'code':code[_0x250918(0x1b2)]});return;}let _0x3bb9f4=await commonDao[_0x250918(0x2b7)](_0x250918(0x22b),{'unionName':_0x50b0ae});if(!!_0x3bb9f4){_0x26cb0a(null,{'code':code[_0x250918(0x2b5)]});return;}let _0x196890={'ownerUid':_0x3ca93e[_0x250918(0x18a)],'ownerNickname':_0xe7c9f6[_0x4afb28(0x1ed)],'ownerAvatar':_0xe7c9f6[_0x4afb28(0x1da)],'unionName':_0x50b0ae,'unionSkinId':_0x39f64e[_0x4afb28(0x175)],'unionType':_0x39f64e[_0x4afb28(0x17d)]||0x0,'ownerPhone':_0x39f64e[_0x250918(0x209)]||null,'ownerWeChat':_0x39f64e[_0x4afb28(0x1f5)]||null,'curMember':0x1,'createTime':Date[_0x250918(0x1dd)]()},_0x2ff6ef=await commonDao[_0x250918(0x214)](_0x250918(0x22b),_0x196890);if(!_0x2ff6ef){_0x26cb0a(null,{'code':code[_0x250918(0x176)]});return;}let _0x359308={'unionID':_0x2ff6ef[_0x250918(0x1d4)],'partner':!![],'rebateRate':0x1,'ticketRate':0x1,'fixScoreRate':0x1,'joinTime':Date[_0x250918(0x1dd)]()},_0x3acda5=await commonDao[_0x250918(0x2b2)]('uniqueIDModel',{'key':0x1},{'$inc':{'unionInviteID':0x7}},{'new':!![],'upsert':!![]});_0x359308[_0x4afb28(0x22a)]=_0x3acda5['unionInviteID'];let _0xc7390a=await userDao[_0x250918(0x26a)](_0x3ca93e[_0x4afb28(0x215)],{'$addToSet':{'unionInfo':_0x359308}});_0x26cb0a(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0xc7390a['unionInfo']},'msg':{'unionID':_0x2ff6ef[_0x4afb28(0x1be)]}}),logger[_0x250918(0x20d)](_0x250918(0x178));}catch(_0x125be7){logger[_0x250918(0x253)](_0x250918(0x2a5)+_0x125be7[_0x250918(0x1c6)]),_0x26cb0a(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x1f8)]=async function(_0x12ac8c,_0x1f3294,_0x37e7f9){const _0x366943=a0_0x1df908,_0x3e90de=a0_0x5d04f4;logger[_0x3e90de(0x20d)](_0x366943(0x262)+getSimData(_0x12ac8c)+_0x3e90de(0x193)+_0x1f3294[_0x3e90de(0x18a)]);try{if(!_0x1f3294[_0x3e90de(0x18a)]){_0x37e7f9(null,{'code':code[_0x366943(0x1b1)]});return;}let _0x3fd2dd=parseInt(_0x12ac8c['inviteID']||'0');if(!_0x3fd2dd){_0x37e7f9(null,{'code':code[_0x366943(0x159)]});return;}let _0x2d6ab1=await userDao[_0x3e90de(0x2a9)]({'unionInfo.inviteID':_0x3fd2dd});if(!_0x2d6ab1){_0x37e7f9(null,{'code':code[_0x3e90de(0x1b9)]});return;}let _0x309365=_0x2d6ab1[_0x3e90de(0x26e)][_0x366943(0x1f3)](function(_0x3102fd){const _0x249cea=_0x366943;return _0x3102fd[_0x249cea(0x22a)]===_0x3fd2dd;});if(!_0x309365){_0x37e7f9(null,{'code':code[_0x3e90de(0x1b9)]});return;}let _0x56c1cd=await commonDao[_0x3e90de(0x2b7)](_0x3e90de(0x22b),{'unionID':_0x309365[_0x3e90de(0x1d4)]});if(!_0x56c1cd){_0x37e7f9(null,{'code':code[_0x3e90de(0x290)]});return;}if(_0x56c1cd[_0x3e90de(0x21c)]){_0x37e7f9(null,{'code':code[_0x3e90de(0x232)]});return;}if(!!_0x56c1cd[_0x3e90de(0x276)]&&_0x1f3294['uid']!==_0x56c1cd[_0x3e90de(0x22e)]){_0x37e7f9(null,{'code':code[_0x366943(0x1e8)]});return;}let _0x56b482=await userDao[_0x366943(0x23e)]({'uid':_0x1f3294[_0x3e90de(0x18a)]});if(_0x56b482[_0x366943(0x242)][_0x3e90de(0x296)](_0x340fdc=>_0x340fdc[_0x3e90de(0x1d4)]==_0x309365[_0x3e90de(0x1d4)])){_0x37e7f9(null,{'code':code[_0x3e90de(0x18e)]});return;}if(!_0x56c1cd[_0x366943(0x12c)]){let _0x550287=_0x56c1cd[_0x3e90de(0x16c)];if(_0x550287['find'](_0x4187d4=>_0x4187d4['uid']==_0x1f3294[_0x3e90de(0x18a)])){_0x37e7f9(null,{'code':code[_0x3e90de(0x274)]});return;}await await commonDao[_0x3e90de(0x1f9)](_0x3e90de(0x22b),{'unionID':_0x309365[_0x3e90de(0x1d4)]},{'$push':{'joinRequestList':{'inviteID':_0x12ac8c[_0x366943(0x22a)],'spreaderID':_0x2d6ab1[_0x3e90de(0x18a)],'uid':_0x56b482[_0x3e90de(0x18a)],'nickname':_0x56b482[_0x3e90de(0x2b4)],'avatar':_0x56b482[_0x3e90de(0x1e4)],'createTime':Date[_0x3e90de(0x1dd)]()}}}),logger[_0x366943(0x20e)](_0x3e90de(0x1cc)),_0x37e7f9(null,{'code':code['OK']});}else{await commonDao[_0x3e90de(0x1f9)](_0x366943(0x17c),{'unionID':_0x309365[_0x3e90de(0x1d4)]},{'$inc':{'curMember':0x1}});let _0x142804={'spreaderID':_0x2d6ab1[_0x366943(0x215)],'unionID':_0x309365[_0x3e90de(0x1d4)],'joinTime':Date['now']()},_0x1b8c57=await commonDao[_0x366943(0x119)](_0x3e90de(0x282),{'key':0x1},{'$inc':{'unionInviteID':0x7}},{'new':!![],'upsert':!![]});_0x142804[_0x3e90de(0x223)]=_0x1b8c57[_0x3e90de(0x277)];let _0x4d0518=await userDao[_0x366943(0x1ae)](_0x1f3294[_0x366943(0x215)],{'$push':{'unionInfo':_0x142804}});_0x37e7f9(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x4d0518[_0x366943(0x242)]},'msg':{'unionID':_0x309365[_0x3e90de(0x1d4)]}}),logger[_0x3e90de(0x20d)](_0x3e90de(0x1d6));}}catch(_0x2d40d3){logger[_0x366943(0x123)](_0x366943(0x219)+_0x2d40d3[_0x366943(0x137)]),_0x37e7f9(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x29f)]=async function(_0x39be50,_0x298c48,_0x3b3d00){const _0x200f65=a0_0x1df908,_0x4caa7d=a0_0x5d04f4;try{if(!_0x298c48[_0x4caa7d(0x18a)]){_0x3b3d00(null,{'code':code[_0x200f65(0x1b1)]});return;}let _0x4a2d36=await commonDao[_0x4caa7d(0x2b7)](_0x4caa7d(0x22b),{'unionID':_0x39be50[_0x4caa7d(0x1d4)]});if(!_0x4a2d36){_0x3b3d00(null,{'code':code[_0x4caa7d(0x290)]});return;}let _0x35a70b=await userDao[_0x4caa7d(0x2a9)]({'uid':_0x298c48[_0x200f65(0x215)]}),_0x37456f=_0x35a70b[_0x4caa7d(0x26e)][_0x4caa7d(0x296)](_0x3aba66=>_0x3aba66[_0x4caa7d(0x1d4)]==_0x39be50[_0x4caa7d(0x1d4)]),_0x5d5806=[];_0x37456f&&(_0x4a2d36[_0x4caa7d(0x22e)]==_0x298c48[_0x4caa7d(0x18a)]||_0x37456f[_0x4caa7d(0x199)])&&(_0x5d5806=_0x4a2d36['joinRequestList']),_0x3b3d00(null,{'code':code['OK'],'list':_0x5d5806});}catch(_0x426be9){logger[_0x4caa7d(0x253)](_0x4caa7d(0x1b7)+_0x426be9[_0x4caa7d(0x1c6)]),_0x3b3d00(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x25e)]=async function(_0x26084c,_0x5d7f77,_0x358594){const _0x3ac0b7=a0_0x1df908,_0x1d90c4=a0_0x5d04f4;logger[_0x1d90c4(0x20d)](_0x1d90c4(0x179)+getSimData(_0x26084c)+_0x1d90c4(0x193)+_0x5d7f77[_0x1d90c4(0x18a)]);try{if(!_0x5d7f77[_0x1d90c4(0x18a)]||!_0x26084c[_0x1d90c4(0x18a)]){_0x358594(null,{'code':code[_0x1d90c4(0x1c8)]});return;}let _0x55ea4c=_0x26084c[_0x1d90c4(0x223)],_0x4cbc59=await userDao[_0x1d90c4(0x2a9)]({'unionInfo.inviteID':_0x55ea4c});if(!_0x4cbc59){_0x358594(null,{'code':code[_0x1d90c4(0x1b9)]});return;}let _0x5d2e36=_0x4cbc59[_0x3ac0b7(0x242)]['find'](function(_0x38b4d6){const _0x22f561=_0x1d90c4;return _0x38b4d6[_0x22f561(0x223)]==_0x55ea4c;});if(!_0x5d2e36){_0x358594(null,{'code':code[_0x1d90c4(0x1b9)]});return;}let _0x2060be=await commonDao[_0x1d90c4(0x2b7)](_0x1d90c4(0x22b),{'unionID':_0x5d2e36[_0x3ac0b7(0x1be)]});if(!_0x2060be){_0x358594(null,{'code':code[_0x1d90c4(0x290)]});return;}if(!!_0x2060be[_0x1d90c4(0x276)]&&(_0x5d7f77[_0x1d90c4(0x18a)]!==_0x2060be[_0x1d90c4(0x22e)]||!_0x5d2e36[_0x1d90c4(0x20e)])){_0x358594(null,{'code':code[_0x1d90c4(0x20f)]});return;}await await commonDao[_0x3ac0b7(0x25c)](_0x1d90c4(0x22b),{'unionID':_0x5d2e36[_0x1d90c4(0x1d4)]},{'$inc':{'curMember':0x1},'$pull':{'joinRequestList':{'inviteID':_0x26084c[_0x3ac0b7(0x22a)],'uid':_0x26084c[_0x3ac0b7(0x215)]}}});if(_0x26084c[_0x1d90c4(0x1ae)]){let _0x35f078={'spreaderID':_0x4cbc59[_0x1d90c4(0x18a)],'unionID':_0x5d2e36[_0x1d90c4(0x1d4)],'joinTime':Date[_0x1d90c4(0x1dd)]()},_0x549fce=await commonDao[_0x1d90c4(0x2b2)](_0x1d90c4(0x282),{'key':0x1},{'$inc':{'unionInviteID':0x7}},{'new':!![],'upsert':!![]});_0x35f078[_0x1d90c4(0x223)]=_0x549fce[_0x1d90c4(0x277)];let _0xaff5a7=await userDao[_0x1d90c4(0x26a)](_0x26084c[_0x1d90c4(0x18a)],{'$push':{'unionInfo':_0x35f078}});if(!!_0xaff5a7[_0x1d90c4(0x202)])userInfoServices[_0x3ac0b7(0x18b)](_0xaff5a7[_0x1d90c4(0x18a)],_0xaff5a7[_0x1d90c4(0x202)],{'unionInfo':_0xaff5a7[_0x3ac0b7(0x242)]})[_0x3ac0b7(0x27d)](_0x3b7c7a=>{const _0x12547b=_0x1d90c4;logger[_0x12547b(0x253)](_0x3b7c7a[_0x12547b(0x1c6)]);});logger[_0x1d90c4(0x20d)](_0x1d90c4(0x212));}_0x358594(null,{'code':code['OK']});}catch(_0x59a9d3){logger[_0x1d90c4(0x253)](_0x1d90c4(0x2bb)+_0x59a9d3[_0x1d90c4(0x1c6)]),_0x358594(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x1df908(0x1bd)]=async function(_0x28ee72,_0x597c4e,_0x4cecae){const _0x504133=a0_0x1df908,_0x2492cd=a0_0x5d04f4;try{if(!_0x597c4e[_0x2492cd(0x18a)]){_0x4cecae(null,{'code':code[_0x2492cd(0x1c8)]});return;}let _0x71d76=parseInt(_0x28ee72[_0x2492cd(0x223)]||'0');if(!_0x71d76){_0x4cecae(null,{'code':code['REQUEST_DATA_ERROR']});return;}let _0x2d93c8=await userDao[_0x2492cd(0x2a9)]({'unionInfo.inviteID':_0x71d76});if(!_0x2d93c8){_0x4cecae(null,{'code':code[_0x504133(0x13c)]});return;}let _0x3de7e9=_0x2d93c8[_0x2492cd(0x26e)][_0x2492cd(0x296)](function(_0x4e0369){const _0x15f5fb=_0x2492cd;return _0x4e0369[_0x15f5fb(0x223)]===_0x71d76;});if(!_0x3de7e9){_0x4cecae(null,{'code':code[_0x2492cd(0x1b9)]});return;}let _0x31b47b=await commonDao[_0x2492cd(0x2b7)](_0x2492cd(0x22b),{'unionID':_0x3de7e9['unionID']});if(!_0x31b47b){_0x4cecae(null,{'code':code[_0x2492cd(0x290)]});return;}if(!!_0x31b47b[_0x2492cd(0x276)]&&_0x597c4e[_0x504133(0x215)]!==_0x31b47b[_0x2492cd(0x22e)]){_0x4cecae(null,{'code':code[_0x2492cd(0x20f)]});return;}let _0x4bc638=await userDao[_0x2492cd(0x2a9)]({'uid':_0x597c4e[_0x2492cd(0x18a)]});for(let _0x12957f=0x0;_0x12957f<_0x4bc638[_0x2492cd(0x26e)]['length'];++_0x12957f){let _0x54cca7=_0x4bc638[_0x504133(0x242)][_0x12957f];if(_0x54cca7[_0x2492cd(0x1d4)]===_0x3de7e9[_0x2492cd(0x1d4)]){_0x4cecae(null,{'code':code[_0x2492cd(0x18e)]});return;}}await await commonDao[_0x2492cd(0x1f9)](_0x2492cd(0x22b),{'unionID':_0x3de7e9[_0x2492cd(0x1d4)]},{'$inc':{'curMember':0x1}});let _0x186818={'spreaderID':_0x2d93c8[_0x2492cd(0x18a)],'unionID':_0x3de7e9[_0x2492cd(0x1d4)],'joinTime':Date[_0x504133(0x128)]()},_0x4fb834=await commonDao[_0x2492cd(0x2b2)](_0x2492cd(0x282),{'key':0x1},{'$inc':{'unionInviteID':0x7}},{'new':!![],'upsert':!![]});_0x186818[_0x2492cd(0x223)]=_0x4fb834[_0x2492cd(0x277)];let _0x4187c3=await userDao['updateUserDataByUid'](_0x597c4e[_0x2492cd(0x18a)],{'$push':{'unionInfo':_0x186818}});_0x4cecae(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x4187c3[_0x2492cd(0x26e)]},'msg':{'unionID':_0x3de7e9[_0x504133(0x1be)]}});}catch(_0x278e37){logger['error'](_0x2492cd(0x1e1)+_0x278e37[_0x2492cd(0x1c6)]),_0x4cecae(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x23f)]=async function(_0x155563,_0x1f9955,_0x567e9d){const _0x59779b=a0_0x1df908,_0x490d2c=a0_0x5d04f4;logger[_0x490d2c(0x20d)](_0x59779b(0x273)+getSimData(_0x155563)+_0x490d2c(0x193)+_0x1f9955[_0x490d2c(0x18a)]);try{if(!_0x1f9955[_0x490d2c(0x18a)]){_0x567e9d(null,{'code':code[_0x59779b(0x1b1)]});return;}if(!_0x155563[_0x59779b(0x1be)]){_0x567e9d(null,{'code':code[_0x490d2c(0x1b2)]});return;}let _0x4f775f=await commonDao[_0x490d2c(0x2b7)](_0x490d2c(0x22b),{'unionID':_0x155563[_0x490d2c(0x1d4)]});if(!_0x4f775f){let _0x3a628f=await userDao[_0x59779b(0x1ae)](_0x1f9955[_0x490d2c(0x18a)],{'$push':{'unionInfo':{'unionID':_0x155563[_0x490d2c(0x1d4)]}}});_0x567e9d(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x3a628f[_0x490d2c(0x26e)]}});return;}if(_0x4f775f[_0x59779b(0x27b)]===_0x1f9955[_0x490d2c(0x18a)]){_0x567e9d(null,{'code':code[_0x59779b(0x159)]});return;}let _0x487c45=await userDao[_0x490d2c(0x2a9)]({'uid':_0x1f9955[_0x490d2c(0x18a)],'unionInfo.unionID':_0x155563['unionID']});if(!_0x487c45){_0x567e9d(null,{'code':code['OK']});return;}let _0x262300=null;for(let _0x3adb7f=0x0;_0x3adb7f<_0x487c45[_0x490d2c(0x26e)][_0x490d2c(0x200)];++_0x3adb7f){if(_0x487c45[_0x490d2c(0x26e)][_0x3adb7f][_0x490d2c(0x1d4)]===_0x155563[_0x490d2c(0x1d4)]){_0x262300=_0x487c45[_0x490d2c(0x26e)][_0x3adb7f];break;}}if(!_0x262300){_0x567e9d(null,{'code':code['OK']});return;}if(_0x262300[_0x490d2c(0x1bd)]>0x1||_0x262300[_0x490d2c(0x1bd)]<0x0){_0x567e9d(null,{'code':code[_0x490d2c(0x1b2)]});return;}let _0x14e8aa=await userDao[_0x490d2c(0x26a)](_0x1f9955[_0x490d2c(0x18a)],{'$pull':{'unionInfo':{'unionID':_0x155563[_0x490d2c(0x1d4)]}}});await commonDao[_0x59779b(0x1ec)](_0x59779b(0x12a),{'unionInfo':{'$elemMatch':{'spreaderID':_0x1f9955[_0x490d2c(0x18a)],'unionID':_0x155563[_0x490d2c(0x1d4)]}}},{'unionInfo.$.spreaderID':_0x262300[_0x490d2c(0x1e6)]}),commonDao[_0x59779b(0x25c)](_0x490d2c(0x22b),{'unionID':_0x155563[_0x59779b(0x1be)]},{'$inc':{'curMember':-0x1}})[_0x59779b(0x27d)](_0x58ab96=>{const _0x3b8ff3=_0x59779b,_0x3a7271=_0x490d2c;logger[_0x3b8ff3(0x123)](_0x58ab96[_0x3a7271(0x1c6)]);}),_0x567e9d(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x14e8aa['unionInfo']}}),logger[_0x490d2c(0x20d)](_0x490d2c(0x23b));}catch(_0x16bb88){logger[_0x59779b(0x123)](_0x490d2c(0x255)+_0x16bb88[_0x490d2c(0x1c6)]),_0x567e9d(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x1df908(0x1a4)]=async function(_0x3f822a,_0x3badfd,_0x787b25){const _0x2edab6=a0_0x1df908,_0x295887=a0_0x5d04f4;try{if(!_0x3badfd[_0x295887(0x18a)]){_0x787b25(null,{'code':code[_0x295887(0x1c8)]});return;}let _0x40df99=await userDao[_0x2edab6(0x23d)](_0x3badfd[_0x295887(0x18a)]),_0x205561=[];for(let _0x3667ef=0x0;_0x3667ef<_0x40df99[_0x295887(0x26e)][_0x295887(0x200)];++_0x3667ef){_0x205561[_0x295887(0x2af)](_0x40df99[_0x2edab6(0x242)][_0x3667ef][_0x295887(0x1d4)]);}if(_0x205561[_0x295887(0x200)]===0x0){_0x787b25(null,{'code':code['OK'],'msg':{'recordArr':[]}});return;}let _0x4c4a1e=await commonDao[_0x295887(0x1db)](_0x295887(0x22b),{'unionID':{'$in':_0x205561},'isDel':{'$ne':!![]}}),_0x45cd0a=[];for(let _0x2cf3be=0x0;_0x2cf3be<_0x4c4a1e[_0x295887(0x200)];++_0x2cf3be){let _0x19e90f=_0x4c4a1e[_0x2cf3be];_0x45cd0a[_0x295887(0x2af)]({'unionID':_0x19e90f[_0x295887(0x1d4)],'unionName':_0x19e90f['unionName'],'ownerUid':_0x19e90f[_0x295887(0x22e)],'ownerAvatar':_0x19e90f[_0x295887(0x28d)],'ownerNickname':_0x19e90f[_0x295887(0x1fe)],'memberCount':_0x19e90f[_0x2edab6(0x18f)],'onlineCount':_0x19e90f[_0x295887(0x192)],'tableColor':_0x19e90f[_0x295887(0x1f3)],'unionBg':_0x19e90f[_0x295887(0x257)],'tableStyle':_0x19e90f[_0x295887(0x246)],'emptyTable':_0x19e90f[_0x295887(0x221)],'isInvite':_0x19e90f[_0x295887(0x24e)],'unionSkinId':_0x19e90f[_0x295887(0x1eb)],'unionType':_0x19e90f[_0x295887(0x1ac)],'disApplyCount':_0x19e90f[_0x295887(0x29d)],'inviteLimit':_0x19e90f[_0x2edab6(0x212)],'joinVerify':_0x19e90f[_0x295887(0x17e)],'propsLimit':_0x19e90f[_0x295887(0x1c2)],'tableHideCount':_0x19e90f[_0x295887(0x245)],'unReadyKick':_0x19e90f[_0x295887(0x259)],'groupLimit':_0x19e90f[_0x295887(0x26b)],'tableSort':_0x19e90f[_0x295887(0x216)],'dismissType':_0x19e90f[_0x295887(0x2b0)],'canNegativeScore':_0x19e90f[_0x295887(0x1ef)]});}_0x787b25(null,{'code':code['OK'],'msg':{'recordArr':_0x45cd0a}});}catch(_0x1a9372){logger[_0x2edab6(0x123)](_0x295887(0x173)+_0x1a9372['stack']),_0x787b25(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x5d04f4(0x1a9)]=async function(_0x6a2452,_0x21b316,_0x1dd732){const _0xfa2105=a0_0x1df908,_0xc62a39=a0_0x5d04f4;try{if(!_0x21b316[_0xc62a39(0x18a)]){_0x1dd732(null,{'code':code[_0xc62a39(0x1c8)]});return;}if(!_0x6a2452[_0xfa2105(0x1be)]){_0x1dd732(null,{'code':code[_0xc62a39(0x1b2)]});return;}logger[_0xc62a39(0x253)](_0xfa2105(0x15d)+JSON[_0xc62a39(0x20b)](_0x6a2452)+_0xc62a39(0x193)+_0x21b316[_0xc62a39(0x18a)]);let _0x47ca19=await commonDao[_0xfa2105(0x1c3)](_0xc62a39(0x1e8),_0x6a2452[_0xfa2105(0x147)]||0x0,_0x6a2452[_0xc62a39(0x2aa)]||0x14,{'frontendId':0x1,'roomID':0x1},_0x6a2452['matchData']),_0x4f23bf=await commonDao[_0xc62a39(0x213)](_0xc62a39(0x1e8),_0x6a2452[_0xc62a39(0x22a)]),_0x999d67=[];for(let _0x2c02e1=0x0;_0x2c02e1<_0x47ca19[_0xc62a39(0x1e7)][_0xc62a39(0x200)];++_0x2c02e1){let _0x3cd206=_0x47ca19['recordArr'][_0x2c02e1],_0x5703eb=_0x3cd206[_0xc62a39(0x26e)][_0xc62a39(0x296)](function(_0x4f2c54){const _0x4f124a=_0xfa2105,_0x5d8b2e=_0xc62a39;return _0x4f2c54[_0x5d8b2e(0x1d4)]===_0x6a2452[_0x4f124a(0x1be)];}),_0x316984=null;if(_0x5703eb[_0xfa2105(0x20b)]){let _0x37c9f2=await commonDao[_0xc62a39(0x2b7)](_0xc62a39(0x1e8),{'uid':_0x5703eb[_0xc62a39(0x1e6)]});_0x37c9f2&&(_0x316984={'uid':_0x37c9f2[_0xc62a39(0x18a)],'nickname':utils[_0xfa2105(0x11e)](_0x37c9f2[_0xc62a39(0x2b4)]),'avatar':_0x37c9f2[_0xc62a39(0x1e4)]});}if(_0x3cd206[_0xc62a39(0x202)]=='')continue;_0x999d67[_0xc62a39(0x2af)]({'uid':_0x3cd206[_0xfa2105(0x215)],'avatar':_0x3cd206[_0xc62a39(0x1e4)],'nickname':utils[_0xc62a39(0x1fc)](_0x3cd206[_0xc62a39(0x2b4)]),'lastLoginTime':_0x3cd206[_0xc62a39(0x273)],'roomID':_0x3cd206[_0xfa2105(0x1a8)],'frontendId':_0x3cd206[_0xfa2105(0x1d7)]});}_0x1dd732(null,{'code':code['OK'],'msg':{'recordArr':_0x999d67,'recordCount':_0x4f23bf}});}catch(_0x264e3f){logger['error'](_0xc62a39(0x241)+_0x264e3f[_0xfa2105(0x137)]),_0x1dd732(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x11f)]=async function(_0x199b09,_0x155166,_0x3a34fa){const _0x1986e7=a0_0x1df908,_0x3363ed=a0_0x5d04f4;logger[_0x3363ed(0x20d)](_0x3363ed(0x1de)+getSimData(_0x199b09)+_0x3363ed(0x193)+_0x155166[_0x3363ed(0x18a)]);try{if(!_0x155166[_0x3363ed(0x18a)]){_0x3a34fa(null,{'code':code[_0x3363ed(0x1c8)]});return;}if(!_0x199b09[_0x3363ed(0x1d4)]){_0x3a34fa(null,{'code':code[_0x3363ed(0x1b2)]});return;}let _0xccf1b0=await commonDao[_0x3363ed(0x1d1)](_0x3363ed(0x1e8),_0x199b09[_0x3363ed(0x2ac)]||0x0,_0x199b09['count']||0x14,{'unionInfo.joinTime':0x1},_0x199b09[_0x3363ed(0x22a)]),_0x14c130=_0xccf1b0[_0x3363ed(0x24d)],_0x210ed6=[];if(_0x199b09[_0x3363ed(0x1da)]){for(let _0x3a0eab=0x0;_0x3a0eab<_0xccf1b0[_0x3363ed(0x1e7)]['length'];++_0x3a0eab){let _0x1559ae=_0xccf1b0[_0x3363ed(0x1e7)][_0x3a0eab],_0x5ebe8b=_0x1559ae[_0x3363ed(0x26e)][_0x1986e7(0x1f3)](function(_0x7540ae){const _0x1cab98=_0x1986e7,_0x55f400=_0x3363ed;return _0x7540ae[_0x1cab98(0x1be)]===_0x199b09[_0x55f400(0x1d4)];}),_0x4a3d7f=null;if(_0x5ebe8b[_0x3363ed(0x1e6)]){let _0x5eab55=await commonDao[_0x1986e7(0x26a)](_0x3363ed(0x1e8),{'uid':_0x5ebe8b[_0x3363ed(0x1e6)]});_0x5eab55&&(_0x4a3d7f={'uid':_0x5eab55['uid'],'nickname':utils[_0x1986e7(0x11e)](_0x5eab55[_0x1986e7(0x1ed)]),'avatar':_0x5eab55[_0x3363ed(0x1e4)]});}_0x210ed6[_0x3363ed(0x2af)]({'spreaderInfo':_0x4a3d7f,'uid':_0x1559ae[_0x3363ed(0x18a)],'nickname':utils[_0x3363ed(0x1fc)](_0x1559ae[_0x3363ed(0x2b4)]),'lastLoginTime':_0x1559ae[_0x1986e7(0x1b3)],'avatar':_0x1559ae[_0x3363ed(0x1e4)],'isRobot':_0x1559ae[_0x3363ed(0x1d8)],'frontendId':_0x1559ae[_0x3363ed(0x202)],'roomID':_0x1559ae[_0x1986e7(0x1a8)],'spreaderID':_0x5ebe8b[_0x3363ed(0x1e6)],'score':_0x5ebe8b[_0x3363ed(0x1bd)],'safeScore':_0x5ebe8b[_0x1986e7(0x163)],'prohibitGame':_0x5ebe8b[_0x3363ed(0x256)],'partner':_0x5ebe8b[_0x1986e7(0x184)],'manager':_0x5ebe8b[_0x3363ed(0x199)],'targetScore':_0x5ebe8b[_0x3363ed(0x2b6)],'floatScore':_0x5ebe8b[_0x3363ed(0x2ae)],'yesterdayDraw':_0x5ebe8b[_0x3363ed(0x196)],'yesterdayBigWinDraw':_0x5ebe8b[_0x3363ed(0x2ab)],'yesterdayRebate':_0x5ebe8b[_0x1986e7(0x264)],'todayRebate':_0x5ebe8b[_0x3363ed(0x1d0)],'memberYesterdayDraw':_0x5ebe8b[_0x3363ed(0x1d9)],'memberYesterdayBigWinDraw':_0x5ebe8b[_0x3363ed(0x187)],'yesterdayProvideRebate':_0x5ebe8b[_0x1986e7(0x125)],'todayProvideRebate':_0x5ebe8b[_0x3363ed(0x268)],'todayWin':_0x5ebe8b[_0x3363ed(0x250)],'yesterdayWin':_0x5ebe8b[_0x3363ed(0x23e)],'totalDraw':_0x5ebe8b[_0x3363ed(0x238)],'limitScore':_0x5ebe8b[_0x3363ed(0x1af)],'rebateRate':_0x5ebe8b[_0x1986e7(0x220)],'fixScoreRate':_0x5ebe8b[_0x3363ed(0x22c)],'ticketRate':_0x5ebe8b[_0x3363ed(0x1e5)]});}_0x3a34fa(null,{'code':code['OK'],'msg':{'recordArr':_0x210ed6,'recordCount':_0x14c130}});}else{let _0x3ac1e6=_0x155166[_0x3363ed(0x18a)];if(_0x199b09[_0x1986e7(0x189)]){let _0x2818ee=await commonDao[_0x1986e7(0x26a)](_0x3363ed(0x1e8),{'uid':_0x155166[_0x3363ed(0x18a)]}),_0x32f065=_0x2818ee[_0x3363ed(0x26e)][_0x3363ed(0x296)](function(_0x4b255c){const _0x417e83=_0x3363ed;return _0x4b255c[_0x417e83(0x1d4)]===_0x199b09[_0x417e83(0x1d4)];});_0x32f065&&!_0x32f065[_0x3363ed(0x199)]&&_0xccf1b0[_0x3363ed(0x1e7)][_0x3363ed(0x236)](_0x2818ee);let _0x52c656=await commonDao['findOneData'](_0x1986e7(0x17c),{'unionID':_0x199b09[_0x3363ed(0x1d4)]});_0x52c656&&(_0x52c656[_0x3363ed(0x22e)]!=_0x155166[_0x3363ed(0x18a)]&&_0x32f065[_0x3363ed(0x199)]&&(_0x2818ee=await commonDao[_0x1986e7(0x26a)](_0x3363ed(0x1e8),{'uid':_0x52c656[_0x3363ed(0x22e)]}),_0xccf1b0[_0x3363ed(0x1e7)][_0x1986e7(0x194)](_0x2818ee),_0x3ac1e6=_0x52c656[_0x3363ed(0x22e)]));}let _0x2289e6=await userInfoServices[_0x3363ed(0x29c)](_0x199b09[_0x3363ed(0x1d4)]);for(let _0xd77156=0x0;_0xd77156<_0xccf1b0['recordArr'][_0x3363ed(0x200)];++_0xd77156){let _0x1bf3b1=_0xccf1b0[_0x3363ed(0x1e7)][_0xd77156],_0x552c69=0x0,_0xfd4e1e=0x0,_0x4406c7=0x0,_0x3b1afb=_0x1bf3b1[_0x3363ed(0x26e)][_0x3363ed(0x296)](function(_0x268e89){const _0x198dcc=_0x1986e7;return _0x268e89[_0x198dcc(0x1be)]===_0x199b09['unionID'];});for(let _0x49b9ad=0x0;_0x49b9ad<_0x1bf3b1[_0x3363ed(0x26e)][_0x1986e7(0x130)];++_0x49b9ad){_0x1bf3b1[_0x1986e7(0x242)][_0x49b9ad][_0x3363ed(0x1d4)]===_0x199b09[_0x1986e7(0x1be)]&&(_0x552c69=_0x1bf3b1[_0x1986e7(0x242)][_0x49b9ad][_0x1986e7(0x1f7)],_0xfd4e1e=_0x1bf3b1[_0x3363ed(0x26e)][_0x49b9ad][_0x3363ed(0x27d)],_0x4406c7=_0x1bf3b1[_0x1986e7(0x242)][_0x49b9ad][_0x3363ed(0x25b)]||0x0);}let _0x31e535=await userInfoServices[_0x3363ed(0x168)](_0x1bf3b1[_0x3363ed(0x18a)],_0x199b09[_0x3363ed(0x1d4)],_0x2289e6),_0x421b68=moment()[_0x3363ed(0x22d)](_0x3363ed(0x239)),_0x362269=moment()[_0x3363ed(0x21f)](-0x1,'d')[_0x3363ed(0x22d)](_0x1986e7(0x172)),_0xb9b13a=await userInfoServices[_0x3363ed(0x195)](_0x199b09[_0x3363ed(0x1d4)],_0x31e535,_0x421b68),_0x23fdc0=await userInfoServices[_0x3363ed(0x195)](_0x199b09[_0x3363ed(0x1d4)],_0x31e535,_0x362269),_0x4166c9=_0x31e535[_0x3363ed(0x275)](_0x39bc9b=>_0x39bc9b==_0x1bf3b1[_0x3363ed(0x18a)]),_0x40bd57=await userInfoServices[_0x3363ed(0x1c9)](_0x199b09[_0x1986e7(0x1be)],_0x31e535,![]),_0x266995=_0x40bd57[_0x3363ed(0x24d)],_0x2a61c3=_0x40bd57[_0x3363ed(0x1fd)],_0x5b504a=null;if(_0x3b1afb[_0x1986e7(0x20b)]){let _0x28fcf0=await commonDao[_0x3363ed(0x2b7)](_0x3363ed(0x1e8),{'uid':_0x3b1afb[_0x3363ed(0x1e6)]});_0x28fcf0&&(_0x5b504a={'uid':_0x28fcf0[_0x3363ed(0x18a)],'nickname':utils[_0x3363ed(0x1fc)](_0x28fcf0[_0x1986e7(0x1ed)]),'avatar':_0x28fcf0[_0x3363ed(0x1e4)]});}_0x210ed6[_0x3363ed(0x2af)]({'todayWin':_0xb9b13a[_0x1986e7(0x1ca)],'todayDraw':_0xb9b13a[_0x3363ed(0x1df)],'yesterdayDrawTotal':_0x23fdc0[_0x3363ed(0x1df)],'yesterdayWin':_0x23fdc0[_0x3363ed(0x250)],'spreaderInfo':_0x5b504a,'uid':_0x1bf3b1[_0x3363ed(0x18a)],'playerCount':_0x266995,'totalScore':_0x2a61c3,'nickname':utils['getNickName'](_0x1bf3b1[_0x3363ed(0x2b4)]),'lastLoginTime':_0x1bf3b1[_0x3363ed(0x273)],'avatar':_0x1bf3b1[_0x3363ed(0x1e4)],'frontendId':_0x1bf3b1[_0x3363ed(0x202)],'roomID':_0x1bf3b1[_0x3363ed(0x1bc)],'spreaderID':_0x3b1afb[_0x3363ed(0x1e6)],'score':_0x3b1afb[_0x3363ed(0x1bd)],'saveScore':_0x3b1afb[_0x3363ed(0x25b)]||0x0,'safeScore':_0x3b1afb[_0x3363ed(0x27d)],'prohibitGame':_0x3b1afb[_0x3363ed(0x256)],'yesterdayDraw':_0x3b1afb[_0x3363ed(0x196)],'yesterdayBigWinDraw':_0x3b1afb[_0x3363ed(0x2ab)],'yesterdayRebate':_0x3b1afb[_0x3363ed(0x1cb)],'todayRebate':_0x3b1afb[_0x3363ed(0x1d0)],'memberYesterdayDraw':_0x3b1afb[_0x3363ed(0x1d9)],'memberYesterdayBigWinDraw':_0x3b1afb[_0x3363ed(0x187)],'yesterdayProvideRebate':_0x3b1afb[_0x3363ed(0x2b9)],'totalDraw':_0x3b1afb[_0x1986e7(0x170)],'limitScore':_0x3b1afb[_0x3363ed(0x1af)],'rebateRate':_0x3b1afb[_0x3363ed(0x2b8)],'fixScoreRate':_0x3b1afb[_0x3363ed(0x22c)],'ticketRate':_0x3b1afb[_0x3363ed(0x1e5)],'partner':_0x3b1afb[_0x3363ed(0x20e)],'targetScore':_0x3b1afb[_0x3363ed(0x2b6)],'floatScore':_0x3b1afb[_0x3363ed(0x2ae)]});}_0x3a34fa(null,{'code':code['OK'],'msg':{'recordArr':_0x210ed6,'recordCount':_0x14c130,'totalCount':_0x14c130}});}}catch(_0x155f29){logger[_0x3363ed(0x253)](_0x1986e7(0x17a)+_0x155f29[_0x3363ed(0x1c6)]),_0x3a34fa(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x5d04f4(0x24b)]=async function(_0x284ec1,_0x26bdeb,_0x85d5b4){const _0x447731=a0_0x1df908,_0x39e72=a0_0x5d04f4;try{if(!_0x26bdeb['uid']){_0x85d5b4(null,{'code':code[_0x447731(0x1b1)]});return;}if(!_0x284ec1[_0x447731(0x1be)]){_0x85d5b4(null,{'code':code[_0x39e72(0x1b2)]});return;}logger[_0x39e72(0x253)](_0x39e72(0x1ed)+JSON[_0x39e72(0x20b)](_0x284ec1)+_0x39e72(0x193)+_0x26bdeb[_0x39e72(0x18a)]);let _0x4a248d={'_id':null,'yesterdayTotalDraw':{'$sum':_0x39e72(0x1a5)},'yesterdayTotalProvideRebate':{'$sum':_0x39e72(0x180)},'totalCount':{'$sum':0x1}},_0x3c119f=[{'$unwind':_0x39e72(0x29e)},{'$match':_0x284ec1[_0x447731(0x182)]},{'$group':_0x4a248d}],_0x1c1e71=await commonDao[_0x39e72(0x27b)](_0x447731(0x12a),_0x3c119f),_0x3cc214=0x0,_0x16cef1=0x0,_0x40a24b=0x0;_0x1c1e71['length']>0x0&&(_0x3cc214=_0x1c1e71[0x0][_0x447731(0x226)]||0x0,_0x16cef1=_0x1c1e71[0x0][_0x39e72(0x289)]||0x0,_0x40a24b=_0x1c1e71[0x0][_0x447731(0x187)]),_0x85d5b4(null,{'code':code['OK'],'msg':{'yesterdayTotalDraw':_0x3cc214,'totalCount':_0x40a24b,'yesterdayTotalProvideRebate':_0x16cef1}});}catch(_0x5d9866){logger[_0x39e72(0x253)](_0x39e72(0x188)+_0x5d9866[_0x447731(0x137)]),_0x85d5b4(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x26c)]=async function(_0xcaaa4,_0x2e4041,_0x801a30){const _0x136c30=a0_0x1df908,_0x20d951=a0_0x5d04f4;try{if(!_0x2e4041[_0x20d951(0x18a)]){_0x801a30(null,{'code':code[_0x136c30(0x1b1)]});return;}if(!_0xcaaa4[_0x20d951(0x1d4)]){_0x801a30(null,{'code':code[_0x136c30(0x159)]});return;}let _0x1a6141=await commonDao[_0x20d951(0x2b7)](_0x20d951(0x22b),{'unionID':_0xcaaa4[_0x20d951(0x1d4)]});if(!_0x1a6141){_0x801a30(null,{'code':code[_0x20d951(0x1b2)]});return;}let _0x1a22f4=await commonDao[_0x20d951(0x1d1)](_0x20d951(0x1e8),_0xcaaa4[_0x136c30(0x147)]||0x0,_0xcaaa4[_0x20d951(0x2aa)]||0x14,{'unionInfo.joinTime':0x1},_0xcaaa4['matchData']),_0x2882e9=await commonDao[_0x20d951(0x213)](_0x20d951(0x1e8),_0xcaaa4[_0x20d951(0x22a)]),_0x1e6fc2=[];for(let _0x5df2f3=0x0;_0x5df2f3<_0x1a22f4[_0x20d951(0x1e7)][_0x20d951(0x200)];++_0x5df2f3){let _0x518666=_0x1a22f4[_0x20d951(0x1e7)][_0x5df2f3],_0x4df0c8=_0x518666[_0x20d951(0x26e)][_0x20d951(0x296)](function(_0x21512c){const _0x179136=_0x136c30,_0x381e7f=_0x20d951;return _0x21512c[_0x381e7f(0x1d4)]===_0xcaaa4[_0x179136(0x1be)];});_0x1e6fc2[_0x20d951(0x2af)]({'uid':_0x518666[_0x20d951(0x18a)],'isRobot':_0x518666[_0x20d951(0x1d8)],'nickname':utils[_0x20d951(0x1fc)](_0x518666[_0x136c30(0x1ed)]),'avatar':_0x518666[_0x20d951(0x1e4)],'score':_0x4df0c8[_0x20d951(0x1bd)],'safeScore':_0x4df0c8[_0x20d951(0x27d)],'saveScore':_0x4df0c8[_0x136c30(0x1d6)]||0x0,'spreaderID':_0x4df0c8[_0x20d951(0x1e6)]});}let _0x1d8723=await userDao[_0x20d951(0x1e9)](_0x2e4041[_0x20d951(0x18a)]);if(!_0x1d8723){_0x801a30(null,{'code':code[_0x20d951(0x283)]});return;}let _0xf276a=_0x1d8723[_0x20d951(0x26e)][_0x136c30(0x1f3)](function(_0x381e65){const _0x4adccb=_0x20d951;return _0x381e65[_0x4adccb(0x1d4)]===_0xcaaa4[_0x4adccb(0x1d4)];});if(!_0xf276a){_0x801a30(null,{'code':code[_0x136c30(0x159)]});return;}let _0x1570d0=null;if(_0x1a6141[_0x20d951(0x22e)]===_0x2e4041[_0x136c30(0x215)]||_0xf276a[_0x20d951(0x199)])_0x1570d0=await commonDao[_0x20d951(0x1d1)](_0x136c30(0x12a),0x0,0x0,{'unionInfo.score':-0x1},_0xcaaa4[_0x20d951(0x22a)]);else{let _0x1a4666={'unionInfo':{'$elemMatch':{'unionID':_0xcaaa4[_0x20d951(0x1d4)],'spreaderID':_0x2e4041[_0x20d951(0x18a)]}}};_0x1570d0=await commonDao[_0x136c30(0x1c3)](_0x20d951(0x1e8),0x0,0x0,{'unionInfo.score':-0x1},_0x1a4666);}let _0x1b8d86=_0x1570d0[_0x136c30(0x263)][_0x136c30(0x130)],_0x42a331=0x0;for(let _0x48d51d=0x0;_0x48d51d<_0x1570d0[_0x136c30(0x263)][_0x136c30(0x130)];++_0x48d51d){let _0x107327=_0x1570d0[_0x20d951(0x1e7)][_0x48d51d],_0x3f6d60=_0x107327[_0x20d951(0x26e)][_0x136c30(0x1f3)](function(_0x20c529){const _0x33426c=_0x20d951;return _0x20c529[_0x33426c(0x1d4)]===_0xcaaa4[_0x33426c(0x1d4)];});_0x3f6d60&&(_0x42a331+=parseFloat((_0x3f6d60[_0x20d951(0x1bd)]+(_0x3f6d60[_0x20d951(0x25b)]||0x0)+_0x3f6d60[_0x20d951(0x27d)])[_0x20d951(0x285)](0x2)));}_0x801a30(null,{'code':code['OK'],'msg':{'recordArr':_0x1e6fc2,'recordCount':_0x2882e9,'totalCount':_0x1b8d86,'totalScore':_0x42a331}});}catch(_0x222794){logger[_0x20d951(0x253)](_0x20d951(0x229)+_0x222794[_0x136c30(0x137)]),_0x801a30(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x1df908(0x1d5)]=async function(_0x34b8b3,_0x1eec24,_0x2db8d1){const _0x4b8932=a0_0x1df908,_0x4fb740=a0_0x5d04f4;if(!userListPenging[_0x1eec24[_0x4b8932(0x215)]])userListPenging[_0x1eec24[_0x4b8932(0x215)]]=moment();else{if(moment()[_0x4fb740(0x226)](userListPenging[_0x1eec24[_0x4fb740(0x18a)]],'s')<0x3){_0x2db8d1(null,{'code':code[_0x4fb740(0x1b2)]});return;}userListPenging[_0x1eec24[_0x4fb740(0x18a)]]=moment();}logger[_0x4fb740(0x20d)](_0x4b8932(0x16c)+getSimData(_0x34b8b3)+_0x4b8932(0x1d4)+_0x1eec24[_0x4fb740(0x18a)]);try{if(!_0x1eec24[_0x4b8932(0x215)]){_0x2db8d1(null,{'code':code[_0x4fb740(0x1c8)]});return;}if(!_0x34b8b3[_0x4fb740(0x1d4)]){_0x2db8d1(null,{'code':code[_0x4fb740(0x1b2)]});return;}let _0x32cbbf=await userDao[_0x4fb740(0x251)](_0x1eec24['uid']);if(!_0x32cbbf){_0x2db8d1(null,{'code':code[_0x4fb740(0x283)]});return;}if(!!_0x32cbbf[_0x4b8932(0x1a8)]){await userDao[_0x4fb740(0x18d)](_0x1eec24[_0x4fb740(0x18a)]),_0x2db8d1(null,{'code':code[_0x4fb740(0x1b2)]});return;}let _0x266d20=null;for(let _0x5e707c=0x0;_0x5e707c<_0x32cbbf[_0x4b8932(0x242)][_0x4fb740(0x200)];++_0x5e707c){if(_0x32cbbf['unionInfo'][_0x5e707c][_0x4fb740(0x1d4)]===_0x34b8b3[_0x4b8932(0x1be)]){_0x266d20=_0x32cbbf[_0x4fb740(0x26e)][_0x5e707c];break;}}if(!_0x266d20){await userDao[_0x4fb740(0x18d)](_0x1eec24[_0x4fb740(0x18a)]),_0x2db8d1(null,{'code':code[_0x4fb740(0x1b2)]});return;}let _0x226e32=_0x266d20[_0x4b8932(0x163)];_0x34b8b3[_0x4b8932(0x1c0)]&&(_0x226e32=parseFloat(_0x34b8b3[_0x4fb740(0x2aa)]));if(_0x266d20[_0x4fb740(0x27d)]<=0x0||_0x226e32>_0x266d20[_0x4fb740(0x27d)]){await userDao[_0x4fb740(0x18d)](_0x1eec24[_0x4fb740(0x18a)]),_0x2db8d1(null,{'code':code[_0x4fb740(0x1b2)]});return;}let _0x37d0cf={'$inc':{'unionInfo.$.score':_0x226e32,'unionInfo.$.safeScore':-_0x226e32}},_0x53b99d=await userDao[_0x4fb740(0x194)]({'uid':_0x1eec24[_0x4fb740(0x18a)],'unionInfo.unionID':_0x266d20[_0x4fb740(0x1d4)]},_0x37d0cf),_0x67767d={'uid':_0x1eec24[_0x4fb740(0x18a)],'unionID':_0x34b8b3[_0x4b8932(0x1be)],'count':_0x226e32,'type':0x0,'createTime':Date[_0x4b8932(0x128)]()};await commonDao['createData'](_0x4fb740(0x2a7),_0x67767d);let _0x18ce30=_0x53b99d[_0x4fb740(0x26e)][_0x4b8932(0x1f3)](function(_0x1b92a3){const _0x4e6fed=_0x4fb740;return _0x1b92a3[_0x4e6fed(0x1d4)]===_0x34b8b3[_0x4e6fed(0x1d4)];});_0x226e32=_0x226e32[_0x4fb740(0x285)](0x2);let _0x5e7e6d={'uid':_0x1eec24[_0x4fb740(0x18a)],'nickname':_0x53b99d[_0x4fb740(0x2b4)],'unionID':_0x34b8b3[_0x4b8932(0x1be)],'changeCount':_0x226e32,'leftCount':_0x18ce30[_0x4fb740(0x1bd)],'leftSafeBoxCount':_0x18ce30[_0x4fb740(0x27d)],'leftSaveBoxCount':_0x18ce30[_0x4b8932(0x1d6)],'changeType':enumeration[_0x4b8932(0x1ad)][_0x4fb740(0x19a)],'describe':_0x4fb740(0x17c)+_0x226e32,'createTime':Date[_0x4fb740(0x1dd)]()};await commonDao[_0x4b8932(0x127)](_0x4fb740(0x234),_0x5e7e6d),await commonDao[_0x4fb740(0x214)](_0x4b8932(0x1f4),_0x5e7e6d)[_0x4fb740(0x260)](_0x3a76eb=>{const _0x119382=_0x4fb740;logger[_0x119382(0x253)](_0x3a76eb[_0x119382(0x1c6)]);}),_0x2db8d1(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x53b99d[_0x4fb740(0x26e)]}}),logger[_0x4fb740(0x20d)](_0x4fb740(0x235));}catch(_0x1dcd3e){logger[_0x4fb740(0x253)](_0x4fb740(0x2a2)+_0x1dcd3e[_0x4b8932(0x137)]),_0x2db8d1(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x16f)]=async function(_0x2ee7b,_0xfeccea,_0x24d0b0){const _0x14c622=a0_0x1df908,_0x310abd=a0_0x5d04f4;logger[_0x310abd(0x20d)](_0x14c622(0x1e1)+getSimData(_0x2ee7b)+_0x310abd(0x193)+_0xfeccea[_0x14c622(0x215)]);if(!userListPenging[_0xfeccea[_0x310abd(0x18a)]])userListPenging[_0xfeccea[_0x310abd(0x18a)]]=moment();else{if(moment()[_0x310abd(0x226)](userListPenging[_0xfeccea[_0x310abd(0x18a)]],'s')<0x3){_0x24d0b0(null,{'code':code['REQUEST_DATA_ERROR']});return;}userListPenging[_0xfeccea[_0x310abd(0x18a)]]=moment();}logger[_0x310abd(0x20d)]('[saveBoxOperation]\x20step\x202\x20msg\x20=\x20'+getSimData(_0x2ee7b)+_0x310abd(0x193)+_0xfeccea[_0x310abd(0x18a)]);try{if(!_0xfeccea[_0x310abd(0x18a)]){_0x24d0b0(null,{'code':code[_0x310abd(0x1c8)]});return;}if(!_0x2ee7b[_0x310abd(0x1d4)]||!_0x2ee7b[_0x310abd(0x2aa)]||typeof _0x2ee7b[_0x14c622(0x1c0)]!==_0x310abd(0x24c)){_0x24d0b0(null,{'code':code[_0x310abd(0x1b2)]});return;}let _0x1cec10=await userDao[_0x14c622(0x267)](_0xfeccea[_0x310abd(0x18a)]);if(!_0x1cec10){_0x24d0b0(null,{'code':code[_0x310abd(0x283)]});return;}if(!!_0x1cec10[_0x310abd(0x1bc)]){await userDao[_0x310abd(0x18d)](_0xfeccea[_0x310abd(0x18a)]),_0x24d0b0(null,{'code':code[_0x14c622(0x232)]});return;}let _0x2026b1=null;for(let _0x3a8b9c=0x0;_0x3a8b9c<_0x1cec10[_0x310abd(0x26e)][_0x310abd(0x200)];++_0x3a8b9c){if(_0x1cec10[_0x14c622(0x242)][_0x3a8b9c][_0x310abd(0x1d4)]===_0x2ee7b[_0x14c622(0x1be)]){_0x2026b1=_0x1cec10[_0x310abd(0x26e)][_0x3a8b9c];break;}}if(!_0x2026b1){await userDao[_0x14c622(0x247)](_0xfeccea[_0x310abd(0x18a)]),_0x24d0b0(null,{'code':code[_0x310abd(0x215)]});return;}if(_0x2ee7b[_0x310abd(0x2aa)]>0x0&&_0x2026b1['score']<_0x2ee7b[_0x310abd(0x2aa)]||_0x2ee7b[_0x14c622(0x1c0)]<0x0&&_0x2026b1[_0x14c622(0x1d6)]+_0x2ee7b[_0x310abd(0x2aa)]<0x0){await userDao[_0x310abd(0x18d)](_0xfeccea[_0x310abd(0x18a)]),_0x24d0b0(null,{'code':code[_0x14c622(0x232)]});return;}let _0xcb7aa3={'$inc':{'unionInfo.$.score':-_0x2ee7b[_0x14c622(0x1c0)],'unionInfo.$.saveScore':_0x2ee7b[_0x14c622(0x1c0)]}},_0x4d206c=await userDao[_0x310abd(0x194)]({'uid':_0xfeccea['uid'],'unionInfo.unionID':_0x2026b1[_0x310abd(0x1d4)]},_0xcb7aa3),_0x1f1a0c={'uid':_0xfeccea[_0x14c622(0x215)],'unionID':_0x2ee7b[_0x310abd(0x1d4)],'count':_0x2ee7b[_0x310abd(0x2aa)],'type':0x1,'createTime':Date[_0x310abd(0x1dd)]()};await commonDao[_0x310abd(0x214)](_0x310abd(0x2a7),_0x1f1a0c);let _0x46971b=_0x4d206c[_0x310abd(0x26e)][_0x310abd(0x296)](function(_0x164f98){const _0xbaebdc=_0x14c622,_0x5e7221=_0x310abd;return _0x164f98[_0xbaebdc(0x1be)]===_0x2ee7b[_0x5e7221(0x1d4)];}),_0x139671={'uid':_0xfeccea[_0x310abd(0x18a)],'nickname':_0x4d206c[_0x14c622(0x1ed)],'unionID':_0x2ee7b[_0x310abd(0x1d4)],'changeCount':-_0x2ee7b[_0x310abd(0x2aa)],'leftCount':_0x46971b[_0x310abd(0x1bd)],'leftSafeBoxCount':_0x46971b[_0x310abd(0x27d)]||0x0,'leftSaveBoxCount':_0x46971b[_0x310abd(0x25b)]||0x0,'changeType':enumeration[_0x310abd(0x1b5)][_0x310abd(0x1d2)],'describe':_0x2ee7b[_0x310abd(0x2aa)]>0x0?_0x310abd(0x292)+_0x2ee7b[_0x310abd(0x2aa)]:_0x310abd(0x271)+_0x2ee7b[_0x310abd(0x2aa)]*-0x1,'createTime':Date[_0x310abd(0x1dd)]()};await commonDao[_0x14c622(0x127)](_0x310abd(0x234),_0x139671),await commonDao[_0x310abd(0x214)](_0x310abd(0x1ea),_0x139671)[_0x310abd(0x260)](_0x129d39=>{const _0x14d95d=_0x310abd;logger[_0x14d95d(0x253)](_0x129d39[_0x14d95d(0x1c6)]);}),_0x24d0b0(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x4d206c[_0x310abd(0x26e)]}}),logger[_0x310abd(0x20d)](_0x14c622(0x199));}catch(_0x1b2106){logger[_0x310abd(0x253)](_0x310abd(0x2c1)+_0x1b2106[_0x310abd(0x1c6)]),_0x24d0b0(null,{'code':0x1f4});}},Handler['prototype'][a0_0x1df908(0x12e)]=async function(_0x502d35,_0x4ca1cf,_0x83d6bc){const _0x1871a1=a0_0x1df908,_0x1f63e5=a0_0x5d04f4;logger[_0x1f63e5(0x20d)](_0x1f63e5(0x1fa)+getSimData(_0x502d35)+_0x1f63e5(0x193)+_0x4ca1cf[_0x1f63e5(0x18a)]);try{if(!_0x4ca1cf[_0x1f63e5(0x18a)]){_0x83d6bc(null,{'code':code[_0x1f63e5(0x1c8)]});return;}if(!_0x502d35[_0x1871a1(0x1be)]){_0x83d6bc(null,{'code':code['REQUEST_DATA_ERROR']});return;}let _0x43d611={'uid':_0x4ca1cf[_0x1f63e5(0x18a)],'unionID':_0x502d35[_0x1871a1(0x1be)],'type':_0x502d35[_0x1f63e5(0x175)],'createTime':{'$gte':Date[_0x1f63e5(0x1dd)]()-WEEK_MS}},_0x2243e8=await commonDao[_0x1f63e5(0x1d1)](_0x1f63e5(0x2a7),_0x502d35[_0x1f63e5(0x2ac)]||0x0,_0x502d35[_0x1f63e5(0x2aa)]||0x14,{'createTime':-0x1},_0x43d611);_0x83d6bc(null,{'code':code['OK'],'msg':_0x2243e8});}catch(_0x19cb11){logger[_0x1f63e5(0x253)](_0x1f63e5(0x297)+_0x19cb11[_0x1f63e5(0x1c6)]),_0x83d6bc(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x293)]=async function(_0x5b4276,_0x5023a9,_0x35296f){const _0xd8ae18=a0_0x1df908,_0x3cee65=a0_0x5d04f4;logger[_0x3cee65(0x20d)](_0x3cee65(0x222)+getSimData(_0x5b4276)+_0xd8ae18(0x1d4)+_0x5023a9[_0x3cee65(0x18a)]);if(!userListPenging[_0x5023a9[_0x3cee65(0x18a)]])userListPenging[_0x5023a9[_0xd8ae18(0x215)]]=moment();else{if(moment()[_0x3cee65(0x226)](userListPenging[_0x5023a9[_0xd8ae18(0x215)]],'s')<0x3){_0x35296f(null,{'code':code[_0x3cee65(0x283)]});return;}userListPenging[_0x5023a9[_0x3cee65(0x18a)]]=moment();}logger[_0x3cee65(0x20d)](_0x3cee65(0x28e)+getSimData(_0x5b4276)+_0xd8ae18(0x1d4)+_0x5023a9[_0x3cee65(0x18a)]);try{if(!_0x5023a9[_0xd8ae18(0x215)]){_0x35296f(null,{'code':code['INVALID_UERS']});return;}let _0xbb632f=await commonDao[_0x3cee65(0x2b7)]('unionModel',{'unionID':_0x5b4276[_0x3cee65(0x1d4)]});if(_0xbb632f&&_0x5023a9['uid']==_0x5b4276[_0xd8ae18(0x139)]&&_0x5b4276[_0x3cee65(0x265)]==_0xbb632f[_0x3cee65(0x22e)]){let _0x24d845=await userDao[_0xd8ae18(0x267)](_0x5023a9[_0x3cee65(0x18a)]),_0x373bda=await userDao[_0x3cee65(0x194)]({'uid':_0x5b4276[_0x3cee65(0x265)],'unionInfo.unionID':_0x5b4276[_0x3cee65(0x1d4)]},{'$inc':{'unionInfo.$.score':_0x5b4276[_0x3cee65(0x2aa)]}}),_0x51fc90={'uid':_0x5023a9[_0xd8ae18(0x215)],'nickname':_0x24d845[_0x3cee65(0x2b4)],'avatar':_0x24d845[_0x3cee65(0x1e4)],'gainUid':_0x5b4276[_0x3cee65(0x265)],'gainNickname':_0x24d845[_0x3cee65(0x2b4)],'gainAvatar':_0x24d845[_0xd8ae18(0x1da)],'unionID':_0x5b4276[_0x3cee65(0x1d4)],'count':_0x5b4276[_0x3cee65(0x2aa)],'createTime':Date[_0x3cee65(0x1dd)]()};commonDao[_0x3cee65(0x214)](_0x3cee65(0x201),_0x51fc90)[_0x3cee65(0x260)](_0x35add6=>{const _0x35fe06=_0x3cee65;logger[_0x35fe06(0x253)](_0x35add6[_0x35fe06(0x1c6)]);});if(!!_0x373bda[_0x3cee65(0x202)])userInfoServices[_0x3cee65(0x28c)](_0x373bda[_0x3cee65(0x18a)],_0x373bda[_0xd8ae18(0x1d7)],{'unionInfo':_0x373bda[_0xd8ae18(0x242)]})[_0x3cee65(0x260)](_0x2eb5d8=>{const _0x4e55e5=_0xd8ae18,_0x3dd761=_0x3cee65;logger[_0x3dd761(0x253)](_0x2eb5d8[_0x4e55e5(0x137)]);});let _0x1834bd=[],_0x40c1c2=_0x373bda[_0x3cee65(0x26e)][_0x3cee65(0x296)](function(_0x2b103e){const _0x488ca1=_0x3cee65;return _0x2b103e[_0x488ca1(0x1d4)]===_0x5b4276[_0x488ca1(0x1d4)];});_0x1834bd[_0xd8ae18(0x1f0)]({'uid':_0x373bda[_0xd8ae18(0x215)],'nickname':_0x373bda[_0x3cee65(0x2b4)],'unionID':_0x5b4276[_0x3cee65(0x1d4)],'changeCount':_0x5b4276['count'],'leftCount':_0x40c1c2[_0x3cee65(0x1bd)],'leftSafeBoxCount':_0x40c1c2[_0x3cee65(0x27d)],'changeType':enumeration[_0x3cee65(0x1b5)]['MODIFY_UP'],'describe':_0x5b4276[_0x3cee65(0x2aa)]>0x0?_0x3cee65(0x2b3)+_0x24d845[_0x3cee65(0x18a)]+'加分'+_0x5b4276[_0x3cee65(0x2aa)]:'盟主自己'+_0x24d845[_0x3cee65(0x18a)]+'减分'+_0x5b4276[_0x3cee65(0x2aa)]*-0x1,'createTime':Date[_0x3cee65(0x1dd)]()}),await commonDao[_0x3cee65(0x258)](_0x3cee65(0x234),_0x1834bd),await commonDao[_0x3cee65(0x258)](_0x3cee65(0x1ea),_0x1834bd)[_0xd8ae18(0x27d)](_0x340762=>{const _0xe6b792=_0x3cee65;logger[_0xe6b792(0x253)](_0x340762[_0xe6b792(0x1c6)]);}),_0x35296f(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x373bda[_0x3cee65(0x26e)]}}),logger[_0x3cee65(0x20d)](_0x3cee65(0x1c0));}else{if(!_0x5b4276[_0x3cee65(0x1d4)]||!_0x5b4276[_0x3cee65(0x2aa)]||typeof _0x5b4276[_0x3cee65(0x2aa)]!==_0x3cee65(0x24c)||!_0x5b4276[_0x3cee65(0x265)]||_0x5023a9[_0x3cee65(0x18a)]===_0x5b4276[_0x3cee65(0x265)]){_0x35296f(null,{'code':code[_0x3cee65(0x1b2)]});return;}if(!_0xbb632f){_0x35296f(null,{'code':code[_0x3cee65(0x1b2)]});return;}if(!!_0xbb632f[_0xd8ae18(0x1dc)]&&_0x5023a9[_0xd8ae18(0x215)]!==_0xbb632f[_0x3cee65(0x22e)]){_0x35296f(null,{'code':code[_0x3cee65(0x206)]});return;}let _0x53d271=await userDao[_0x3cee65(0x251)](_0x5023a9[_0xd8ae18(0x215)]);if(!_0x53d271){_0x35296f(null,{'code':code['REQUEST_DATA_ERROR']});return;}if(!!_0x53d271[_0x3cee65(0x1bc)]){await userDao[_0x3cee65(0x18d)](_0x5023a9[_0x3cee65(0x18a)]),_0x35296f(null,{'code':code[_0x3cee65(0x215)]});return;}let _0x1796d7=null;for(let _0x1d7dc8=0x0;_0x1d7dc8<_0x53d271[_0x3cee65(0x26e)][_0xd8ae18(0x130)];++_0x1d7dc8){if(_0x53d271[_0x3cee65(0x26e)][_0x1d7dc8][_0x3cee65(0x1d4)]===_0x5b4276[_0xd8ae18(0x1be)]){_0x1796d7=_0x53d271[_0x3cee65(0x26e)][_0x1d7dc8];break;}}if(!_0x1796d7||_0x1796d7[_0xd8ae18(0x1f7)]<_0x5b4276[_0xd8ae18(0x1c0)]){await userDao[_0x3cee65(0x18d)](_0x5023a9[_0x3cee65(0x18a)]),_0x35296f(null,{'code':code[_0xd8ae18(0x11b)]});return;}if(_0x1796d7[_0x3cee65(0x199)]&&_0x5b4276[_0x3cee65(0x2aa)]<0x0&&_0x5b4276[_0x3cee65(0x265)]==_0xbb632f[_0x3cee65(0x22e)]){await userDao[_0x3cee65(0x18d)](_0x5023a9[_0x3cee65(0x18a)]),_0x35296f(null,{'code':code[_0x3cee65(0x262)]});return;}let _0x3cd358=await userDao[_0xd8ae18(0x267)](_0x5b4276[_0xd8ae18(0x139)]);if(!_0x3cd358){await userDao[_0x3cee65(0x18d)](_0x5023a9[_0x3cee65(0x18a)]),await userDao[_0xd8ae18(0x247)](_0x5b4276[_0x3cee65(0x265)]),_0x35296f(null,{'code':code[_0x3cee65(0x215)]});return;}if(!!_0x3cd358[_0x3cee65(0x1bc)]&&_0x5b4276[_0x3cee65(0x2aa)]<0x0){await userDao[_0x3cee65(0x18d)](_0x5b4276[_0xd8ae18(0x139)]),await userDao[_0x3cee65(0x18d)](_0x5023a9[_0x3cee65(0x18a)]),_0x35296f(null,{'code':code[_0x3cee65(0x215)]});return;}let _0x4b704c=null;for(let _0x1b4275=0x0;_0x1b4275<_0x3cd358['unionInfo'][_0x3cee65(0x200)];++_0x1b4275){if(_0x3cd358[_0x3cee65(0x26e)][_0x1b4275][_0xd8ae18(0x1be)]===_0x5b4276[_0xd8ae18(0x1be)]){_0x4b704c=_0x3cd358[_0x3cee65(0x26e)][_0x1b4275];break;}}if(!_0x4b704c||_0x5b4276[_0x3cee65(0x2aa)]<0x0&&_0x4b704c[_0x3cee65(0x1bd)]+_0x5b4276[_0xd8ae18(0x1c0)]<0x0){await userDao[_0xd8ae18(0x247)](_0x5023a9[_0x3cee65(0x18a)]),await userDao[_0x3cee65(0x18d)](_0x5b4276[_0x3cee65(0x265)]),_0x35296f(null,{'code':code[_0x3cee65(0x186)]});return;}logger[_0x3cee65(0x20d)](_0x3cee65(0x27c)+_0x5023a9[_0x3cee65(0x18a)]+_0xd8ae18(0x1ce)+_0xbb632f[_0x3cee65(0x22e)]+_0xd8ae18(0x1cd)+_0x1796d7[_0xd8ae18(0x184)]+_0x3cee65(0x1f1)+_0x1796d7[_0x3cee65(0x199)]+_0x3cee65(0x1c5)+_0x4b704c[_0x3cee65(0x1e6)]);if(!_0x1796d7[_0x3cee65(0x199)]&&!_0x1796d7[_0x3cee65(0x20e)]){await userDao[_0x3cee65(0x18d)](_0x5023a9[_0x3cee65(0x18a)]),await userDao[_0x3cee65(0x18d)](_0x5b4276[_0x3cee65(0x265)]),_0x35296f(null,{'code':code[_0x3cee65(0x262)]});return;}if(_0x4b704c[_0xd8ae18(0x20b)]==_0x5023a9[_0x3cee65(0x18a)]||_0x5023a9[_0x3cee65(0x18a)]==_0xbb632f[_0xd8ae18(0x27b)]||_0x1796d7[_0x3cee65(0x199)]){if(_0x4b704c[_0x3cee65(0x1bd)]<=0x1&&_0x5b4276[_0x3cee65(0x2aa)]>0x0){let _0x483b08=await userDao['updateUserData']({'uid':_0x5b4276[_0x3cee65(0x265)],'unionInfo.unionID':_0x5b4276[_0x3cee65(0x1d4)]},{'unionInfo.$.targetScore':_0x5b4276[_0x3cee65(0x2aa)],'unionInfo.$.floatScore':_0x5b4276[_0x3cee65(0x2aa)]/0x2});}let _0x1f9ed9=await userDao[_0x3cee65(0x194)]({'uid':_0x5023a9[_0x3cee65(0x18a)],'unionInfo.unionID':_0x5b4276[_0x3cee65(0x1d4)]},{'$inc':{'unionInfo.$.score':-_0x5b4276[_0x3cee65(0x2aa)]}}),_0x11a903=await userDao[_0x3cee65(0x194)]({'uid':_0x5b4276['memberUid'],'unionInfo.unionID':_0x5b4276[_0x3cee65(0x1d4)]},{'$inc':{'unionInfo.$.score':_0x5b4276[_0xd8ae18(0x1c0)]}}),_0xe64c6c={'uid':_0x5023a9[_0x3cee65(0x18a)],'nickname':_0x53d271[_0x3cee65(0x2b4)],'avatar':_0x53d271[_0x3cee65(0x1e4)],'gainUid':_0x5b4276[_0xd8ae18(0x139)],'gainNickname':_0x3cd358[_0x3cee65(0x2b4)],'gainAvatar':_0x3cd358[_0x3cee65(0x1e4)],'unionID':_0x5b4276[_0x3cee65(0x1d4)],'count':_0x5b4276[_0xd8ae18(0x1c0)],'createTime':Date['now']()};commonDao[_0x3cee65(0x214)](_0x3cee65(0x201),_0xe64c6c)[_0x3cee65(0x260)](_0x1d7930=>{const _0x476222=_0x3cee65;logger[_0x476222(0x253)](_0x1d7930[_0x476222(0x1c6)]);});if(!!_0x11a903[_0x3cee65(0x202)])userInfoServices[_0x3cee65(0x28c)](_0x11a903[_0x3cee65(0x18a)],_0x11a903[_0x3cee65(0x202)],{'unionInfo':_0x11a903[_0x3cee65(0x26e)]})[_0x3cee65(0x260)](_0xb35f0a=>{const _0x7d32ef=_0x3cee65;logger[_0x7d32ef(0x253)](_0xb35f0a[_0x7d32ef(0x1c6)]);});let _0x3429cf=_0x1f9ed9[_0x3cee65(0x26e)]['find'](function(_0x2c2d85){const _0x2709a9=_0xd8ae18,_0x380b91=_0x3cee65;return _0x2c2d85[_0x380b91(0x1d4)]===_0x5b4276[_0x2709a9(0x1be)];}),_0x6ec789=[];_0x6ec789[_0x3cee65(0x2af)]({'uid':_0x1f9ed9[_0x3cee65(0x18a)],'nickname':_0x1f9ed9[_0xd8ae18(0x1ed)],'unionID':_0x5b4276[_0x3cee65(0x1d4)],'changeCount':-_0x5b4276[_0x3cee65(0x2aa)],'leftCount':_0x3429cf[_0x3cee65(0x1bd)],'leftSafeBoxCount':_0x3429cf[_0xd8ae18(0x163)],'leftSaveBoxCount':_0x3429cf[_0x3cee65(0x25b)],'changeType':enumeration[_0x3cee65(0x1b5)][_0x3cee65(0x267)],'describe':_0x5b4276[_0xd8ae18(0x1c0)]>0x0?'给下级'+_0x11a903[_0x3cee65(0x18a)]+'加分'+_0x5b4276[_0xd8ae18(0x1c0)]:_0x3cee65(0x227)+_0x11a903[_0x3cee65(0x18a)]+'减分'+_0x5b4276['count']*-0x1,'createTime':Date[_0x3cee65(0x1dd)]()});let _0x31a1da=_0x11a903[_0x3cee65(0x26e)][_0x3cee65(0x296)](function(_0x4a48f0){const _0x29680b=_0x3cee65;return _0x4a48f0[_0x29680b(0x1d4)]===_0x5b4276[_0x29680b(0x1d4)];});_0x6ec789[_0x3cee65(0x2af)]({'uid':_0x11a903[_0xd8ae18(0x215)],'nickname':_0x11a903[_0xd8ae18(0x1ed)],'unionID':_0x5b4276[_0x3cee65(0x1d4)],'changeCount':_0x5b4276[_0xd8ae18(0x1c0)],'leftCount':_0x31a1da[_0xd8ae18(0x1f7)],'leftSafeBoxCount':_0x31a1da[_0x3cee65(0x27d)],'leftSaveBoxCount':_0x31a1da[_0x3cee65(0x25b)],'changeType':enumeration[_0x3cee65(0x1b5)][_0x3cee65(0x1a7)],'describe':_0x5b4276[_0x3cee65(0x2aa)]>0x0?'上级'+_0x1f9ed9[_0x3cee65(0x18a)]+'加分'+_0x5b4276[_0xd8ae18(0x1c0)]:'上级'+_0x1f9ed9[_0x3cee65(0x18a)]+'减分'+_0x5b4276[_0x3cee65(0x2aa)]*-0x1,'createTime':Date[_0x3cee65(0x1dd)]()}),await commonDao[_0x3cee65(0x258)](_0x3cee65(0x234),_0x6ec789),await commonDao[_0x3cee65(0x258)](_0x3cee65(0x1ea),_0x6ec789)[_0x3cee65(0x260)](_0x361829=>{const _0x1c6485=_0x3cee65;logger[_0x1c6485(0x253)](_0x361829[_0x1c6485(0x1c6)]);}),_0x35296f(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x1f9ed9['unionInfo']}}),logger[_0x3cee65(0x20d)](_0xd8ae18(0x161));}else{await userDao[_0x3cee65(0x18d)](_0x5b4276[_0xd8ae18(0x139)]),await userDao[_0x3cee65(0x18d)](_0x5023a9[_0xd8ae18(0x215)]),_0x35296f(null,{'code':code[_0xd8ae18(0x250)]});return;}}}catch(_0x4dd5fe){logger[_0xd8ae18(0x123)](_0x3cee65(0x18c)+_0x4dd5fe[_0x3cee65(0x1c6)]),_0x35296f(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x26d)]=async function(_0x4ef3d5,_0x5a145a,_0x1471ff){const _0xc6d521=a0_0x1df908,_0x402193=a0_0x5d04f4;logger[_0x402193(0x20d)](_0x402193(0x1d7)+getSimData(_0x4ef3d5)+_0x402193(0x193)+_0x5a145a[_0x402193(0x18a)]);try{if(!_0x5a145a[_0x402193(0x18a)]){_0x1471ff(null,{'code':code[_0x402193(0x1c8)]});return;}if(!_0x4ef3d5[_0x402193(0x1d4)]||!_0x4ef3d5[_0x402193(0x265)]){_0x1471ff(null,{'code':code[_0x402193(0x1c8)]});return;}let _0x5be3b4=await commonDao[_0x402193(0x2b7)](_0x402193(0x22b),{'unionID':_0x4ef3d5[_0xc6d521(0x1be)]});if(!_0x5be3b4){_0x1471ff(null,{'code':code[_0x402193(0x1c8)]});return;}if(!!_0x5be3b4[_0x402193(0x276)]){_0x1471ff(null,{'code':code[_0x402193(0x20f)]});return;}let _0x539eca=await userDao[_0x402193(0x1e9)](_0x5a145a[_0xc6d521(0x215)]);if(!_0x539eca){_0x1471ff(null,{'code':code[_0x402193(0x1b2)]});return;}let _0x55186a=_0x539eca[_0x402193(0x26e)][_0xc6d521(0x1f3)](function(_0x51025e){const _0x374dcc=_0xc6d521,_0xed7bb4=_0x402193;return _0x51025e[_0xed7bb4(0x1d4)]===_0x4ef3d5[_0x374dcc(0x1be)];});if(!_0x55186a){_0x1471ff(null,{'code':code[_0x402193(0x262)]});return;}logger[_0x402193(0x20d)](_0x402193(0x177)+_0x5be3b4[_0x402193(0x22e)]+_0x402193(0x1f1)+_0x55186a[_0x402193(0x199)]+_0x402193(0x193)+_0x5a145a[_0x402193(0x18a)]);let _0x2a3ca0=await userDao[_0x402193(0x1e9)](_0x4ef3d5[_0xc6d521(0x139)]);if(!_0x2a3ca0){_0x1471ff(null,{'code':code[_0xc6d521(0x1b1)]});return;}let _0x4f3c75=_0x2a3ca0[_0xc6d521(0x242)][_0x402193(0x296)](function(_0x17463c){const _0x10b7fa=_0xc6d521,_0xa51294=_0x402193;return _0x17463c[_0x10b7fa(0x1be)]===_0x4ef3d5[_0xa51294(0x1d4)];});if(!!_0x4f3c75){if(_0x4f3c75[_0x402193(0x20e)]){_0x1471ff(null,{'code':code['OK']});return;}let _0x2b9ba2=await userDao[_0x402193(0x294)]({'uid':_0x4ef3d5[_0x402193(0x265)],'unionInfo.unionID':_0x4ef3d5[_0xc6d521(0x1be)]},{'unionInfo.$.partner':!![]});if(!!_0x2b9ba2[_0x402193(0x202)])userInfoServices[_0x402193(0x28c)](_0x2b9ba2['uid'],_0x2b9ba2[_0x402193(0x202)],{'unionInfo':_0x2b9ba2[_0xc6d521(0x242)]})[_0x402193(0x260)](_0x5ebcc2=>{const _0x4d6ee4=_0xc6d521;logger[_0x4d6ee4(0x123)](_0x5ebcc2['stack']);});_0x1471ff(null,{'code':code['OK']}),logger[_0x402193(0x20d)](_0x402193(0x1e0));return;}else{await commonDao[_0x402193(0x1f9)](_0x402193(0x22b),{'unionID':_0x4ef3d5[_0x402193(0x1d4)]},{'$inc':{'curMember':0x1}});let _0x42670e=_0x2a3ca0[_0xc6d521(0x215)],_0x3736e0=_0x2a3ca0[_0xc6d521(0x1da)],_0x11c2fe=_0x2a3ca0[_0x402193(0x2b4)],_0x3b6714=_0x539eca[_0xc6d521(0x215)],_0xb9d320=_0x539eca[_0x402193(0x1e4)],_0x25abab=_0x539eca[_0x402193(0x2b4)];await commonDao[_0x402193(0x214)]('userDelModel',{'type':0x0,'doneUid':_0x42670e,'doneAvatar':_0x3736e0,'doneNickname':_0x11c2fe,'uid':_0x3b6714,'avatar':_0xb9d320,'nickname':_0x25abab,'score':0x0,'unionID':_0x4ef3d5[_0x402193(0x1d4)],'createTime':Date[_0x402193(0x1dd)]()});let _0x2f8ada={'unionID':_0x4ef3d5[_0x402193(0x1d4)],'spreaderID':_0x5a145a[_0xc6d521(0x215)],'partner':!![],'joinTime':Date[_0x402193(0x1dd)]()},_0x2b963d=await commonDao[_0x402193(0x2b2)](_0x402193(0x282),{'key':0x1},{'$inc':{'unionInviteID':0x7}},{'new':!![],'upsert':!![]});_0x2f8ada[_0x402193(0x223)]=_0x2b963d[_0x402193(0x277)];let _0x3b80ff=await userDao[_0x402193(0x26a)](_0x4ef3d5[_0x402193(0x265)],{'$push':{'unionInfo':_0x2f8ada}});if(!!_0x3b80ff[_0x402193(0x202)])userInfoServices[_0x402193(0x28c)](_0x3b80ff[_0xc6d521(0x215)],_0x3b80ff[_0x402193(0x202)],{'unionInfo':_0x3b80ff[_0x402193(0x26e)]})[_0x402193(0x260)](_0x5abaff=>{const _0x130df8=_0x402193;logger['error'](_0x5abaff[_0x130df8(0x1c6)]);});_0x1471ff(null,{'code':code['OK']}),logger['info'](_0x402193(0x1f5));}}catch(_0x3a47b4){logger[_0x402193(0x253)](_0x402193(0x1d3)+_0x3a47b4[_0xc6d521(0x137)]),_0x1471ff(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x21a)]=async function(_0x1e8503,_0x2d1af7,_0x4eaba5){const _0x8cd89e=a0_0x1df908,_0x41aad6=a0_0x5d04f4;logger[_0x41aad6(0x20d)](_0x41aad6(0x23c)+getSimData(_0x1e8503)+_0x41aad6(0x193)+_0x2d1af7[_0x41aad6(0x18a)]);try{if(!_0x2d1af7[_0x41aad6(0x18a)]){_0x4eaba5(null,{'code':code[_0x41aad6(0x1c8)]});return;}if(!_0x1e8503[_0x41aad6(0x1d4)]||!_0x1e8503[_0x41aad6(0x265)]){_0x4eaba5(null,{'code':code[_0x41aad6(0x1b2)]});return;}if(_0x2d1af7[_0x41aad6(0x18a)]==_0x1e8503[_0x8cd89e(0x139)]){_0x4eaba5(null,{'code':code[_0x8cd89e(0x22b)]});return;}let _0x47aeac=await commonDao[_0x41aad6(0x2b7)](_0x41aad6(0x22b),{'unionID':_0x1e8503[_0x8cd89e(0x1be)]});if(!_0x47aeac){_0x4eaba5(null,{'code':code[_0x41aad6(0x1b2)]});return;}let _0x3bf722=await userDao['getUserDataByUid'](_0x2d1af7['uid']);if(!_0x3bf722){_0x4eaba5(null,{'code':code[_0x8cd89e(0x159)]});return;}let _0x14d977=_0x3bf722[_0x41aad6(0x26e)][_0x41aad6(0x296)](function(_0x4f16d6){const _0x1fc265=_0x8cd89e,_0x39d253=_0x41aad6;return _0x4f16d6[_0x1fc265(0x1be)]===_0x1e8503[_0x39d253(0x1d4)];});if(!_0x14d977){_0x4eaba5(null,{'code':code[_0x41aad6(0x1b2)]});return;}let _0x4472ea=await userDao[_0x41aad6(0x1e9)](_0x1e8503[_0x41aad6(0x265)]);if(!_0x4472ea){_0x4eaba5(null,{'code':code[_0x41aad6(0x25a)]});return;}let _0x245432=_0x4472ea['unionInfo'][_0x41aad6(0x296)](function(_0x1410ee){const _0x455c69=_0x41aad6;return _0x1410ee[_0x455c69(0x1d4)]===_0x1e8503[_0x455c69(0x1d4)];});if(_0x47aeac[_0x41aad6(0x22e)]!==_0x2d1af7[_0x41aad6(0x18a)]){_0x4eaba5(null,{'code':code[_0x41aad6(0x262)]});return;}logger[_0x41aad6(0x20d)](_0x8cd89e(0x1ab)+_0x47aeac['ownerUid']+_0x41aad6(0x193)+_0x2d1af7[_0x41aad6(0x18a)]);let _0x1bcc1f=_0x1e8503[_0x41aad6(0x254)]||![];if(!_0x1bcc1f&&_0x245432[_0x41aad6(0x199)]){_0x4eaba5(null,{'code':code['OK']});return;}if(_0x1bcc1f&&!_0x245432[_0x41aad6(0x199)]){_0x4eaba5(null,{'code':code['OK']});return;}let _0x982304=_0x1bcc1f?![]:!![],_0x3606c1=await userDao[_0x41aad6(0x294)]({'uid':_0x1e8503['memberUid'],'unionInfo.unionID':_0x1e8503['unionID']},{'unionInfo.$.manager':_0x982304});if(!!_0x3606c1[_0x41aad6(0x202)])userInfoServices[_0x41aad6(0x28c)](_0x3606c1[_0x41aad6(0x18a)],_0x3606c1['frontendId'],{'unionInfo':_0x3606c1[_0x41aad6(0x26e)]})[_0x41aad6(0x260)](_0x3fa08f=>{const _0x3b1dea=_0x41aad6;logger[_0x3b1dea(0x253)](_0x3fa08f['stack']);});_0x4eaba5(null,{'code':code['OK']}),logger[_0x8cd89e(0x20e)](_0x41aad6(0x1e2));}catch(_0x40973a){logger[_0x41aad6(0x253)]('[addManager]'+_0x40973a[_0x41aad6(0x1c6)]),_0x4eaba5(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x218)]=async function(_0xcbdff2,_0x5b9621,_0x49a3cb){const _0x8c3429=a0_0x1df908,_0x4ca10c=a0_0x5d04f4;try{if(!_0x5b9621[_0x4ca10c(0x18a)]){_0x49a3cb(null,{'code':code[_0x8c3429(0x1b1)]});return;}if(!_0xcbdff2[_0x4ca10c(0x1d4)]||!_0xcbdff2['matchData']){_0x49a3cb(null,{'code':code[_0x4ca10c(0x1b2)]});return;}let _0x3cb0f9=await commonDao[_0x4ca10c(0x1d1)](_0x8c3429(0x1c1),_0xcbdff2[_0x4ca10c(0x2ac)],_0xcbdff2[_0x4ca10c(0x2aa)],{'createTime':-0x1},_0xcbdff2[_0x4ca10c(0x22a)]),_0x453692=0x0;{let _0x57fcc7={'_id':null,'totalCount':{'$sum':'$count'}},_0x2d7800=[{'$match':_0xcbdff2[_0x4ca10c(0x22a)]},{'$group':_0x57fcc7}],_0x3cf4d5=await commonDao[_0x4ca10c(0x27b)](_0x4ca10c(0x201),_0x2d7800);_0x3cf4d5[_0x4ca10c(0x200)]>0x0&&(_0x453692=_0x3cf4d5[0x0][_0x4ca10c(0x24d)]);}_0x49a3cb(null,{'code':code['OK'],'msg':{'recordArr':_0x3cb0f9[_0x8c3429(0x263)],'totalCount':_0x3cb0f9[_0x4ca10c(0x24d)],'totalScoreCount':_0x453692}});}catch(_0x52ac4c){logger[_0x4ca10c(0x253)](_0x4ca10c(0x1a3)+_0x52ac4c[_0x4ca10c(0x1c6)]),_0x49a3cb(null,{'code':0x1f4});}},Handler['prototype'][a0_0x5d04f4(0x2bf)]=async function(_0x421c47,_0x5c279a,_0x5d1d3d){const _0x14298c=a0_0x1df908,_0x53b178=a0_0x5d04f4;logger[_0x53b178(0x20d)]('[inviteJoinUnion]\x20msg\x20=\x20'+getSimData(_0x421c47)+_0x53b178(0x193)+_0x5c279a[_0x53b178(0x18a)]);try{if(!_0x5c279a[_0x53b178(0x18a)]){_0x5d1d3d(null,{'code':code[_0x53b178(0x1c8)]});return;}if(!_0x421c47[_0x53b178(0x1d4)]||!_0x421c47[_0x14298c(0x215)]){_0x5d1d3d(null,{'code':code[_0x53b178(0x1c8)]});return;}let _0x4004d7=await commonDao[_0x53b178(0x2b7)](_0x53b178(0x22b),{'unionID':_0x421c47[_0x53b178(0x1d4)]});if(!_0x4004d7){_0x5d1d3d(null,{'code':code[_0x53b178(0x1c8)]});return;}if(!!_0x4004d7[_0x14298c(0x1b7)]){_0x5d1d3d(null,{'code':code[_0x53b178(0x20f)]});return;}let _0x3872cd=await userDao[_0x53b178(0x1e9)](_0x5c279a[_0x53b178(0x18a)]);if(!_0x3872cd){_0x5d1d3d(null,{'code':code[_0x53b178(0x1b2)]});return;}let _0x13de6c=_0x3872cd[_0x14298c(0x242)][_0x53b178(0x296)](function(_0x2ced08){const _0x46dbbd=_0x53b178;return _0x2ced08[_0x46dbbd(0x1d4)]===_0x421c47[_0x46dbbd(0x1d4)];});if(!_0x13de6c){_0x5d1d3d(null,{'code':code[_0x53b178(0x1b2)]});return;}let _0x283e9e=await userDao[_0x53b178(0x1e9)](_0x421c47[_0x53b178(0x18a)]);if(!_0x283e9e){_0x5d1d3d(null,{'code':code[_0x14298c(0x1b1)]});return;}let _0x1bc75f=_0x283e9e[_0x14298c(0x242)][_0x53b178(0x296)](function(_0x468dea){const _0xcd391d=_0x53b178;return _0x468dea[_0xcd391d(0x1d4)]===_0x421c47[_0xcd391d(0x1d4)];});if(!!_0x1bc75f){_0x5d1d3d(null,{'code':code[_0x53b178(0x18e)]});return;}logger[_0x53b178(0x20d)](_0x53b178(0x263)+_0x4004d7[_0x53b178(0x22e)]+_0x53b178(0x18f)+_0x13de6c['partner']+_0x53b178(0x1f1)+_0x13de6c[_0x53b178(0x199)]+_0x53b178(0x231)+_0x5c279a[_0x53b178(0x18a)]);if(_0x5c279a[_0x14298c(0x215)]!==_0x4004d7[_0x53b178(0x22e)]&&!_0x13de6c[_0x53b178(0x20e)]&&!_0x13de6c[_0x53b178(0x199)]){_0x5d1d3d(null,{'code':code[_0x14298c(0x22b)]});return;}await await commonDao[_0x53b178(0x1f9)](_0x14298c(0x17c),{'unionID':_0x421c47[_0x14298c(0x1be)]},{'$inc':{'curMember':0x1}});let _0x55946a=_0x283e9e[_0x53b178(0x18a)],_0xbf83e8=_0x283e9e[_0x14298c(0x1da)],_0x14efd8=_0x283e9e[_0x53b178(0x2b4)],_0x5c904e=_0x3872cd[_0x53b178(0x18a)],_0x2d06a2=_0x3872cd[_0x53b178(0x1e4)],_0xeb744=_0x3872cd[_0x53b178(0x2b4)];await commonDao[_0x53b178(0x214)]('userDelModel',{'type':0x0,'doneUid':_0x55946a,'doneAvatar':_0xbf83e8,'doneNickname':_0x14efd8,'uid':_0x5c904e,'avatar':_0x2d06a2,'nickname':_0xeb744,'score':0x0,'unionID':_0x421c47[_0x53b178(0x1d4)],'createTime':Date[_0x53b178(0x1dd)]()});let _0x3e3edc={'unionID':_0x421c47[_0x53b178(0x1d4)],'spreaderID':_0x5c279a['uid'],'partner':![],'joinTime':Date['now']()},_0x202b57=await commonDao[_0x53b178(0x2b2)](_0x53b178(0x282),{'key':0x1},{'$inc':{'unionInviteID':0x7}},{'new':!![],'upsert':!![]});_0x3e3edc[_0x14298c(0x22a)]=_0x202b57[_0x53b178(0x277)];let _0x2c77db=await userDao['updateUserDataByUid'](_0x421c47[_0x14298c(0x215)],{'$push':{'unionInfo':_0x3e3edc}});if(!!_0x2c77db[_0x53b178(0x202)])userInfoServices[_0x53b178(0x28c)](_0x2c77db[_0x53b178(0x18a)],_0x2c77db['frontendId'],{'unionInfo':_0x2c77db[_0x14298c(0x242)]})[_0x53b178(0x260)](_0x1cf737=>{const _0x34427e=_0x14298c,_0x3cdf76=_0x53b178;logger[_0x34427e(0x123)](_0x1cf737[_0x3cdf76(0x1c6)]);});_0x5d1d3d(null,{'code':code['OK']}),logger[_0x14298c(0x20e)](_0x53b178(0x189));}catch(_0x367de0){logger[_0x53b178(0x253)](_0x53b178(0x1f0)+_0x367de0[_0x53b178(0x1c6)]),_0x5d1d3d(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x1cc)]=async function(_0x3a812b,_0x2940d,_0x460a2f){const _0xd904f8=a0_0x1df908,_0x364e41=a0_0x5d04f4;logger[_0x364e41(0x20d)](_0xd904f8(0x245)+getSimData(_0x3a812b)+_0x364e41(0x193)+_0x2940d[_0x364e41(0x18a)]);try{if(!_0x2940d[_0xd904f8(0x215)]){_0x460a2f(null,{'code':code[_0x364e41(0x1c8)]});return;}if(!_0x3a812b[_0x364e41(0x18a)]||!_0x3a812b[_0xd904f8(0x1be)]){_0x460a2f(null,{'code':code[_0x364e41(0x1b2)]});return;}let _0x3f50e0=await userDao[_0xd904f8(0x23d)](_0x2940d[_0x364e41(0x18a)]),_0x5a91f8=_0x3f50e0[_0xd904f8(0x1bc)][_0x364e41(0x296)](function(_0x306c4a){const _0x1fdb82=_0xd904f8,_0x4c72f9=_0x364e41;return _0x306c4a[_0x4c72f9(0x1d4)]===_0x3a812b[_0x1fdb82(0x1be)]&&_0x306c4a[_0x1fdb82(0x215)]===_0x3a812b[_0x4c72f9(0x18a)];});if(!_0x5a91f8){_0x460a2f(null,{'code':code[_0x364e41(0x1b2)]});return;}async function _0x1d4964(_0x40f91a){const _0x531182=_0xd904f8,_0x328b38=_0x364e41;return await userDao[_0x531182(0x1ae)](_0x2940d[_0x328b38(0x18a)],_0x40f91a);}if(!_0x3a812b[_0x364e41(0x171)]){let _0x4e94f3=await _0x1d4964({'$pull':{'inviteMsg':{'unionID':_0x3a812b[_0x364e41(0x1d4)],'uid':_0x3a812b[_0xd904f8(0x215)]}}});_0x460a2f(null,{'code':code['OK'],'updateUserData':{'inviteMsg':_0x4e94f3[_0x364e41(0x170)]}});return;}if(_0x3f50e0[_0xd904f8(0x242)][_0x364e41(0x200)]>=0x14){_0x460a2f(null,{'code':code[_0xd904f8(0x159)]});return;}let _0x219ee2=await commonDao[_0x364e41(0x2b7)]('unionModel',{'unionID':_0x3a812b[_0xd904f8(0x1be)]});if(!_0x219ee2){let _0x567e0d=await _0x1d4964({'$pull':{'inviteMsg':{'unionID':_0x3a812b[_0x364e41(0x1d4)]}}});_0x460a2f(null,{'code':code[_0x364e41(0x1b2)],'updateUserData':{'inviteMsg':_0x567e0d[_0x364e41(0x170)]}});return;}let _0x1a7226=_0x3f50e0[_0x364e41(0x26e)][_0xd904f8(0x1f3)](function(_0x412e35){const _0x545ee1=_0x364e41;return _0x412e35[_0x545ee1(0x1d4)]===_0x3a812b[_0x545ee1(0x1d4)];});if(!!_0x1a7226){let _0x216f9e=await _0x1d4964({'$pull':{'inviteMsg':{'unionID':_0x3a812b[_0x364e41(0x1d4)]}}});_0x460a2f(null,{'code':code['OK'],'updateUserData':{'inviteMsg':_0x216f9e[_0x364e41(0x170)]}});return;}await await commonDao[_0x364e41(0x1f9)](_0x364e41(0x22b),{'unionID':_0x3a812b[_0x364e41(0x1d4)]},{'$inc':{'curMember':0x1}});let _0x55d295={'unionID':_0x3a812b[_0xd904f8(0x1be)],'spreaderID':_0x3a812b[_0xd904f8(0x215)],'partner':_0x5a91f8[_0x364e41(0x20e)],'joinTime':Date[_0x364e41(0x1dd)]()},_0x1ddc8c=await commonDao[_0x364e41(0x2b2)](_0xd904f8(0x1cf),{'key':0x1},{'$inc':{'unionInviteID':0x7}},{'new':!![],'upsert':!![]});_0x55d295['inviteID']=_0x1ddc8c[_0x364e41(0x277)];let _0x1c3926=await userDao[_0xd904f8(0x1ae)](_0x2940d[_0x364e41(0x18a)],{'$push':{'unionInfo':_0x55d295},'$pull':{'inviteMsg':{'unionID':_0x3a812b[_0x364e41(0x1d4)]}}});_0x460a2f(null,{'code':code['OK'],'updateUserData':{'inviteMsg':_0x1c3926[_0x364e41(0x170)],'unionInfo':_0x1c3926[_0x364e41(0x26e)]}});}catch(_0x20f8f7){logger[_0x364e41(0x253)](_0x364e41(0x1b4)+_0x20f8f7['stack']),_0x460a2f(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x1ce)]=async function(_0x405c99,_0x4fda78,_0x43b5eb){const _0x55420d=a0_0x1df908,_0x504a65=a0_0x5d04f4;try{if(!_0x4fda78[_0x504a65(0x18a)]){_0x43b5eb(null,{'code':code[_0x504a65(0x1c8)]});return;}_0x405c99[_0x504a65(0x2b8)]=_0x405c99[_0x504a65(0x1e5)];if(!_0x405c99[_0x504a65(0x1d4)]||!_0x405c99[_0x504a65(0x265)]||typeof _0x405c99[_0x504a65(0x2b8)]!==_0x504a65(0x24c)||_0x405c99[_0x55420d(0x220)]>0x1||_0x405c99['rebateRate']<0x0){_0x43b5eb(null,{'code':code[_0x55420d(0x159)]});return;}let _0x1bfc83=await commonDao[_0x504a65(0x2b7)]('unionModel',{'unionID':_0x405c99[_0x504a65(0x1d4)]});if(!_0x1bfc83){_0x43b5eb(null,{'code':code[_0x55420d(0x22b)]});return;}let _0x16e16c=await userDao[_0x504a65(0x1e9)](_0x4fda78[_0x504a65(0x18a)]);if(!_0x16e16c){_0x43b5eb(null,{'code':code[_0x504a65(0x262)]});return;}let _0x5186c2=_0x16e16c['unionInfo'][_0x55420d(0x1f3)](function(_0x263ac5){const _0x5c6005=_0x55420d,_0x211182=_0x504a65;return _0x263ac5[_0x211182(0x1d4)]===_0x405c99[_0x5c6005(0x1be)];});if(!_0x5186c2){_0x43b5eb(null,{'code':code[_0x504a65(0x1b2)]});return;}let _0x104a75=await userDao[_0x55420d(0x23d)](_0x405c99[_0x504a65(0x265)]);if(!_0x104a75){_0x43b5eb(null,{'code':code[_0x504a65(0x215)]});return;}let _0x4edad5=_0x104a75[_0x504a65(0x26e)][_0x504a65(0x296)](function(_0x205a11){const _0x2ef3b9=_0x55420d,_0x42d64f=_0x504a65;return _0x205a11[_0x2ef3b9(0x1be)]===_0x405c99[_0x42d64f(0x1d4)];});if(!_0x4edad5||_0x4edad5[_0x504a65(0x1e6)]!==_0x4fda78[_0x504a65(0x18a)]){_0x43b5eb(null,{'code':code[_0x504a65(0x262)]});return;}let _0x4baee8=await userDao[_0x504a65(0x294)]({'uid':_0x405c99[_0x504a65(0x265)],'unionInfo.unionID':_0x405c99[_0x504a65(0x1d4)]},{'unionInfo.$.ticketRate':_0x405c99[_0x504a65(0x2b8)]});if(!!_0x4baee8[_0x55420d(0x1d7)])userInfoServices[_0x504a65(0x28c)](_0x4baee8[_0x504a65(0x18a)],_0x4baee8[_0x504a65(0x202)],{'unionInfo':_0x4baee8[_0x504a65(0x26e)]})[_0x504a65(0x260)](_0x29642a=>{const _0x4fb288=_0x504a65;logger[_0x4fb288(0x253)](_0x29642a);});_0x43b5eb(null,{'code':code['OK']});}catch(_0x539b6c){logger[_0x504a65(0x253)](_0x55420d(0x168)+_0x539b6c[_0x504a65(0x1c6)]),_0x43b5eb(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x207)]=async function(_0x2c51ea,_0x29f67a,_0x4795af){const _0x5f0e3b=a0_0x1df908,_0x37aec1=a0_0x5d04f4;try{if(!_0x29f67a[_0x37aec1(0x18a)]){_0x4795af(null,{'code':code[_0x37aec1(0x1c8)]});return;}if(!_0x2c51ea['unionID']||!_0x2c51ea[_0x37aec1(0x265)]||typeof _0x2c51ea[_0x37aec1(0x2b8)]!==_0x37aec1(0x24c)||_0x2c51ea[_0x37aec1(0x2b8)]>0x1||_0x2c51ea[_0x37aec1(0x2b8)]<0x0){_0x4795af(null,{'code':code['REQUEST_DATA_ERROR']});return;}let _0x502b5b=await commonDao[_0x37aec1(0x2b7)](_0x37aec1(0x22b),{'unionID':_0x2c51ea[_0x37aec1(0x1d4)]});if(!_0x502b5b){_0x4795af(null,{'code':code[_0x5f0e3b(0x22b)]});return;}let _0x2e8fea=await userDao[_0x37aec1(0x1e9)](_0x29f67a[_0x37aec1(0x18a)]);if(!_0x2e8fea){_0x4795af(null,{'code':code[_0x37aec1(0x262)]});return;}let _0x8cf5af=_0x2e8fea[_0x5f0e3b(0x242)][_0x37aec1(0x296)](function(_0xf2119b){const _0x495918=_0x37aec1;return _0xf2119b[_0x495918(0x1d4)]===_0x2c51ea[_0x495918(0x1d4)];});if(!_0x8cf5af||_0x8cf5af[_0x5f0e3b(0x220)]<_0x2c51ea['rebateRate']){_0x4795af(null,{'code':code[_0x37aec1(0x1b2)]});return;}let _0xf1326c=await userDao[_0x37aec1(0x1e9)](_0x2c51ea[_0x37aec1(0x265)]);if(!_0xf1326c){_0x4795af(null,{'code':code[_0x37aec1(0x215)]});return;}let _0x42dc87=_0xf1326c[_0x37aec1(0x26e)][_0x37aec1(0x296)](function(_0x38ebf1){const _0x220fd3=_0x37aec1;return _0x38ebf1[_0x220fd3(0x1d4)]===_0x2c51ea[_0x220fd3(0x1d4)];});if(!_0x42dc87||_0x42dc87[_0x37aec1(0x1e6)]!==_0x29f67a[_0x37aec1(0x18a)]){_0x4795af(null,{'code':code[_0x37aec1(0x262)]});return;}let _0x54370b=await userDao[_0x37aec1(0x294)]({'uid':_0x2c51ea[_0x37aec1(0x265)],'unionInfo.unionID':_0x2c51ea[_0x37aec1(0x1d4)]},{'unionInfo.$.rebateRate':_0x2c51ea[_0x37aec1(0x2b8)]});if(!!_0x54370b[_0x37aec1(0x202)])userInfoServices[_0x37aec1(0x28c)](_0x54370b[_0x37aec1(0x18a)],_0x54370b[_0x37aec1(0x202)],{'unionInfo':_0x54370b[_0x37aec1(0x26e)]})[_0x37aec1(0x260)](_0x3cac46=>{const _0xc3fbf5=_0x37aec1;logger[_0xc3fbf5(0x253)](_0x3cac46);});_0x4795af(null,{'code':code['OK']});}catch(_0x15a368){logger[_0x37aec1(0x253)](_0x37aec1(0x183)+_0x15a368[_0x37aec1(0x1c6)]),_0x4795af(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x5d04f4(0x252)]=async function(_0x4362a7,_0x236d48,_0x321eb1){const _0x4657a6=a0_0x1df908,_0x4b8748=a0_0x5d04f4;try{if(!_0x236d48[_0x4657a6(0x215)]){_0x321eb1(null,{'code':code[_0x4b8748(0x1c8)]});return;}if(!_0x4362a7[_0x4b8748(0x1d4)]||!_0x4362a7['memberUid']||typeof _0x4362a7[_0x4b8748(0x1af)]!==_0x4b8748(0x24c)){_0x321eb1(null,{'code':code[_0x4657a6(0x159)]});return;}let _0x4ba69c=await commonDao[_0x4b8748(0x2b7)](_0x4b8748(0x22b),{'unionID':_0x4362a7[_0x4b8748(0x1d4)]});if(!_0x4ba69c){_0x321eb1(null,{'code':code[_0x4b8748(0x1b2)]});return;}let _0x5c8277=await userDao[_0x4657a6(0x23d)](_0x236d48[_0x4657a6(0x215)]);if(!_0x5c8277){_0x321eb1(null,{'code':code[_0x4b8748(0x1b2)]});return;}let _0x1e3e8f=_0x5c8277[_0x4b8748(0x26e)][_0x4b8748(0x296)](function(_0x4e267a){const _0x19619c=_0x4657a6,_0xbca7a2=_0x4b8748;return _0x4e267a[_0xbca7a2(0x1d4)]===_0x4362a7[_0x19619c(0x1be)];});if(!_0x1e3e8f){_0x321eb1(null,{'code':code[_0x4b8748(0x1b2)]});return;}let _0x4b0e0f=await userDao[_0x4b8748(0x1e9)](_0x4362a7[_0x4b8748(0x265)]);if(!_0x4b0e0f){_0x321eb1(null,{'code':code[_0x4b8748(0x215)]});return;}let _0x5a7389=_0x4b0e0f[_0x4b8748(0x26e)][_0x4657a6(0x1f3)](function(_0x319ce8){const _0x13b2a4=_0x4657a6,_0x52cbdb=_0x4b8748;return _0x319ce8[_0x52cbdb(0x1d4)]===_0x4362a7[_0x13b2a4(0x1be)];});if(!_0x5a7389||_0x5a7389[_0x4b8748(0x1e6)]!==_0x236d48[_0x4b8748(0x18a)]){_0x321eb1(null,{'code':code[_0x4b8748(0x262)]});return;}let _0x5de2b4=await userDao[_0x4b8748(0x294)]({'uid':_0x4362a7[_0x4657a6(0x139)],'unionInfo.unionID':_0x4362a7[_0x4b8748(0x1d4)]},{'unionInfo.$.limitScore':_0x4362a7['limitScore']});if(!!_0x5de2b4[_0x4657a6(0x1d7)])userInfoServices[_0x4657a6(0x18b)](_0x5de2b4[_0x4b8748(0x18a)],_0x5de2b4['frontendId'],{'unionInfo':_0x5de2b4[_0x4b8748(0x26e)]})[_0x4b8748(0x260)](_0x33e405=>{const _0x4701ee=_0x4b8748;logger[_0x4701ee(0x253)](_0x33e405);});_0x321eb1(null,{'code':code['OK']});}catch(_0x3a3239){logger[_0x4b8748(0x253)](_0x4b8748(0x264)+_0x3a3239[_0x4b8748(0x1c6)]),_0x321eb1(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x243)]=async function(_0x2f7be2,_0x4e5787,_0xb50ec6){const _0x5a9c33=a0_0x1df908,_0x2e147e=a0_0x5d04f4;try{if(!_0x4e5787[_0x2e147e(0x18a)]){_0xb50ec6(null,{'code':code[_0x5a9c33(0x1b1)]});return;}if(!_0x2f7be2[_0x2e147e(0x1d4)]||!_0x2f7be2[_0x2e147e(0x265)]){_0xb50ec6(null,{'code':code[_0x2e147e(0x1b2)]});return;}let _0x100f77=await commonDao[_0x2e147e(0x2b7)](_0x2e147e(0x22b),{'unionID':_0x2f7be2[_0x2e147e(0x1d4)]});if(!_0x100f77){_0xb50ec6(null,{'code':code['REQUEST_DATA_ERROR']});return;}let _0x1324dd=await userDao[_0x2e147e(0x1e9)](_0x4e5787[_0x5a9c33(0x215)]);if(!_0x1324dd){_0xb50ec6(null,{'code':code[_0x5a9c33(0x159)]});return;}let _0x26ccbf=await userDao[_0x5a9c33(0x23d)](_0x2f7be2[_0x2e147e(0x265)]);if(!_0x26ccbf){_0xb50ec6(null,{'code':code['PERMISSION_NOT_ENOUGH']});return;}let _0x29866e=_0x26ccbf[_0x2e147e(0x26e)][_0x2e147e(0x296)](function(_0x45a802){const _0x16a685=_0x2e147e;return _0x45a802[_0x16a685(0x1d4)]===_0x2f7be2['unionID'];});if(!_0x29866e){_0xb50ec6(null,{'code':code[_0x2e147e(0x262)]});return;}if(_0x100f77['ownerUid']!==_0x4e5787[_0x2e147e(0x18a)]&&!_0x29866e[_0x2e147e(0x20e)]&&!_0x29866e[_0x2e147e(0x199)]){_0xb50ec6(null,{'code':code[_0x2e147e(0x262)]});return;}let _0x3f1409=_0x2f7be2[_0x2e147e(0x1f7)]==0x1?!![]:![],_0x4d59cb=await userDao[_0x2e147e(0x294)]({'uid':_0x2f7be2[_0x2e147e(0x265)],'unionInfo.unionID':_0x2f7be2[_0x5a9c33(0x1be)]},{'unionInfo.$.showFixScore':_0x3f1409});if(!!_0x4d59cb[_0x2e147e(0x202)])userInfoServices[_0x2e147e(0x28c)](_0x4d59cb[_0x5a9c33(0x215)],_0x4d59cb['frontendId'],{'unionInfo':_0x4d59cb[_0x2e147e(0x26e)]})[_0x2e147e(0x260)](_0x629703=>{const _0x4f28d4=_0x2e147e;logger[_0x4f28d4(0x253)](_0x629703);});let _0x380412={'code':code['OK'],'isShow':_0x2f7be2[_0x5a9c33(0x196)]};_0xb50ec6(null,_0x380412);}catch(_0x6c7e0e){logger[_0x2e147e(0x253)](_0x2e147e(0x220)+_0x6c7e0e[_0x2e147e(0x1c6)]),_0xb50ec6(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x24a)]=async function(_0x4cdca1,_0x15f516,_0x556d89){const _0x2e4e1b=a0_0x1df908,_0x56a106=a0_0x5d04f4;try{if(!_0x15f516[_0x56a106(0x18a)]){_0x556d89(null,{'code':code[_0x56a106(0x1c8)]});return;}if(!_0x4cdca1[_0x56a106(0x1d4)]||!_0x4cdca1[_0x56a106(0x265)]){_0x556d89(null,{'code':code[_0x2e4e1b(0x159)]});return;}let _0xf0350a=await commonDao[_0x56a106(0x2b7)](_0x56a106(0x22b),{'unionID':_0x4cdca1[_0x56a106(0x1d4)]});if(!_0xf0350a){_0x556d89(null,{'code':code[_0x56a106(0x1b2)]});return;}let _0x5bd98d=await userDao[_0x56a106(0x1e9)](_0x15f516[_0x56a106(0x18a)]);if(!_0x5bd98d){_0x556d89(null,{'code':code[_0x56a106(0x1b2)]});return;}let _0x5d0807=await userDao[_0x2e4e1b(0x23d)](_0x4cdca1[_0x2e4e1b(0x139)]);if(!_0x5d0807){_0x556d89(null,{'code':code[_0x56a106(0x215)]});return;}let _0x18c91e=_0x5d0807[_0x56a106(0x26e)][_0x2e4e1b(0x1f3)](function(_0x148ba0){const _0x1ba938=_0x56a106;return _0x148ba0[_0x1ba938(0x1d4)]===_0x4cdca1[_0x1ba938(0x1d4)];});if(!_0x18c91e){_0x556d89(null,{'code':code['PERMISSION_NOT_ENOUGH']});return;}if(_0xf0350a[_0x56a106(0x22e)]!==_0x15f516[_0x2e4e1b(0x215)]&&!_0x18c91e[_0x2e4e1b(0x184)]&&!_0x18c91e[_0x56a106(0x199)]){_0x556d89(null,{'code':code[_0x56a106(0x262)]});return;}let _0x379e91=_0x4cdca1[_0x56a106(0x22c)]||0x0,_0x18c7e2=await userDao[_0x2e4e1b(0x24a)]({'uid':_0x4cdca1[_0x56a106(0x265)],'unionInfo.unionID':_0x4cdca1[_0x56a106(0x1d4)]},{'unionInfo.$.fixScoreRate':_0x379e91});if(!!_0x18c7e2[_0x56a106(0x202)])userInfoServices[_0x56a106(0x28c)](_0x18c7e2[_0x56a106(0x18a)],_0x18c7e2[_0x56a106(0x202)],{'unionInfo':_0x18c7e2[_0x2e4e1b(0x242)]})[_0x56a106(0x260)](_0x85b115=>{const _0x498b20=_0x56a106;logger[_0x498b20(0x253)](_0x85b115);});let _0x4142cb={'code':code['OK'],'fixScoreRate':_0x4cdca1[_0x2e4e1b(0x129)]};_0x556d89(null,_0x4142cb);}catch(_0x55c728){logger['error'](_0x56a106(0x1dc)+_0x55c728['stack']),_0x556d89(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x23c)]=async function(_0x337020,_0x55c9fa,_0x3c6917){const _0x4d6228=a0_0x1df908,_0x371eb2=a0_0x5d04f4;try{if(!_0x55c9fa[_0x371eb2(0x18a)]){_0x3c6917(null,{'code':code['INVALID_UERS']});return;}if(!_0x337020[_0x371eb2(0x1d4)]||!_0x337020[_0x371eb2(0x21b)]||_0x337020[_0x371eb2(0x21b)][_0x4d6228(0x130)]>0x28){_0x3c6917(null,{'code':code[_0x371eb2(0x1b2)]});return;}let _0x262064=await userDao[_0x371eb2(0x294)]({'uid':_0x55c9fa[_0x371eb2(0x18a)],'unionInfo.unionID':_0x337020[_0x371eb2(0x1d4)]},{'unionInfo.$.notice':_0x337020[_0x371eb2(0x21b)]});_0x3c6917(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x262064[_0x371eb2(0x26e)]}});}catch(_0xac9772){logger[_0x371eb2(0x253)](_0x371eb2(0x272)+_0xac9772[_0x371eb2(0x1c6)]),_0x3c6917(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x1b8)]=async function(_0x89ca5a,_0x36518c,_0x2533d6){const _0x35aa5c=a0_0x1df908,_0x26c726=a0_0x5d04f4;if(!userListPenging[_0x36518c[_0x26c726(0x18a)]])userListPenging[_0x36518c[_0x26c726(0x18a)]]=moment();else{if(moment()[_0x26c726(0x226)](userListPenging[_0x36518c[_0x26c726(0x18a)]],'s')<0x3){_0x2533d6(null,{'code':code[_0x35aa5c(0x227)]});return;}userListPenging[_0x36518c[_0x26c726(0x18a)]]=moment();}logger[_0x26c726(0x20d)](_0x26c726(0x17f)+getSimData(_0x89ca5a)+_0x26c726(0x193)+_0x36518c[_0x26c726(0x18a)]);try{if(!_0x36518c[_0x26c726(0x18a)]){_0x2533d6(null,{'code':code[_0x26c726(0x1c8)]});return;}_0x89ca5a['count']=parseInt(_0x89ca5a[_0x26c726(0x2aa)]);if(!_0x89ca5a[_0x26c726(0x1d4)]||typeof _0x89ca5a['count']!==_0x35aa5c(0x1b8)||_0x89ca5a[_0x35aa5c(0x1c0)]<=0x0||!_0x89ca5a[_0x26c726(0x22f)]||_0x36518c[_0x26c726(0x18a)]===_0x89ca5a[_0x26c726(0x22f)]){_0x2533d6(null,{'code':code[_0x26c726(0x1b2)]});return;}let _0x23a9a2=await commonDao[_0x26c726(0x2b7)](_0x26c726(0x22b),{'unionID':_0x89ca5a[_0x26c726(0x1d4)]});if(!_0x23a9a2){_0x2533d6(null,{'code':code[_0x26c726(0x1b2)]});return;}if(!!_0x23a9a2[_0x26c726(0x20c)]&&_0x36518c[_0x26c726(0x18a)]!==_0x23a9a2[_0x26c726(0x22e)]){_0x2533d6(null,{'code':code[_0x26c726(0x206)]});return;}let _0x412c20=await userDao[_0x35aa5c(0x267)](_0x36518c[_0x35aa5c(0x215)]);if(!_0x412c20||!!_0x412c20[_0x26c726(0x1bc)]){_0x2533d6(null,{'code':code[_0x26c726(0x1b2)]});return;}let _0xe96e2=_0x412c20[_0x26c726(0x26e)][_0x26c726(0x296)](function(_0x48cc5e){const _0x1a362b=_0x35aa5c,_0x4a68e0=_0x26c726;return _0x48cc5e[_0x4a68e0(0x1d4)]===_0x89ca5a[_0x1a362b(0x1be)];});if(!_0xe96e2||_0xe96e2[_0x26c726(0x1bd)]<_0x89ca5a[_0x35aa5c(0x1c0)]&&_0x36518c[_0x26c726(0x18a)]!==_0x23a9a2[_0x26c726(0x22e)]){await userDao[_0x26c726(0x18d)](_0x36518c[_0x26c726(0x18a)]),_0x2533d6(null,{'code':code[_0x26c726(0x1b2)]});return;}let _0x493ede=await userDao[_0x26c726(0x1e9)](_0x89ca5a[_0x26c726(0x22f)]);if(!_0x493ede){_0x2533d6(null,{'code':code[_0x26c726(0x1c8)]});return;}let _0x3a302e=_0x493ede[_0x35aa5c(0x242)][_0x26c726(0x296)](function(_0x45c92e){const _0x14cb4f=_0x35aa5c;return _0x45c92e[_0x14cb4f(0x1be)]===_0x89ca5a[_0x14cb4f(0x1be)];});if(!_0x3a302e){await userDao[_0x35aa5c(0x247)](_0x36518c[_0x26c726(0x18a)]),_0x2533d6(null,{'code':code[_0x35aa5c(0x251)]});return;}let _0x96977f=null;_0x96977f=await userDao['updateUserDataAndUnlock']({'uid':_0x36518c[_0x26c726(0x18a)],'unionInfo.unionID':_0x89ca5a[_0x26c726(0x1d4)]},{'$inc':{'unionInfo.$.score':-_0x89ca5a[_0x26c726(0x2aa)]}});let _0x1774da=await userDao[_0x26c726(0x294)]({'uid':_0x89ca5a[_0x26c726(0x22f)],'unionInfo.unionID':_0x89ca5a[_0x26c726(0x1d4)]},{'$inc':{'unionInfo.$.score':_0x89ca5a[_0x26c726(0x2aa)]}}),_0x5d4cee={'uid':_0x36518c[_0x26c726(0x18a)],'nickname':_0x96977f[_0x26c726(0x2b4)],'gainUid':_0x89ca5a[_0x35aa5c(0x145)],'gainNickname':_0x493ede[_0x35aa5c(0x1ed)],'gainAvatar':_0x493ede[_0x26c726(0x1e4)],'unionID':_0x89ca5a[_0x26c726(0x1d4)],'count':_0x89ca5a[_0x35aa5c(0x1c0)],'createTime':Date[_0x26c726(0x1dd)]()};commonDao[_0x26c726(0x214)](_0x26c726(0x197),_0x5d4cee)[_0x26c726(0x260)](_0x4e43e8=>{const _0x2b60ef=_0x35aa5c,_0x1c8c1f=_0x26c726;logger[_0x1c8c1f(0x253)](_0x4e43e8[_0x2b60ef(0x137)]);});if(!!_0x1774da[_0x26c726(0x202)])userInfoServices[_0x26c726(0x28c)](_0x1774da[_0x26c726(0x18a)],_0x1774da[_0x26c726(0x202)],{'unionInfo':_0x1774da[_0x26c726(0x26e)]})[_0x26c726(0x260)](_0x244309=>{const _0x18b09b=_0x26c726;logger[_0x18b09b(0x253)](_0x244309[_0x18b09b(0x1c6)]);});let _0x3b7de9=_0x96977f[_0x35aa5c(0x242)][_0x26c726(0x296)](function(_0x329c8b){const _0x4b53c5=_0x26c726;return _0x329c8b[_0x4b53c5(0x1d4)]===_0x89ca5a[_0x4b53c5(0x1d4)];}),_0x20135d=[];_0x20135d[_0x26c726(0x2af)]({'uid':_0x96977f[_0x35aa5c(0x215)],'nickname':_0x96977f[_0x26c726(0x2b4)],'unionID':_0x89ca5a[_0x26c726(0x1d4)],'changeCount':-_0x89ca5a[_0x35aa5c(0x1c0)],'leftCount':_0x3b7de9[_0x26c726(0x1bd)],'leftSafeBoxCount':_0x3b7de9[_0x26c726(0x27d)],'leftSaveBoxCount':_0x3b7de9[_0x26c726(0x25b)],'changeType':enumeration[_0x35aa5c(0x1ad)][_0x26c726(0x224)],'describe':_0x26c726(0x298)+_0x1774da[_0x26c726(0x18a)]+':'+_0x89ca5a[_0x26c726(0x2aa)],'createTime':Date[_0x35aa5c(0x128)]()});let _0x20b36a=_0x1774da[_0x26c726(0x26e)][_0x26c726(0x296)](function(_0x31feb6){const _0xc14990=_0x26c726;return _0x31feb6[_0xc14990(0x1d4)]===_0x89ca5a[_0xc14990(0x1d4)];});_0x20135d[_0x35aa5c(0x1f0)]({'uid':_0x1774da[_0x26c726(0x18a)],'nickname':_0x1774da[_0x26c726(0x2b4)],'unionID':_0x89ca5a[_0x26c726(0x1d4)],'changeCount':_0x89ca5a[_0x26c726(0x2aa)],'leftCount':_0x20b36a[_0x35aa5c(0x1f7)],'leftSafeBoxCount':_0x20b36a[_0x26c726(0x27d)],'leftSaveBoxCount':_0x20b36a[_0x26c726(0x25b)],'changeType':enumeration[_0x26c726(0x1b5)][_0x26c726(0x224)],'describe':_0x96977f[_0x26c726(0x18a)]+'赠送'+':'+_0x89ca5a[_0x35aa5c(0x1c0)],'createTime':Date[_0x26c726(0x1dd)]()}),await commonDao[_0x26c726(0x258)](_0x35aa5c(0x24e),_0x20135d),await commonDao[_0x26c726(0x258)](_0x26c726(0x1ea),_0x20135d)[_0x35aa5c(0x27d)](_0x6c896=>{const _0x34266a=_0x26c726;logger[_0x34266a(0x253)](_0x6c896[_0x34266a(0x1c6)]);}),_0x2533d6(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0x96977f[_0x26c726(0x26e)]}});}catch(_0x2ab9d8){logger[_0x35aa5c(0x123)]('[giveScore]'+_0x2ab9d8[_0x26c726(0x1c6)]),_0x2533d6(null,{'code':code['OK']});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x2a0)]=async function(_0x22494a,_0x12b555,_0x182938){const _0x2f36b0=a0_0x1df908,_0x2942d2=a0_0x5d04f4;try{if(!_0x12b555[_0x2942d2(0x18a)]){_0x182938(null,{'code':code[_0x2942d2(0x1c8)]});return;}if(!_0x22494a[_0x2942d2(0x1d4)]||!_0x22494a[_0x2942d2(0x22a)]){_0x182938(null,{'code':code[_0x2942d2(0x1b2)]});return;}let _0x299d63=await commonDao[_0x2f36b0(0x1c3)](_0x2942d2(0x197),_0x22494a[_0x2942d2(0x2ac)]||0x0,_0x22494a[_0x2942d2(0x2aa)]||0x14,{'createTime':-0x1},_0x22494a[_0x2942d2(0x22a)]),_0x5c924f=0x0;if(!!_0x22494a[_0x2f36b0(0x26c)]){let _0x54f0df={'_id':null,'totalGiveCount':{'$sum':_0x2f36b0(0x21e)}},_0x5e3fb3=[{'$match':{'uid':_0x12b555[_0x2942d2(0x18a)],'unionID':_0x22494a[_0x2942d2(0x1d4)]}},{'$group':_0x54f0df}],_0x1e9a4e=await commonDao[_0x2942d2(0x27b)](_0x2942d2(0x197),_0x5e3fb3);_0x1e9a4e[_0x2942d2(0x200)]>0x0&&(_0x5c924f=_0x1e9a4e[0x0][_0x2942d2(0x1ab)]);}let _0xdf7b4a=0x0;if(!!_0x22494a[_0x2942d2(0x169)]){let _0x33f300={'_id':null,'totalGiveCount':{'$sum':_0x2942d2(0x2ad)}},_0x1f1d2c=[{'$match':{'gainUid':_0x12b555[_0x2f36b0(0x215)],'unionID':_0x22494a[_0x2942d2(0x1d4)]}},{'$group':_0x33f300}],_0x3fc965=await commonDao[_0x2942d2(0x27b)](_0x2942d2(0x197),_0x1f1d2c);_0x3fc965[_0x2942d2(0x200)]>0x0&&(_0xdf7b4a=_0x3fc965[0x0][_0x2942d2(0x1ab)]);}let _0x404468={'recordArr':_0x299d63[_0x2942d2(0x1e7)],'totalCount':_0x299d63[_0x2942d2(0x24d)]};_0x22494a[_0x2942d2(0x169)]&&(_0x404468[_0x2942d2(0x1ab)]=_0x5c924f,_0x404468[_0x2942d2(0x29b)]=_0xdf7b4a),_0x182938(null,{'code':code['OK'],'msg':_0x404468});}catch(_0x4a451c){logger[_0x2942d2(0x253)]('[getGiveScoreRecord]'+_0x4a451c[_0x2f36b0(0x137)]),_0x182938(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x225)]=async function(_0xe73b8e,_0x4acd0f,_0x422bda){const _0x108a3b=a0_0x1df908,_0x41d8d8=a0_0x5d04f4;try{if(!_0x4acd0f['uid']){_0x422bda(null,{'code':code[_0x108a3b(0x1b1)]});return;}if(!_0xe73b8e[_0x41d8d8(0x22a)]){_0x422bda(null,{'code':code[_0x41d8d8(0x1b2)]});return;}let _0x2ea76d=await commonDao[_0x41d8d8(0x1d1)](_0x108a3b(0x236),_0xe73b8e[_0x41d8d8(0x2ac)]||0x0,_0xe73b8e[_0x108a3b(0x1c0)]||0x14,{'createTime':-0x1},_0xe73b8e[_0x108a3b(0x182)]);_0x422bda(null,{'code':code['OK'],'msg':{'recordArr':_0x2ea76d[_0x108a3b(0x263)],'totalCount':_0x2ea76d[_0x108a3b(0x187)]}});}catch(_0x5bd911){logger[_0x41d8d8(0x253)](_0x108a3b(0x276)+_0x5bd911[_0x41d8d8(0x1c6)]),_0x422bda(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x5d04f4(0x281)]=async function(_0xff47a5,_0x5a2896,_0x468f43){const _0x2cfcdf=a0_0x1df908,_0x1db6c5=a0_0x5d04f4;try{if(!_0x5a2896[_0x1db6c5(0x18a)]){_0x468f43(null,{'code':code[_0x1db6c5(0x1c8)]});return;}if(!_0xff47a5[_0x1db6c5(0x2c0)]){_0x468f43(null,{'code':code[_0x1db6c5(0x1b2)]});return;}let _0x42a349=await commonDao[_0x1db6c5(0x2b7)](_0x1db6c5(0x16d),{'index':_0xff47a5[_0x1db6c5(0x2c0)]});_0x468f43(null,{'code':code['OK'],'msg':_0x42a349});}catch(_0x546f2b){logger[_0x2cfcdf(0x123)](_0x1db6c5(0x1ad)+_0x546f2b[_0x1db6c5(0x1c6)]),_0x468f43(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x134)]=async function(_0x4e6b1f,_0x2d9d8e,_0x4b3cbd){const _0x281264=a0_0x1df908,_0x54a09c=a0_0x5d04f4;try{if(!_0x2d9d8e[_0x54a09c(0x18a)]){_0x4b3cbd(null,{'code':code[_0x54a09c(0x1c8)]});return;}if(!_0x4e6b1f[_0x54a09c(0x18a)]){_0x4b3cbd(null,{'code':code[_0x54a09c(0x1c8)]});return;}if(!_0x4e6b1f[_0x54a09c(0x22a)]){_0x4b3cbd(null,{'code':code[_0x54a09c(0x1b2)]});return;}let _0x51c5cf=_0x4e6b1f[_0x54a09c(0x18a)],_0x1b19fb=await commonDao[_0x281264(0x1c3)](_0x54a09c(0x16d),_0x4e6b1f[_0x54a09c(0x2ac)]||0x0,_0x4e6b1f[_0x54a09c(0x2aa)]||0x14,{'createTime':-0x1},_0x4e6b1f[_0x54a09c(0x22a)]),_0x3a59b7=await commonDao[_0x281264(0x1c3)](_0x54a09c(0x16d),0x0,0x0,{'createTime':-0x1},_0x4e6b1f[_0x54a09c(0x22a)]),_0x1260d9=0x0,_0xba4c26=0x0,_0x4251a1=0x0,_0xf4e0da=0x0,_0x547af2=_0x3a59b7[_0x54a09c(0x1e7)];for(let _0x369f3d=0x0;_0x369f3d<_0x547af2[_0x54a09c(0x200)];_0x369f3d++){let _0x4a0b0a=_0x547af2[_0x369f3d],_0x467e65=_0x4a0b0a[_0x54a09c(0x1c7)],_0x5249ab=null,_0x2b6b2a=0x0;for(let _0x25c7eb=0x0;_0x25c7eb<_0x467e65[_0x54a09c(0x200)];_0x25c7eb++){let _0x4caef0=_0x467e65[_0x25c7eb];_0x4caef0[_0x54a09c(0x1bd)]>_0x2b6b2a&&(_0x2b6b2a=_0x4caef0[_0x54a09c(0x1bd)],_0x5249ab=_0x4caef0[_0x54a09c(0x18a)]),_0x4caef0[_0x54a09c(0x18a)]==_0x51c5cf&&(_0x1260d9+=0x1,_0xf4e0da+=_0x4caef0[_0x281264(0x1f7)],_0x4caef0[_0x54a09c(0x1bd)]>0x0&&(_0xba4c26+=0x1));}_0x5249ab==_0x51c5cf&&(_0x4251a1+=0x1);}_0x4b3cbd(null,{'code':code['OK'],'msg':{'recordArr':_0x1b19fb[_0x54a09c(0x1e7)],'totalCount':_0x1b19fb[_0x54a09c(0x24d)],'totalDraw':_0x1260d9,'totalbigWinDraw':_0x4251a1,'totalWinDraw':_0xba4c26,'totalWin':_0xf4e0da}});}catch(_0x2bed73){logger[_0x281264(0x123)](_0x54a09c(0x1ee)+_0x2bed73[_0x281264(0x137)]),_0x4b3cbd(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x19a)]=async function(_0x21d4f2,_0x554f03,_0x22e58a){const _0x298a60=a0_0x5d04f4;try{if(!_0x554f03[_0x298a60(0x18a)]){_0x22e58a(null,{'code':code['INVALID_UERS']});return;}if(!_0x21d4f2[_0x298a60(0x27a)]){_0x22e58a(null,{'code':code[_0x298a60(0x1b2)]});return;}let _0x424fe3=await commonDao[_0x298a60(0x2b7)]('gameVideoRecordModel',{'videoRecordID':_0x21d4f2[_0x298a60(0x27a)]});_0x22e58a(null,{'code':code['OK'],'msg':{'gameVideoRecordData':_0x424fe3}});}catch(_0x431626){logger[_0x298a60(0x253)](_0x298a60(0x1ff)+_0x431626[_0x298a60(0x1c6)]),_0x22e58a(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x1f2)]=async function(_0x1797f7,_0xad4131,_0x4dea31){const _0x358c44=a0_0x1df908,_0x365b31=a0_0x5d04f4;try{if(!_0xad4131[_0x365b31(0x18a)]){_0x4dea31(null,{'code':code[_0x365b31(0x1c8)]});return;}if(!_0x1797f7[_0x365b31(0x1d4)]||!_0x1797f7['uid']){_0x4dea31(null,{'code':code[_0x365b31(0x1b2)]});return;}let _0x927674=await userDao[_0x358c44(0x23d)](_0xad4131[_0x365b31(0x18a)]),_0x2e2bfb=_0x927674[_0x365b31(0x26e)][_0x365b31(0x296)](function(_0x1033ef){const _0x14b5ef=_0x365b31;return _0x1033ef[_0x14b5ef(0x1d4)]===_0x1797f7[_0x14b5ef(0x1d4)];});if(!_0x2e2bfb){_0x4dea31(null,{'code':code[_0x365b31(0x262)]});return;}let _0x56ae87=_0x1797f7[_0x365b31(0x23a)]||![],_0x6f8868=await commonDao[_0x358c44(0x26a)]('unionModel',{'unionID':_0x1797f7['unionID']});if(!_0x6f8868||_0x6f8868[_0x365b31(0x22e)]!==_0xad4131[_0x365b31(0x18a)]&&!_0x2e2bfb[_0x365b31(0x199)]){_0x4dea31(null,{'code':code[_0x365b31(0x262)]});return;}let _0x267708=await userDao[_0x358c44(0x23d)](_0x1797f7[_0x365b31(0x18a)]);if(!_0x267708){_0x4dea31(null,{'code':code[_0x365b31(0x1b2)]});return;}if(_0x267708[_0x365b31(0x256)]===_0x56ae87){_0x4dea31(null,{'code':code['OK']});return;}let _0x2f680f=await userDao[_0x365b31(0x294)]({'uid':_0x1797f7[_0x358c44(0x215)],'unionInfo.unionID':_0x1797f7[_0x365b31(0x1d4)]},{'unionInfo.$.prohibitGame':_0x56ae87});if(!!_0x2f680f[_0x365b31(0x202)])userInfoServices[_0x365b31(0x28c)](_0x2f680f[_0x365b31(0x18a)],_0x2f680f[_0x365b31(0x202)],{'unionInfo':_0x2f680f[_0x365b31(0x26e)]})[_0x365b31(0x260)](_0x41122c=>{const _0x4345c0=_0x365b31;logger[_0x4345c0(0x253)](_0x41122c[_0x4345c0(0x1c6)]);});_0x4dea31(null,{'code':code['OK']});}catch(_0x4aefc6){logger[_0x358c44(0x123)](_0x365b31(0x240)+_0x4aefc6[_0x365b31(0x1c6)]),_0x4dea31(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x1b0)]=async function(_0x376449,_0x534c8e,_0x438e33){const _0x592709=a0_0x1df908,_0xf12ae1=a0_0x5d04f4;try{if(!_0x534c8e[_0xf12ae1(0x18a)]){_0x438e33(null,{'code':code[_0x592709(0x1b1)]});return;}if(!_0x376449[_0xf12ae1(0x1d4)]||!_0x376449[_0x592709(0x182)]||!_0x376449[_0x592709(0x1d9)]){_0x438e33(null,{'code':code[_0xf12ae1(0x1b2)]});return;}let _0x511d2c=await userDao[_0xf12ae1(0x1e9)](_0x534c8e[_0x592709(0x215)]),_0x3254a5=_0x511d2c[_0xf12ae1(0x26e)][_0xf12ae1(0x296)](function(_0xa2d099){const _0x34d3fd=_0xf12ae1;return _0xa2d099[_0x34d3fd(0x1d4)]===_0x376449[_0x34d3fd(0x1d4)];});if(!_0x3254a5){_0x438e33(null,{'code':code[_0x592709(0x159)]});return;}let _0x24dd94=await commonDao[_0xf12ae1(0x2b7)](_0xf12ae1(0x22b),{'unionID':_0x376449[_0x592709(0x1be)]});if(!_0x24dd94||_0x24dd94[_0xf12ae1(0x22e)]!==_0x534c8e[_0x592709(0x215)]&&!_0x3254a5[_0x592709(0x21a)]&&!_0x24dd94[_0xf12ae1(0x237)]){_0x438e33(null,{'code':code[_0xf12ae1(0x1b2)]});return;}let _0x53f2f4=[{'$unwind':'$unionInfo'},{'$match':_0x376449[_0xf12ae1(0x22a)]},{'$match':_0x376449[_0xf12ae1(0x22a)]},{'$sort':_0x376449[_0xf12ae1(0x2b1)]},{'$skip':_0x376449['startIndex']||0x0},{'$limit':_0x376449[_0x592709(0x1c0)]||0xa}],_0x524b93=await commonDao[_0xf12ae1(0x27b)](_0xf12ae1(0x1e8),_0x53f2f4),_0x4d6d6c=[];for(let _0x54b57d=0x0;_0x54b57d<_0x524b93[_0xf12ae1(0x200)];++_0x54b57d){let _0x5b2649=_0x524b93[_0x54b57d],_0xe37eff=_0x5b2649[_0xf12ae1(0x26e)];if(!_0xe37eff)continue;_0x4d6d6c['push']({'uid':_0x5b2649[_0xf12ae1(0x18a)],'nickname':_0x5b2649[_0x592709(0x1ed)],'avatar':_0x5b2649[_0xf12ae1(0x1e4)],'todayWin':_0xe37eff[_0xf12ae1(0x250)]||0x0,'todayDraw':_0xe37eff[_0x592709(0x22e)],'weekDraw':_0xe37eff[_0xf12ae1(0x1bb)]||0x0,'totalDraw':_0xe37eff['totalDraw']||0x0,'score':_0xe37eff[_0xf12ae1(0x1bd)]||0x0,'yesterdayWin':_0xe37eff[_0x592709(0x122)]||0x0});}_0x438e33(null,{'code':code['OK'],'msg':{'recordArr':_0x4d6d6c}});}catch(_0x5e3afd){logger['error'](_0xf12ae1(0x203)+_0x5e3afd[_0xf12ae1(0x1c6)]),_0x438e33(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x19e)]=async function(_0x5426b0,_0xe1e5ed,_0x239330){const _0x303223=a0_0x1df908,_0x362ddd=a0_0x5d04f4;try{if(!_0xe1e5ed[_0x362ddd(0x18a)]){_0x239330(null,{'code':code[_0x362ddd(0x1c8)]});return;}if(!_0x5426b0[_0x362ddd(0x1d4)]||!_0x5426b0[_0x362ddd(0x22a)]||!_0x5426b0[_0x362ddd(0x2b1)]){_0x239330(null,{'code':code[_0x362ddd(0x1b2)]});return;}let _0x11adee=await userDao[_0x362ddd(0x1e9)](_0xe1e5ed[_0x362ddd(0x18a)]),_0xc80e27=_0x11adee[_0x362ddd(0x26e)][_0x362ddd(0x296)](function(_0xfdf48f){const _0x15905c=a0_0x4a16,_0x1c252d=_0x362ddd;return _0xfdf48f[_0x1c252d(0x1d4)]===_0x5426b0[_0x15905c(0x1be)];});if(!_0xc80e27){_0x239330(null,{'code':code[_0x362ddd(0x1b2)]});return;}let _0x1b2c9c=await commonDao[_0x362ddd(0x2b7)](_0x362ddd(0x22b),{'unionID':_0x5426b0[_0x362ddd(0x1d4)]});if(!_0x1b2c9c||_0x1b2c9c[_0x303223(0x27b)]!==_0xe1e5ed[_0x362ddd(0x18a)]&&!_0xc80e27['manager']&&!_0x1b2c9c[_0x362ddd(0x1a4)]){_0x239330(null,{'code':code[_0x362ddd(0x1b2)]});return;}_0x5426b0[_0x362ddd(0x22a)][_0x362ddd(0x181)]={'$gte':utils[_0x362ddd(0x2a4)]()};let _0x465acc={'_id':_0x362ddd(0x2bd),'nickname':{'$first':_0x362ddd(0x2a3)},'avatar':{'$first':_0x362ddd(0x1e3)}};_0x5426b0[_0x362ddd(0x2b1)][_0x303223(0x1f7)]===0x1?_0x465acc[_0x362ddd(0x1bd)]={'$min':_0x362ddd(0x16e)}:_0x465acc[_0x362ddd(0x1bd)]={'$max':'$userList.score'};let _0x3c97c4=[{'$match':_0x5426b0[_0x303223(0x182)]},{'$unwind':_0x362ddd(0x2be)},{'$match':_0x5426b0[_0x362ddd(0x22a)]},{'$group':_0x465acc},{'$sort':_0x5426b0[_0x362ddd(0x2b1)]},{'$skip':_0x5426b0[_0x362ddd(0x2ac)]||0x0},{'$limit':_0x5426b0[_0x362ddd(0x2aa)]||0xa}],_0x8445ee=await commonDao[_0x362ddd(0x27b)](_0x362ddd(0x16d),_0x3c97c4),_0x311fee=[];for(let _0x378e6a=0x0;_0x378e6a<_0x8445ee[_0x362ddd(0x200)];++_0x378e6a){let _0x41d332=_0x8445ee[_0x378e6a];_0x41d332[_0x303223(0x215)]=_0x41d332[_0x362ddd(0x242)],_0x311fee[_0x303223(0x1f0)](_0x41d332);}_0x239330(null,{'code':code['OK'],'msg':{'recordArr':_0x311fee}});}catch(_0x5025f5){logger['error'](_0x362ddd(0x248)+_0x5025f5[_0x362ddd(0x1c6)]),_0x239330(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x17b)]=async function(_0x18d41f,_0x41f90f,_0x17916e){const _0x38b51f=a0_0x1df908,_0x4c8ccf=a0_0x5d04f4;try{if(!_0x41f90f[_0x4c8ccf(0x18a)]){_0x17916e(null,{'code':code[_0x38b51f(0x1b1)]});return;}if(!_0x18d41f[_0x4c8ccf(0x1d4)]||!_0x18d41f[_0x4c8ccf(0x172)]||!_0x18d41f[_0x4c8ccf(0x18a)]){_0x17916e(null,{'code':code[_0x4c8ccf(0x1b2)]});return;}commonDao[_0x4c8ccf(0x1c1)](_0x4c8ccf(0x1f4),{'uid':_0x18d41f[_0x4c8ccf(0x18a)],'unionID':_0x18d41f[_0x4c8ccf(0x1d4)]},{'uid':_0x18d41f[_0x4c8ccf(0x18a)],'unionID':_0x18d41f[_0x4c8ccf(0x1d4)],'list':_0x18d41f[_0x38b51f(0x1e2)]},{'upsert':!![]})['catch'](_0x12ffc2=>{const _0xea5377=_0x4c8ccf;logger[_0xea5377(0x253)](_0x12ffc2);}),_0x17916e(null,{'code':code['OK']});}catch(_0x2dd960){logger[_0x4c8ccf(0x253)](_0x38b51f(0x235)+_0x2dd960[_0x4c8ccf(0x1c6)]),_0x17916e(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x1ea)]=async function(_0x23ebca,_0x33e28a,_0x28dbfd){const _0x14501a=a0_0x1df908,_0x4898e8=a0_0x5d04f4;try{if(!_0x33e28a[_0x4898e8(0x18a)]){_0x28dbfd(null,{'code':code[_0x14501a(0x1b1)]});return;}if(!_0x23ebca['unionID']||!_0x23ebca[_0x14501a(0x215)]){_0x28dbfd(null,{'code':code[_0x14501a(0x159)]});return;}let _0x4854f6={'uid':_0x23ebca[_0x14501a(0x215)],'unionID':_0x23ebca[_0x4898e8(0x1d4)]},_0x42b904=await commonDao[_0x4898e8(0x2b7)](_0x14501a(0x132),_0x4854f6);_0x28dbfd(null,{'code':code['OK'],'msg':_0x42b904});}catch(_0x3de642){logger[_0x14501a(0x123)](_0x4898e8(0x24f)+_0x3de642[_0x4898e8(0x1c6)]),_0x28dbfd(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x269)]=async function(_0x10e754,_0x501dd3,_0x54d351){const _0x43096e=a0_0x1df908,_0x7de49a=a0_0x5d04f4;try{if(!_0x501dd3[_0x7de49a(0x18a)]){_0x54d351(null,{'code':code[_0x7de49a(0x1c8)]});return;}if(!_0x10e754[_0x7de49a(0x1d4)]){_0x54d351(null,{'code':code[_0x7de49a(0x1b2)]});return;}let _0x45d776={'unionID':_0x10e754[_0x7de49a(0x1d4)]},_0x21555a=await commonDao[_0x7de49a(0x1d1)](_0x7de49a(0x2ba),_0x10e754[_0x7de49a(0x2ac)]||0x0,_0x10e754[_0x7de49a(0x2aa)]||0x14,{'createTime':-0x1},_0x45d776);_0x54d351(null,{'code':code['OK'],'msg':_0x21555a});}catch(_0x32db27){logger[_0x7de49a(0x253)](_0x43096e(0x11a)+_0x32db27[_0x7de49a(0x1c6)]),_0x54d351(null,{'code':0x1f4});}},Handler[a0_0x1df908(0x228)][a0_0x5d04f4(0x247)]=async function(_0x9a562c,_0x32ddba,_0xa87f6b){const _0x42f9b9=a0_0x1df908,_0x326305=a0_0x5d04f4;logger[_0x326305(0x20d)](_0x42f9b9(0x272)+getSimData(_0x9a562c)+_0x326305(0x193)+_0x32ddba[_0x326305(0x18a)]);try{if(!_0x32ddba[_0x326305(0x18a)]){_0xa87f6b(null,{'code':code[_0x326305(0x1c8)]});return;}if(!_0x9a562c[_0x326305(0x1d4)]){_0xa87f6b(null,{'code':code[_0x326305(0x1b2)]});return;}let _0x41111c=await commonDao[_0x42f9b9(0x26a)](_0x326305(0x22b),{'unionID':_0x9a562c[_0x326305(0x1d4)]});if(!_0x41111c){let _0xe01c83=await userDao[_0x326305(0x26a)](_0x32ddba[_0x326305(0x18a)],{'$push':{'unionInfo':{'unionID':_0x9a562c['unionID']}}});_0xa87f6b(null,{'code':code['OK'],'updateUserData':{'unionInfo':_0xe01c83[_0x326305(0x26e)]}});return;}if(_0x41111c[_0x326305(0x22e)]===_0x9a562c[_0x326305(0x18a)]){_0xa87f6b(null,{'code':code[_0x326305(0x1b2)]});return;}let _0x1e3f51=await userDao['getUserData']({'uid':_0x9a562c[_0x326305(0x18a)],'unionInfo.unionID':_0x9a562c[_0x326305(0x1d4)]});if(!_0x1e3f51){_0xa87f6b(null,{'code':code['OK']});return;}if(!!_0x1e3f51[_0x326305(0x1bc)]){_0xa87f6b(null,{'code':code['USER_IN_ROOM_DATA_LOCKED']});return;}let _0x111afb=null;for(let _0x353ed8=0x0;_0x353ed8<_0x1e3f51[_0x42f9b9(0x242)][_0x326305(0x200)];++_0x353ed8){if(_0x1e3f51[_0x326305(0x26e)][_0x353ed8]['unionID']===_0x9a562c[_0x326305(0x1d4)]){_0x111afb=_0x1e3f51[_0x326305(0x26e)][_0x353ed8];break;}}if(!_0x111afb){_0xa87f6b(null,{'code':code['OK']});return;}let _0x472983=await userDao[_0x42f9b9(0x23d)](_0x32ddba[_0x326305(0x18a)]);if(!_0x472983){_0xa87f6b(null,{'code':code[_0x42f9b9(0x1b1)]});return;}let _0x369d31=_0x472983[_0x326305(0x26e)][_0x326305(0x296)](function(_0x2fdecc){const _0x10f654=_0x326305;return _0x2fdecc[_0x10f654(0x1d4)]===_0x9a562c[_0x10f654(0x1d4)];});if(!_0x369d31){_0xa87f6b(null,{'code':code[_0x326305(0x262)]});return;}logger[_0x42f9b9(0x20e)](_0x326305(0x28b)+_0x41111c[_0x326305(0x22e)]+_0x326305(0x1c5)+_0x111afb[_0x326305(0x1e6)]+_0x326305(0x18f)+_0x369d31[_0x42f9b9(0x184)]+_0x42f9b9(0x1f8)+_0x111afb[_0x326305(0x199)]+_0x326305(0x193)+_0x32ddba[_0x326305(0x18a)]);if(!_0x369d31[_0x42f9b9(0x184)]){_0xa87f6b(null,{'code':code[_0x326305(0x262)]});return;}if(_0x32ddba['uid']!=_0x111afb[_0x326305(0x1e6)]&&_0x32ddba[_0x326305(0x18a)]!=_0x41111c[_0x326305(0x22e)]){_0xa87f6b(null,{'code':code[_0x326305(0x262)]});return;}let _0x1232f5=parseFloat((_0x111afb[_0x326305(0x1bd)]+_0x111afb[_0x326305(0x27d)]+(_0x111afb[_0x326305(0x25b)]||0x0))[_0x326305(0x285)](0x2));if(_0x1232f5>0x1){_0xa87f6b(null,{'code':code[_0x326305(0x1b2)]});return;}if(_0x1232f5<0x0){logger[_0x326305(0x20d)](_0x326305(0x1a6)+_0x1232f5),_0xa87f6b(null,{'code':code[_0x42f9b9(0x159)]});return;}let _0x1fd394=await userDao[_0x326305(0x294)]({'uid':_0x41111c[_0x326305(0x22e)],'unionInfo.unionID':_0x9a562c[_0x326305(0x1d4)]},{'$inc':{'unionInfo.$.score':_0x1232f5}});if(!!_0x1fd394[_0x326305(0x202)])userInfoServices[_0x326305(0x28c)](_0x1fd394[_0x326305(0x18a)],_0x1fd394[_0x326305(0x202)],{'unionInfo':_0x1fd394[_0x326305(0x26e)]})[_0x326305(0x260)](_0x1b46e8=>{const _0x2408a3=_0x42f9b9,_0x5b301d=_0x326305;logger[_0x2408a3(0x123)](_0x1b46e8[_0x5b301d(0x1c6)]);});let _0x2a10bb=_0x1e3f51[_0x326305(0x18a)],_0x5f1d43=_0x1e3f51[_0x326305(0x1e4)],_0x397809=_0x1e3f51[_0x42f9b9(0x1ed)],_0x4f92f7=await userDao[_0x326305(0x1e9)](_0x32ddba['uid']),_0xf0370f=_0x4f92f7[_0x326305(0x18a)],_0x870ea6=_0x4f92f7[_0x326305(0x1e4)],_0x3b1fd9=_0x4f92f7[_0x326305(0x2b4)];await commonDao[_0x42f9b9(0x127)](_0x326305(0x2ba),{'type':0x1,'doneUid':_0x2a10bb,'doneAvatar':_0x5f1d43,'doneNickname':_0x397809,'uid':_0xf0370f,'avatar':_0x870ea6,'nickname':_0x3b1fd9,'score':_0x1232f5,'unionID':_0x9a562c[_0x326305(0x1d4)],'createTime':Date[_0x326305(0x1dd)]()});let _0x4289c1=await userDao[_0x326305(0x26a)](_0x9a562c[_0x326305(0x18a)],{'$pull':{'unionInfo':{'unionID':_0x9a562c[_0x42f9b9(0x1be)]}},'unionID':0x0,'isBind':![]});if(!!_0x4289c1[_0x326305(0x202)])userInfoServices[_0x326305(0x28c)](_0x4289c1[_0x326305(0x18a)],_0x4289c1[_0x326305(0x202)],{'unionInfo':_0x4289c1[_0x326305(0x26e)]})[_0x326305(0x260)](_0x3ee510=>{const _0x58b424=_0x42f9b9,_0x12162a=_0x326305;logger[_0x12162a(0x253)](_0x3ee510[_0x58b424(0x137)]);});await commonDao['updateAllData'](_0x326305(0x1e8),{'unionInfo':{'$elemMatch':{'spreaderID':_0x9a562c[_0x326305(0x18a)],'unionID':_0x9a562c[_0x326305(0x1d4)]}}},{'unionInfo.$.spreaderID':_0x111afb[_0x326305(0x1e6)]}),commonDao[_0x326305(0x1f9)](_0x326305(0x22b),{'unionID':_0x9a562c[_0x326305(0x1d4)]},{'$inc':{'curMember':-0x1}})[_0x326305(0x260)](_0x3f902e=>{const _0x18d958=_0x326305;logger[_0x18d958(0x253)](_0x3f902e[_0x18d958(0x1c6)]);}),_0xa87f6b(null,{'code':code['OK']}),logger[_0x326305(0x20d)](_0x326305(0x191));}catch(_0x46da83){logger[_0x42f9b9(0x123)](_0x326305(0x217)+_0x46da83[_0x326305(0x1c6)]),_0xa87f6b(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x261)]=async function(_0x1d0bc6,_0x3129a9,_0x296566){const _0x4cb1a8=a0_0x1df908,_0x311cdb=a0_0x5d04f4;logger[_0x4cb1a8(0x20e)](_0x4cb1a8(0x1fe)+getSimData(_0x1d0bc6)+_0x4cb1a8(0x1d4)+_0x3129a9[_0x4cb1a8(0x215)]);try{if(!_0x3129a9[_0x311cdb(0x18a)]){_0x296566(null,{'code':code[_0x311cdb(0x1c8)]});return;}if(!_0x1d0bc6[_0x311cdb(0x1d4)]||!_0x1d0bc6[_0x311cdb(0x265)]||!_0x1d0bc6[_0x311cdb(0x1a2)]){_0x296566(null,{'code':code[_0x311cdb(0x1c8)]});return;}let _0x3fe3c2=await commonDao[_0x311cdb(0x2b7)](_0x311cdb(0x22b),{'unionID':_0x1d0bc6[_0x311cdb(0x1d4)]});if(!_0x3fe3c2){_0x296566(null,{'code':code[_0x4cb1a8(0x198)]});return;}let _0x4094c1=await userDao[_0x311cdb(0x1e9)](_0x3129a9[_0x4cb1a8(0x215)]);if(!_0x4094c1){_0x296566(null,{'code':code['INVALID_UERS']});return;}let _0x39a5f0=await userDao[_0x311cdb(0x1e9)](_0x1d0bc6[_0x311cdb(0x1a2)]);if(!_0x39a5f0){_0x296566(null,{'code':code[_0x4cb1a8(0x1b1)]});return;}let _0x542bf3=_0x39a5f0[_0x311cdb(0x26e)][_0x311cdb(0x296)](function(_0xfd4701){const _0x469e03=_0x4cb1a8,_0x5290ed=_0x311cdb;return _0xfd4701[_0x5290ed(0x1d4)]===_0x1d0bc6[_0x469e03(0x1be)];});if(!_0x542bf3||!_0x542bf3[_0x311cdb(0x20e)]){_0x296566(null,{'code':code[_0x311cdb(0x262)]});return;}let _0xb9b00f=await userDao[_0x311cdb(0x1e9)](_0x1d0bc6[_0x311cdb(0x265)]);if(!_0xb9b00f){_0x296566(null,{'code':code[_0x4cb1a8(0x1b1)]});return;}let _0x27f0f5=_0xb9b00f[_0x4cb1a8(0x242)]['find'](function(_0x455d11){const _0x29aa7e=_0x311cdb;return _0x455d11[_0x29aa7e(0x1d4)]===_0x1d0bc6[_0x29aa7e(0x1d4)];});if(!_0x27f0f5){_0x296566(null,{'code':code[_0x311cdb(0x25a)]});return;}if(!_0x27f0f5[_0x4cb1a8(0x184)]){_0x296566(null,{'code':code[_0x311cdb(0x1c8)]});return;}let _0x27335c=await userInfoServices[_0x4cb1a8(0x21f)](_0xb9b00f[_0x311cdb(0x18a)],_0x1d0bc6[_0x311cdb(0x1d4)]);_0x27335c=_0x27335c[_0x4cb1a8(0x191)](_0x285a27=>_0x285a27!=_0x1d0bc6[_0x311cdb(0x265)]);if(_0x27335c[_0x311cdb(0x200)]>0x0){_0x296566(null,{'code':code[_0x311cdb(0x233)]});return;}let _0x33dfb1=await userDao[_0x311cdb(0x294)]({'uid':_0x1d0bc6[_0x311cdb(0x265)],'unionInfo.unionID':_0x1d0bc6[_0x311cdb(0x1d4)]},{'unionInfo.$.partner':_0x1d0bc6[_0x311cdb(0x26f)],'unionInfo.$.ticketRate':0x0,'unionInfo.$.rebateRate':0x0});if(!!_0x33dfb1[_0x4cb1a8(0x1d7)])userInfoServices[_0x311cdb(0x28c)](_0x33dfb1[_0x311cdb(0x18a)],_0x33dfb1[_0x311cdb(0x202)],{'unionInfo':_0x33dfb1[_0x311cdb(0x26e)]})[_0x4cb1a8(0x27d)](_0x112369=>{const _0x4f0d1f=_0x311cdb;logger[_0x4f0d1f(0x253)](_0x112369[_0x4f0d1f(0x1c6)]);});_0x296566(null,{'code':code['OK']}),logger[_0x311cdb(0x20d)](_0x311cdb(0x190));}catch(_0x57d6cc){logger[_0x311cdb(0x253)](_0x311cdb(0x291)+_0x57d6cc[_0x4cb1a8(0x137)]),_0x296566(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x2bc)]=async function(_0x282d13,_0xc9c852,_0x3a99a3){const _0x499972=a0_0x1df908,_0x181e26=a0_0x5d04f4;try{if(!_0xc9c852[_0x181e26(0x18a)]){_0x3a99a3(null,{'code':code[_0x181e26(0x1c8)]});return;}if(!_0x282d13[_0x499972(0x1be)]){_0x3a99a3(null,{'code':code[_0x181e26(0x262)]});return;}let _0x2e8fa0=await userDao[_0x181e26(0x1e9)](_0xc9c852[_0x181e26(0x18a)]);if(!_0x2e8fa0){_0x3a99a3(null,{'code':code[_0x181e26(0x1c8)]});return;}let _0x3557eb=await commonDao[_0x181e26(0x2b7)](_0x181e26(0x22b),{'unionID':_0x282d13[_0x181e26(0x1d4)]});if(!_0x3557eb){_0x3a99a3(null,{'code':code[_0x181e26(0x290)]});return;}let _0x5d7207=_0x2e8fa0['unionInfo'][_0x181e26(0x296)](function(_0x2332b2){const _0x60c638=_0x181e26;return _0x2332b2[_0x60c638(0x1d4)]===_0x282d13[_0x60c638(0x1d4)];});if(!_0x5d7207){_0x3a99a3(null,{'code':code[_0x181e26(0x262)]});return;}if(_0x3557eb[_0x181e26(0x22e)]!=_0xc9c852[_0x181e26(0x18a)]&&!_0x5d7207[_0x499972(0x184)]&&!_0x5d7207[_0x181e26(0x199)]){_0x3a99a3(null,{'code':code[_0x181e26(0x262)]});return;}let _0x5ddaf8=_0xc9c852[_0x181e26(0x18a)];_0x5d7207[_0x499972(0x21a)]&&(_0x5ddaf8=_0x3557eb[_0x181e26(0x22e)]),parterQuery={'unionInfo':{'$elemMatch':{'unionID':_0x282d13[_0x181e26(0x1d4)],'spreaderID':_0x5ddaf8,'partner':!![]}}};let _0x182ecb=await commonDao[_0x181e26(0x1d1)]('userModel',_0x282d13[_0x181e26(0x2ac)]||0x0,_0x282d13[_0x499972(0x1c0)]||0x14,{'unionInfo.fixScoreRate':-0x1},parterQuery),_0x5e7a0f=_0x182ecb[_0x499972(0x187)],_0x3e2b7c=[];for(let _0x3f309a=0x0;_0x3f309a<_0x182ecb[_0x181e26(0x1e7)][_0x181e26(0x200)];_0x3f309a++){let _0x3b0974=_0x182ecb[_0x181e26(0x1e7)][_0x3f309a],_0x585427=_0x3b0974[_0x181e26(0x26e)][_0x181e26(0x296)](function(_0x251953){const _0x46e6a7=_0x499972,_0xd22823=_0x181e26;return _0x251953[_0x46e6a7(0x1be)]===_0x282d13[_0xd22823(0x1d4)];}),_0x7ebcf=_0x585427[_0x181e26(0x2a6)]||![],_0x5c06d9=_0x585427[_0x181e26(0x22c)]||0x0;_0x3e2b7c[_0x181e26(0x2af)]({'uid':_0x3b0974[_0x181e26(0x18a)],'nickname':utils[_0x181e26(0x1fc)](_0x3b0974[_0x181e26(0x2b4)]),'avatar':_0x3b0974[_0x181e26(0x1e4)],'showFixScore':_0x7ebcf,'fixScoreRate':_0x5c06d9});}let _0x84d945={'recordCount':_0x5e7a0f,'recordArr':_0x3e2b7c};_0x3a99a3(null,{'code':code['OK'],'msg':_0x84d945});}catch(_0x4314fa){logger[_0x499972(0x123)]('[getTeamFixScore]'+_0x4314fa[_0x181e26(0x1c6)]),_0x3a99a3(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x1ca)]=async function(_0xd3d751,_0x270af2,_0x51845f){const _0x2dd90d=a0_0x1df908,_0x356a33=a0_0x5d04f4;try{if(!_0x270af2[_0x356a33(0x18a)]){_0x51845f(null,{'code':code[_0x356a33(0x1c8)]});return;}if(!_0xd3d751[_0x356a33(0x1d4)]||!_0xd3d751[_0x356a33(0x265)]){_0x51845f(null,{'code':code[_0x356a33(0x1b2)]});return;}if(_0x270af2[_0x356a33(0x18a)]==_0xd3d751[_0x356a33(0x265)]){_0x51845f(null,{'code':code[_0x356a33(0x262)]});return;}let _0x21d35c=await commonDao[_0x2dd90d(0x26a)](_0x356a33(0x22b),{'unionID':_0xd3d751[_0x356a33(0x1d4)]});if(!_0x21d35c){_0x51845f(null,{'code':code[_0x356a33(0x1b2)]});return;}let _0x4fac52=await userDao[_0x356a33(0x1e9)](_0x270af2[_0x356a33(0x18a)]);if(!_0x4fac52){_0x51845f(null,{'code':code[_0x356a33(0x1b2)]});return;}let _0x540f83=_0x4fac52[_0x356a33(0x26e)][_0x356a33(0x296)](function(_0x4ca9e8){const _0x2e410e=_0x356a33;return _0x4ca9e8[_0x2e410e(0x1d4)]===_0xd3d751[_0x2e410e(0x1d4)];});if(!_0x540f83){_0x51845f(null,{'code':code[_0x356a33(0x1b2)]});return;}let _0x1e2dff=await userDao['getUserDataByUid'](_0xd3d751[_0x356a33(0x265)]);if(!_0x1e2dff){_0x51845f(null,{'code':code['NOT_IN_UNION']});return;}let _0x1e2f8e=_0x1e2dff[_0x356a33(0x26e)][_0x356a33(0x296)](function(_0x37973b){const _0x62552a=_0x356a33;return _0x37973b[_0x62552a(0x1d4)]===_0xd3d751[_0x62552a(0x1d4)];});if(_0x21d35c[_0x356a33(0x22e)]!==_0x270af2[_0x356a33(0x18a)]&&!_0x1e2f8e[_0x356a33(0x199)]){_0x51845f(null,{'code':code[_0x2dd90d(0x22b)]});return;}let _0x297af9=await userDao[_0x2dd90d(0x24a)]({'uid':_0xd3d751[_0x356a33(0x265)],'unionInfo.unionID':_0xd3d751[_0x356a33(0x1d4)]},{'unionInfo.$.targetScore':_0xd3d751[_0x356a33(0x2b6)],'unionInfo.$.floatScore':_0xd3d751[_0x356a33(0x2ae)]});if(!!_0x297af9[_0x356a33(0x202)])userInfoServices[_0x356a33(0x28c)](_0x297af9[_0x356a33(0x18a)],_0x297af9[_0x356a33(0x202)],{'unionInfo':_0x297af9[_0x356a33(0x26e)]})[_0x356a33(0x260)](_0x1d6d62=>{const _0x1615b2=_0x356a33;logger['error'](_0x1d6d62[_0x1615b2(0x1c6)]);});_0x51845f(null,{'code':code['OK']});}catch(_0x160bbf){logger[_0x356a33(0x253)](_0x356a33(0x26d)+_0x160bbf[_0x356a33(0x1c6)]),_0x51845f(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x1df908(0x183)]=async function(_0x2595f0,_0x1b06a5,_0x3a5632){const _0xd4ffe1=a0_0x5d04f4;try{if(!_0x1b06a5[_0xd4ffe1(0x18a)]){_0x3a5632(null,{'code':code[_0xd4ffe1(0x1c8)]});return;}if(!_0x2595f0[_0xd4ffe1(0x1d4)]){_0x3a5632(null,{'code':code[_0xd4ffe1(0x1b2)]});return;}let _0x506de3={'unionID':_0x2595f0[_0xd4ffe1(0x1d4)]},_0xb5e82d=await commonDao[_0xd4ffe1(0x1d1)](_0xd4ffe1(0x1cf),_0x2595f0[_0xd4ffe1(0x2ac)]||0x0,_0x2595f0[_0xd4ffe1(0x2aa)]||0x14,{'createTime':-0x1},_0x506de3);_0x3a5632(null,{'code':code['OK'],'msg':_0xb5e82d});}catch(_0x1cb0e1){logger[_0xd4ffe1(0x253)](_0xd4ffe1(0x288)+_0x1cb0e1[_0xd4ffe1(0x1c6)]),_0x3a5632(null,{'code':0x1f4});}},Handler[a0_0x5d04f4(0x18b)][a0_0x5d04f4(0x295)]=async function(_0x58ee7a,_0x3424db,_0x4b0089){const _0x3be476=a0_0x1df908,_0x1253e0=a0_0x5d04f4;try{if(!_0x3424db[_0x1253e0(0x18a)]){_0x4b0089(null,{'code':code[_0x1253e0(0x1c8)]});return;}if(!_0x58ee7a[_0x1253e0(0x1d4)]||!_0x58ee7a[_0x1253e0(0x265)]){_0x4b0089(null,{'code':code[_0x1253e0(0x262)]});return;}let _0x1c8cf0=await userDao[_0x1253e0(0x1e9)](_0x3424db[_0x3be476(0x215)]);if(!_0x1c8cf0){_0x4b0089(null,{'code':code[_0x1253e0(0x1c8)]});return;}let _0x1e0f18=await commonDao[_0x1253e0(0x2b7)](_0x1253e0(0x22b),{'unionID':_0x58ee7a[_0x1253e0(0x1d4)]});if(!_0x1e0f18){_0x4b0089(null,{'code':code[_0x1253e0(0x1b2)]});return;}let _0xddbd95=[],_0x3d215a=_0x58ee7a[_0x1253e0(0x265)],_0x79fc9d=await userDao['getUserDataByUid'](_0x3d215a);if(!_0x79fc9d){_0x4b0089(null,{'code':code[_0x1253e0(0x1c8)]});return;}let _0xd6c045=0x0;do{_0xd6c045++;let _0x4c62f7=await userDao[_0x1253e0(0x1e9)](_0x3d215a);if(!_0x4c62f7)break;let _0x563baf=_0x4c62f7[_0x1253e0(0x26e)][_0x1253e0(0x296)](function(_0x108b15){const _0x412de8=_0x1253e0;return _0x108b15[_0x412de8(0x1d4)]===_0x58ee7a[_0x412de8(0x1d4)];});if(!_0x563baf){_0x4b0089(null,{'code':code[_0x1253e0(0x262)]});return;}else _0xddbd95[_0x1253e0(0x2af)]({'nickname':_0x4c62f7[_0x1253e0(0x2b4)],'avatar':_0x4c62f7[_0x1253e0(0x1e4)],'score':_0x563baf[_0x1253e0(0x1bd)],'partner':_0x563baf[_0x1253e0(0x20e)],'manager':_0x563baf[_0x1253e0(0x199)],'spreaderID':_0x563baf[_0x1253e0(0x1e6)],'ownerUid':_0x1e0f18[_0x3be476(0x27b)],'uid':_0x4c62f7[_0x3be476(0x215)]}),_0x3d215a=_0x563baf[_0x1253e0(0x1e6)];}while(_0xd6c045<0x2);let _0x468b2a=[];while(_0xddbd95[_0x1253e0(0x200)]>0x0){_0x468b2a[_0x1253e0(0x2af)](_0xddbd95[_0x1253e0(0x211)]());}_0x4b0089(null,{'code':code['OK'],'msg':{'spreadsList':_0x468b2a}});}catch(_0x1a689f){logger[_0x1253e0(0x253)](_0x3be476(0x17f)+_0x1a689f[_0x1253e0(0x1c6)]),_0x4b0089(null,{'code':0x1f4});}};