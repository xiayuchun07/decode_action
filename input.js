const a0_0x4db625=a0_0x1521;function a0_0x1521(_0x215846,_0x34d3a4){const _0x4db1ae=a0_0x4db1();return a0_0x1521=function(_0x15215e,_0x5750de){_0x15215e=_0x15215e-0x191;let _0x2a207e=_0x4db1ae[_0x15215e];return _0x2a207e;},a0_0x1521(_0x215846,_0x34d3a4);}(function(_0x27aa5a,_0x2a7403){const _0x5e79=a0_0x1521,_0x112490=_0x27aa5a();while(!![]){try{const _0x3a91b5=parseInt(_0x5e79(0x1fe))/0x1+parseInt(_0x5e79(0x1ae))/0x2*(-parseInt(_0x5e79(0x201))/0x3)+-parseInt(_0x5e79(0x1ce))/0x4*(-parseInt(_0x5e79(0x1b4))/0x5)+-parseInt(_0x5e79(0x1bd))/0x6*(-parseInt(_0x5e79(0x1fa))/0x7)+-parseInt(_0x5e79(0x1c7))/0x8+-parseInt(_0x5e79(0x1e2))/0x9+-parseInt(_0x5e79(0x1db))/0xa*(-parseInt(_0x5e79(0x1cd))/0xb);if(_0x3a91b5===_0x2a7403)break;else _0x112490['push'](_0x112490['shift']());}catch(_0x595346){_0x112490['push'](_0x112490['shift']());}}}(a0_0x4db1,0x22a0a));const a0_0xc7957a=a0_0x4b8d;function a0_0x3425(){const _0x3faf9d=a0_0x1521,_0x3f9042=[_0x3faf9d(0x1d1),_0x3faf9d(0x1eb),'rebateTicket',_0x3faf9d(0x1ef),_0x3faf9d(0x1e3),_0x3faf9d(0x1e5),_0x3faf9d(0x1c0),_0x3faf9d(0x1e9),_0x3faf9d(0x19b),_0x3faf9d(0x1b0),_0x3faf9d(0x1ee),_0x3faf9d(0x1b2),_0x3faf9d(0x1b1),_0x3faf9d(0x1a6),_0x3faf9d(0x1c2),'execRebate',_0x3faf9d(0x1f0),_0x3faf9d(0x1c5),'scoreChangeType',_0x3faf9d(0x1d8),_0x3faf9d(0x1ab),'752KadXDm',_0x3faf9d(0x1e0),_0x3faf9d(0x1df),'unionInfo.$.todayBigWinDraw',_0x3faf9d(0x20a),_0x3faf9d(0x200),'11930EdEewl',_0x3faf9d(0x208),_0x3faf9d(0x1e4),']\x20保底返利获取失败\x20unionID\x20=\x20',']\x20门票返利获取失败\x20unionID\x20=\x20',_0x3faf9d(0x1f3),'frontendId','\x20avgScore\x20=\x20',_0x3faf9d(0x1ca),_0x3faf9d(0x214),_0x3faf9d(0x195),'floor',_0x3faf9d(0x216),_0x3faf9d(0x19a),'../util/utils','find',']\x20保底返利明细\x20rebateRateList\x20=\x20',_0x3faf9d(0x1c3),_0x3faf9d(0x202),_0x3faf9d(0x211),_0x3faf9d(0x1f8),_0x3faf9d(0x213),'fixScoreRate',_0x3faf9d(0x20e),_0x3faf9d(0x1b8),_0x3faf9d(0x1ad),_0x3faf9d(0x207),_0x3faf9d(0x1ff),_0x3faf9d(0x1f6),_0x3faf9d(0x1d3),'抽取服务费',_0x3faf9d(0x1d0),_0x3faf9d(0x1a8),_0x3faf9d(0x1ea),_0x3faf9d(0x1b6),_0x3faf9d(0x19c),_0x3faf9d(0x1a5),_0x3faf9d(0x1f7),_0x3faf9d(0x215),_0x3faf9d(0x1fd),_0x3faf9d(0x1b3),_0x3faf9d(0x20f),'3978020OsKsku','updateUserData','unionInfo.$.score',_0x3faf9d(0x1ec),'赢家抽分','stack',_0x3faf9d(0x1bc),'bigWinCount',_0x3faf9d(0x1d6),_0x3faf9d(0x192),_0x3faf9d(0x1fb),_0x3faf9d(0x203),_0x3faf9d(0x1a0),']\x20double\x20rebate\x20detail\x20serverScore\x20=\x20',_0x3faf9d(0x1f9),_0x3faf9d(0x1da),'getRebateList',_0x3faf9d(0x1a4),_0x3faf9d(0x1e1),_0x3faf9d(0x1ac),_0x3faf9d(0x1d7),_0x3faf9d(0x1dc),']\x20只有盟主收取门票\x20',_0x3faf9d(0x212),']\x20获取门票返利\x20unionID\x20=\x20',_0x3faf9d(0x1cf),_0x3faf9d(0x1dd),_0x3faf9d(0x1c8),_0x3faf9d(0x1d4),_0x3faf9d(0x1e8),_0x3faf9d(0x1af),_0x3faf9d(0x1b5),'unionManager',_0x3faf9d(0x20d),_0x3faf9d(0x204),_0x3faf9d(0x1cc),_0x3faf9d(0x1fc),_0x3faf9d(0x1f5),_0x3faf9d(0x194),_0x3faf9d(0x197),_0x3faf9d(0x206),'\x20userSpreadList\x20=\x20',_0x3faf9d(0x19f),_0x3faf9d(0x193),_0x3faf9d(0x1d5),_0x3faf9d(0x1a2),'execFixRebate','游戏抽水',_0x3faf9d(0x205),_0x3faf9d(0x1c4),_0x3faf9d(0x1a9),_0x3faf9d(0x1c6),'\x20rebateList\x20=\x20',_0x3faf9d(0x1ba),_0x3faf9d(0x1d2),_0x3faf9d(0x198),_0x3faf9d(0x20b),_0x3faf9d(0x1de),'abs',_0x3faf9d(0x1ed),_0x3faf9d(0x19e),_0x3faf9d(0x1d9),'spreaderID','fixScoreType',_0x3faf9d(0x210),'indexOf'];return a0_0x3425=function(){return _0x3f9042;},a0_0x3425();}(function(_0x291001,_0x528eeb){const _0x8cc63c=a0_0x1521,_0x2a6790=a0_0x4b8d,_0x1f41f8=_0x291001();while(!![]){try{const _0x23db3d=parseInt(_0x2a6790(0x1bb))/0x1*(parseInt(_0x2a6790(0x1e0))/0x2)+parseInt(_0x2a6790(0x1c9))/0x3+-parseInt(_0x2a6790(0x1a8))/0x4*(-parseInt(_0x2a6790(0x1ae))/0x5)+-parseInt(_0x2a6790(0x1d7))/0x6*(-parseInt(_0x2a6790(0x1cf))/0x7)+parseInt(_0x2a6790(0x215))/0x8+parseInt(_0x2a6790(0x1ce))/0x9*(-parseInt(_0x2a6790(0x1d8))/0xa)+-parseInt(_0x2a6790(0x1fd))/0xb;if(_0x23db3d===_0x528eeb)break;else _0x1f41f8['push'](_0x1f41f8[_0x8cc63c(0x1e6)]());}catch(_0x418535){_0x1f41f8[_0x8cc63c(0x207)](_0x1f41f8[_0x8cc63c(0x1e6)]());}}}(a0_0x3425,0x37121));let utils=require(a0_0xc7957a(0x1bc)),moment=require(a0_0xc7957a(0x1f7)),code=require(a0_0xc7957a(0x20b)),userDao=require(a0_0x4db625(0x199)),dao=require('../dao/commonDao'),logger=require(a0_0x4db625(0x1cb))['getLogger'](a0_0xc7957a(0x1ba)),userInfoServices=require(a0_0xc7957a(0x22a)),pomelo=require(a0_0xc7957a(0x20a));function a0_0x4b8d(_0x5b641b,_0x41c518){const _0x48c5d8=a0_0x3425();return a0_0x4b8d=function(_0x218e33,_0x224b0b){_0x218e33=_0x218e33-0x1a8;let _0x1db977=_0x48c5d8[_0x218e33];return _0x1db977;},a0_0x4b8d(_0x5b641b,_0x41c518);}const enumeration=require(a0_0xc7957a(0x21f));let services=module[a0_0x4db625(0x196)];services[a0_0xc7957a(0x229)]=async function(_0x44e5e3,_0x3626c1,_0x46f6ae,_0x251844,_0x2eb42a,_0x192ef4,_0x41bb7a,_0x5907d1,_0x25400c,_0x228d2e){const _0x5342ba=a0_0x4db625,_0x878d5f=a0_0xc7957a;if(_0x5907d1<=0x0)return;logger[_0x5342ba(0x202)]('['+_0x44e5e3+']['+_0x3626c1+']\x20rabate\x20unionID\x20=\x20'+_0x44e5e3+_0x878d5f(0x1cb)+_0x3626c1+_0x878d5f(0x1ea)+_0x251844[_0x878d5f(0x1de)]+_0x878d5f(0x1d2)+_0x5907d1+'\x20');let _0x45ee4e=await userInfoServices[_0x878d5f(0x20e)](_0x251844['uid'],_0x44e5e3);_0x45ee4e[_0x878d5f(0x1b8)]((_0xae0c61,_0x277134)=>_0x277134[_0x5342ba(0x1ba)]-_0xae0c61[_0x878d5f(0x20d)]);let _0x3c1dfd=[],_0x18f7e5=_0x5907d1;if(_0x45ee4e[_0x878d5f(0x1bf)]>0x0)for(let _0x212e2e=0x0;_0x212e2e<_0x45ee4e[_0x878d5f(0x1bf)];_0x212e2e++){let _0x413b28=_0x45ee4e[_0x212e2e];if(!_0x413b28)continue;let _0x1afdd3=_0x45ee4e[_0x878d5f(0x1bd)](_0x46124b=>_0x46124b[_0x878d5f(0x216)]&&_0x46124b['spreaderID'][_0x5342ba(0x197)]()==_0x413b28[_0x878d5f(0x22e)][_0x878d5f(0x1ff)]());if(_0x1afdd3){let _0x3402b5=_0x1afdd3[_0x878d5f(0x213)];if(_0x18f7e5<0.1||_0x3402b5<=0x0){let _0x5f9b29={'uid':_0x413b28[_0x5342ba(0x1ab)],'count':_0x18f7e5,'lowUid':_0x1afdd3[_0x878d5f(0x22e)]};_0x3c1dfd[_0x878d5f(0x1c8)](_0x5f9b29);break;}else{let _0x5aa403=Math[_0x878d5f(0x1b9)](_0x18f7e5*(0x1-_0x3402b5)*0x64)/0x64,_0x85293d={'uid':_0x413b28[_0x878d5f(0x22e)],'count':_0x5aa403,'lowUid':_0x1afdd3[_0x878d5f(0x22e)]};_0x3c1dfd[_0x5342ba(0x207)](_0x85293d),_0x18f7e5=Math[_0x5342ba(0x1bb)]((_0x18f7e5-_0x5aa403)*0x64)/0x64;}}else{let _0xd2c572={'uid':_0x413b28[_0x878d5f(0x22e)],'count':_0x18f7e5,'lowUid':_0x413b28[_0x878d5f(0x22e)]};_0x3c1dfd[_0x878d5f(0x1c8)](_0xd2c572);break;}}else logger[_0x878d5f(0x226)]('['+_0x44e5e3+']['+_0x3626c1+_0x878d5f(0x1b3)+_0x44e5e3+_0x878d5f(0x1cb)+_0x3626c1+_0x5342ba(0x1e1)+_0x251844[_0x878d5f(0x1de)]+_0x5342ba(0x1c1)+JSON[_0x878d5f(0x1e2)](_0x45ee4e)+'\x20');logger[_0x878d5f(0x1c0)]('['+_0x44e5e3+']['+_0x3626c1+_0x878d5f(0x223)+JSON[_0x878d5f(0x1e2)](_0x3c1dfd)+'\x20');for(let _0x466931=0x0;_0x466931<_0x3c1dfd[_0x5342ba(0x1c3)];_0x466931++){let _0xca5d29=_0x3c1dfd[_0x466931],_0x446e83=_0xca5d29[_0x878d5f(0x20d)]||0x0,_0x19baa7={'$inc':{'unionInfo.$.safeScore':_0x446e83,'unionInfo.$.todayRebate':_0x446e83,'unionInfo.$.totalRebate':_0x446e83}};!_0x228d2e&&(_0x19baa7[_0x878d5f(0x1f2)][_0x5342ba(0x1e7)]=0x1,_0x25400c&&(_0x19baa7[_0x5342ba(0x1dd)][_0x5342ba(0x1f2)]=0x1));let _0x32ff23=await userDao[_0x878d5f(0x1d9)]({'uid':_0xca5d29[_0x5342ba(0x1bc)],'unionInfo.unionID':_0x44e5e3},_0x19baa7);!!_0x32ff23[_0x5342ba(0x1bf)]&&await userInfoServices[_0x878d5f(0x209)](_0x32ff23[_0x878d5f(0x1de)],_0x32ff23[_0x878d5f(0x1b4)],{'unionInfo':_0x32ff23[_0x878d5f(0x221)]})[_0x878d5f(0x1ad)](_0x3d61d9=>{}),!!_0xca5d29['lowUid']&&await userDao[_0x5342ba(0x1a7)]({'uid':_0xca5d29[_0x5342ba(0x213)],'unionInfo.unionID':_0x44e5e3},{'$inc':{'unionInfo.$.todayProvideRebate':_0x446e83}});let _0x164103={'uid':_0x32ff23[_0x5342ba(0x1bc)],'nickname':_0x32ff23[_0x878d5f(0x21d)],'avatar':_0x32ff23[_0x878d5f(0x1c7)],'roomID':_0x3626c1,'gameType':_0x46f6ae,'unionID':_0x44e5e3,'playerUid':_0x251844[_0x878d5f(0x1de)],'playerNickname':_0x251844[_0x878d5f(0x21d)],'playerAvatar':_0x251844[_0x878d5f(0x1c7)],'totalCount':_0x5907d1,'gainCount':_0x446e83,'start':![],'createTime':Date[_0x5342ba(0x1f9)]()};await dao[_0x878d5f(0x224)](_0x878d5f(0x1e7),_0x164103)[_0x5342ba(0x200)](_0x15a080=>{const _0x555cad=_0x878d5f;logger[_0x555cad(0x226)](_0x15a080[_0x555cad(0x1dd)]);});}},services[a0_0xc7957a(0x1e8)]=function(_0xab1dc,_0x8c2742,_0x1867fc){const _0x45c274=a0_0x4db625,_0x4b6ff8=a0_0xc7957a;_0x8c2742=utils[_0x4b6ff8(0x1f3)](_0x8c2742);let _0x1fc988=_0xab1dc[_0x4b6ff8(0x204)],_0x5d4a07=parseFloat(_0xab1dc[_0x4b6ff8(0x22b)])||0x0,_0x16bc1d=services[_0x4b6ff8(0x22d)](_0xab1dc,_0x8c2742),_0x46b4cf={},_0x2a3172={},_0xff49a2={};for(let _0x37d066=0x0;_0x37d066<_0x16bc1d[_0x4b6ff8(0x1bf)];++_0x37d066){let _0x4ffaa6=_0x16bc1d[_0x37d066],_0x54ce07=_0x8c2742[_0x4ffaa6],_0x3bcc11=Math[_0x4b6ff8(0x212)](_0x54ce07[_0x4b6ff8(0x200)]);if(_0x1fc988[_0x4b6ff8(0x1b0)]&&_0x1fc988[_0x4b6ff8(0x1b0)][_0x4b6ff8(0x1bf)]>0x0){for(let _0x25ff8e=0x0;_0x25ff8e<_0x1fc988[_0x45c274(0x1e4)][_0x4b6ff8(0x1bf)];_0x25ff8e++){let _0x4efade=_0x1fc988[_0x4b6ff8(0x1b0)][_0x25ff8e];if(_0x3bcc11>=Math['abs'](_0x4efade[_0x4b6ff8(0x1c6)])&&_0x3bcc11<Math[_0x4b6ff8(0x212)](_0x4efade[_0x4b6ff8(0x1f9)])){let _0x223b67=Math[_0x4b6ff8(0x212)](_0x4efade[_0x4b6ff8(0x1c2)]);_0x46b4cf[_0x4ffaa6]=(_0x46b4cf[_0x4ffaa6]||0x0)+_0x223b67;break;}}if(_0x1867fc&&_0x46b4cf[_0x4ffaa6]){let _0x43e603=_0x46b4cf[_0x4ffaa6]*_0x1867fc/0x64;_0xff49a2[_0x4ffaa6]=_0x43e603,_0x46b4cf[_0x4ffaa6]-=_0x43e603;}if(_0xab1dc[_0x4b6ff8(0x217)]==0x1&&_0x5d4a07)_0x46b4cf[_0x4ffaa6]>_0x5d4a07?(_0x2a3172[_0x4ffaa6]=_0x5d4a07,_0x46b4cf[_0x4ffaa6]-=_0x5d4a07):(_0x2a3172[_0x4ffaa6]=_0x46b4cf[_0x4ffaa6],_0x46b4cf[_0x4ffaa6]=0x0);else{if(_0xab1dc[_0x45c274(0x20c)]==0x2&&_0x5d4a07){let _0x5c73b6=_0x2a3172[_0x4ffaa6]*_0x5d4a07/0x64;_0x2a3172[_0x4ffaa6]=_0x5c73b6,_0x46b4cf[_0x4ffaa6]=-_0x5c73b6;}}}else{if(_0x1fc988[_0x4b6ff8(0x20f)]!==null){if(_0x1fc988[_0x4b6ff8(0x211)]===null||_0x3bcc11>=_0x1fc988[_0x4b6ff8(0x211)]){let _0x1bd17a=Math[_0x4b6ff8(0x1b9)](_0x1fc988[_0x4b6ff8(0x20f)]/0x64*_0x3bcc11*0x64)/0x64;if(_0x1bd17a<0.01)continue;_0x46b4cf[_0x4ffaa6]=(_0x46b4cf[_0x4ffaa6]||0x0)+_0x1bd17a;}if(_0x1867fc&&_0x46b4cf[_0x4ffaa6]){let _0x410db5=_0x46b4cf[_0x4ffaa6]*_0x1867fc/0x64;_0xff49a2[_0x4ffaa6]=_0x410db5,_0x46b4cf[_0x4ffaa6]-=_0x410db5;}if(_0xab1dc[_0x4b6ff8(0x217)]==0x1&&_0x5d4a07&&_0x46b4cf[_0x4ffaa6])_0x46b4cf[_0x4ffaa6]>_0x5d4a07?(_0x2a3172[_0x4ffaa6]=_0x5d4a07,_0x46b4cf[_0x4ffaa6]-=_0x5d4a07):(_0x2a3172[_0x4ffaa6]=_0x46b4cf[_0x4ffaa6],_0x46b4cf[_0x4ffaa6]=0x0);else{if(_0xab1dc[_0x4b6ff8(0x217)]==0x2&&_0x5d4a07&&_0x46b4cf[_0x4ffaa6]){let _0x1dd78a=_0x46b4cf[_0x4ffaa6]*_0x5d4a07/0x64;_0x2a3172[_0x4ffaa6]=_0x1dd78a,_0x46b4cf[_0x4ffaa6]-=_0x1dd78a;}}}else _0xab1dc[_0x4b6ff8(0x217)]==0x1&&_0x5d4a07?_0x2a3172[_0x4ffaa6]=_0x5d4a07:_0x2a3172[_0x4ffaa6]=0x0;}}return{'rebateList':_0x46b4cf,'fixedScoreList':_0x2a3172,'bigWinUidArr':_0x16bc1d,'serverScoreFee':_0xff49a2};},services[a0_0xc7957a(0x22d)]=function(_0x5ec6a3,_0x5df68c){const _0x3c73f1=a0_0x4db625,_0x1a2fa1=a0_0xc7957a;let _0x4623e6=[];for(let _0x4c9ea3 in _0x5df68c){let _0x3872c1=_0x5df68c[_0x4c9ea3];if(!_0x3872c1||!_0x3872c1[_0x1a2fa1(0x200)]||_0x3872c1[_0x1a2fa1(0x200)]<=0x0)continue;_0x4623e6[_0x1a2fa1(0x1c8)]({'uid':_0x4c9ea3,'winScore':_0x3872c1[_0x3c73f1(0x206)]});}_0x4623e6[_0x1a2fa1(0x1b8)](function(_0x2bbcbb,_0x22872d){const _0x3d16ae=_0x1a2fa1;return _0x22872d[_0x3d16ae(0x200)]-_0x2bbcbb[_0x3d16ae(0x200)];});let _0x237e13=_0x5ec6a3[_0x1a2fa1(0x204)],_0x5538ff=0x64;_0x237e13[_0x1a2fa1(0x1df)]===-0x1?_0x5538ff=0x64:_0x5538ff=_0x237e13[_0x1a2fa1(0x1df)]||0x64;let _0x57a4f9=[],_0xb99438=_0x4623e6[0x0];for(let _0x137a49=0x0;_0x137a49<_0x4623e6[_0x3c73f1(0x1c3)];++_0x137a49){let _0x20ede5=_0x4623e6[_0x137a49];if(_0x20ede5[_0x1a2fa1(0x200)]<=0x0)continue;if(_0x5538ff<=0x0&&_0x20ede5[_0x3c73f1(0x206)]!==_0xb99438)break;_0x57a4f9[_0x1a2fa1(0x1c8)](_0x20ede5[_0x1a2fa1(0x1de)]),_0x5538ff--;}return _0x57a4f9;},services[a0_0xc7957a(0x1eb)]=async function(_0x57482a,_0x555474,_0x5ba327,_0x468266,_0xe963b8,_0xe4cbf2,_0x5bbd03,_0x20be5b,_0x35265b,_0x31a435=![]){const _0x137b7e=a0_0x4db625,_0x57d700=a0_0xc7957a;logger[_0x137b7e(0x202)]('['+_0x57482a+']['+_0x5bbd03+_0x57d700(0x1aa)+_0xe963b8+_0x57d700(0x1d4)+JSON[_0x137b7e(0x1fb)](_0x35265b)+_0x57d700(0x20c)+JSON[_0x57d700(0x1e2)](_0x5ba327)+_0x57d700(0x1d5)+JSON[_0x57d700(0x1e2)](_0x468266)+'\x20');let _0x2b63ac=[],_0x5a75ed=0x0,_0x363d18=0x0;for(let _0x244236 in _0x555474){if(_0x555474[_0x57d700(0x214)](_0x244236))try{let _0x477266=_0x555474[_0x244236];if(!_0x477266)continue;let _0x1b74d5=_0x477266[_0x137b7e(0x206)];_0x363d18+=0x1;let _0x19e459={'$inc':{'unionInfo.$.totalDraw':0x1,'unionInfo.$.weekDraw':0x1}};_0xe4cbf2[_0x57d700(0x219)](_0x244236)!==-0x1&&(_0x19e459[_0x57d700(0x1f2)][_0x57d700(0x1ab)]=0x1);let _0x5cafce=_0x5ba327[_0x244236]||0x0,_0x1c42b2=_0x468266[_0x244236]||0x0,_0x2d150c=_0x35265b[_0x244236]||0x0,_0x1537fc=_0x5cafce+_0x1c42b2+_0x2d150c;if(_0x1537fc>0x0){let _0x43d336=_0x1537fc;_0x19e459[_0x57d700(0x1f2)][_0x57d700(0x1da)]=-_0x43d336;}logger[_0x57d700(0x1c0)]('['+_0x57482a+']['+_0x5bbd03+']\x20uid\x20=\x20'+_0x244236+_0x57d700(0x1c5)+_0x1b74d5+_0x57d700(0x208)+_0x1537fc+_0x137b7e(0x1a1)+_0x2d150c+_0x57d700(0x222)+_0x5cafce+'\x20getFixedScore\x20=\x20'+_0x1c42b2+'\x20');let _0xad1393=await userDao[_0x57d700(0x1d9)]({'uid':_0x244236,'unionInfo.unionID':_0x57482a},_0x19e459);!_0xad1393&&_0x477266[_0x57d700(0x227)][_0x57d700(0x1fa)]&&(_0xad1393=await userDao['getUserDataByUid'](_0x244236)),_0xad1393[_0x137b7e(0x1bf)]&&await userInfoServices[_0x57d700(0x209)](_0xad1393[_0x57d700(0x1de)],_0xad1393['frontendId'],{'unionInfo':_0xad1393[_0x57d700(0x221)]})[_0x57d700(0x1ad)](_0x376bf5=>{});let _0x1f3961=_0xad1393[_0x137b7e(0x1e9)][_0x57d700(0x1bd)](function(_0x3c4d94){const _0x27c473=_0x57d700;return _0x3c4d94[_0x27c473(0x1d1)]===_0x57482a;}[_0x57d700(0x218)](this));_0x1f3961=_0x1f3961?_0x1f3961:{};if(_0x1537fc>0x0){let _0x23ac90={'uid':_0xad1393[_0x57d700(0x1de)],'nickname':_0xad1393[_0x57d700(0x21d)],'unionID':_0x57482a,'changeCount':-_0x1537fc,'leftCount':_0x1f3961[_0x57d700(0x225)],'leftSafeBoxCount':_0x1f3961[_0x57d700(0x1d0)],'leftSaveBoxCount':_0x1f3961[_0x57d700(0x1b6)],'gameType':_0x20be5b,'changeType':enumeration[_0x137b7e(0x1f1)][_0x137b7e(0x194)],'describe':_0x57d700(0x207)+_0x1537fc,'createTime':Date[_0x57d700(0x1e6)]()};await dao[_0x137b7e(0x1ee)](_0x137b7e(0x1c2),_0x23ac90)[_0x57d700(0x1ad)](_0x413ee2=>{logger['error'](_0x413ee2['stack']);});}_0x2d150c>0x0&&(await services[_0x57d700(0x1f4)](_0x2d150c,_0xad1393,_0x57482a,_0x5bbd03,_0x20be5b),logger['info']('['+_0x57482a+']['+_0x5bbd03+_0x57d700(0x220)+_0x2d150c+_0x57d700(0x1b7)+_0x244236+'\x20'),_0x2b63ac[_0x137b7e(0x207)]({'uid':_0xad1393[_0x57d700(0x1de)],'nickname':_0xad1393[_0x57d700(0x21d)],'unionID':_0x57482a,'changeCount':-_0x2d150c,'leftCount':_0x1f3961[_0x137b7e(0x1b2)]||0x0,'leftSafeBoxCount':_0x1f3961[_0x57d700(0x1d0)]||0x0,'leftSaveBoxCount':_0x1f3961[_0x57d700(0x1b6)]||0x0,'gameType':_0x20be5b,'changeType':enumeration[_0x57d700(0x22c)][_0x57d700(0x1cd)],'describe':'抽取服务费'+_0x2d150c,'createTime':moment()[_0x137b7e(0x1e3)]('x')})),_0x1c42b2>0x0&&(logger[_0x57d700(0x1c0)]('['+_0x57482a+']['+_0x5bbd03+_0x57d700(0x1e4)+_0x1c42b2+_0x57d700(0x1b7)+_0x244236+'\x20'),_0x2b63ac[_0x57d700(0x1c8)]({'uid':_0xad1393[_0x57d700(0x1de)],'nickname':_0xad1393[_0x57d700(0x21d)],'unionID':_0x57482a,'changeCount':-_0x1c42b2,'leftCount':_0x1f3961['score']||0x0,'leftSafeBoxCount':_0x1f3961[_0x57d700(0x1d0)]||0x0,'leftSaveBoxCount':_0x1f3961['saveScore']||0x0,'gameType':_0x20be5b,'changeType':enumeration[_0x57d700(0x22c)][_0x57d700(0x21b)],'describe':_0x57d700(0x202)+_0x1c42b2,'createTime':moment()[_0x57d700(0x21e)]('x')}),await services[_0x57d700(0x206)](_0x57482a,_0x5bbd03,_0x20be5b,_0x477266[_0x137b7e(0x1a6)],_0x1c42b2)),_0x5cafce>0x0&&(_0x2b63ac[_0x57d700(0x1c8)]({'uid':_0xad1393[_0x137b7e(0x1bc)],'nickname':_0xad1393[_0x57d700(0x21d)],'unionID':_0x57482a,'changeCount':-_0x5cafce,'leftCount':_0x1f3961[_0x57d700(0x225)]||0x0,'leftSafeBoxCount':_0x1f3961[_0x57d700(0x1d0)]||0x0,'changeType':enumeration[_0x57d700(0x22c)][_0x137b7e(0x194)],'leftSaveBoxCount':_0x1f3961[_0x57d700(0x1b6)],'gameType':_0x20be5b,'describe':_0x57d700(0x1dc)+_0x5cafce,'createTime':moment()[_0x137b7e(0x1e3)]('x')}),await services[_0x57d700(0x229)](_0x57482a,_0x5bbd03,_0x20be5b,_0x477266[_0x57d700(0x227)],null,null,_0x244236,_0x5cafce,_0xe4cbf2[_0x57d700(0x219)](_0x244236)!==-0x1));}catch(_0x4a0367){logger[_0x57d700(0x226)](_0x4a0367[_0x57d700(0x1dd)]);}}_0x2b63ac[_0x57d700(0x1bf)]>0x0&&await dao[_0x57d700(0x203)]('userScoreChangeRecordModel',_0x2b63ac)[_0x57d700(0x1ad)](_0x55e079=>{const _0x321e59=_0x57d700;logger[_0x321e59(0x226)](_0x55e079[_0x321e59(0x1dd)]);});},services[a0_0xc7957a(0x1c1)]=async function(_0x5389a8,_0x37ad2a,_0x43bd1b,_0x1996b5,_0x31cbf3,_0x253e06,_0x37ab60,_0x55199a,_0x3c39e8,_0x35c4e8=![]){const _0x2fc03d=a0_0x4db625,_0x43bb1c=a0_0xc7957a;logger[_0x43bb1c(0x1c0)]('['+_0x5389a8+']['+_0x37ab60+_0x43bb1c(0x1e5)+_0x31cbf3+_0x43bb1c(0x210)+JSON[_0x43bb1c(0x1e2)](_0x3c39e8)+_0x43bb1c(0x20c)+JSON[_0x2fc03d(0x1fb)](_0x43bd1b)+_0x43bb1c(0x1d5)+JSON[_0x43bb1c(0x1e2)](_0x1996b5)+'\x20');let _0x104c32=[],_0x61ff0=0x0,_0x576b5b=0x0,_0x442e76=0x0;for(let _0xd17f2d in _0x37ad2a){if(_0x37ad2a[_0x43bb1c(0x214)](_0xd17f2d)){let _0xdf0940=_0x37ad2a[_0xd17f2d];_0xdf0940[_0x43bb1c(0x227)]&&_0xdf0940[_0x2fc03d(0x1a6)][_0x43bb1c(0x216)]&&_0xdf0940[_0x43bb1c(0x227)][_0x2fc03d(0x1b9)]!=''&&(_0x61ff0+=0x1);}}for(let _0x545a50 in _0x37ad2a){if(_0x37ad2a['hasOwnProperty'](_0x545a50))try{let _0xb5b6b4=_0x37ad2a[_0x545a50];if(!_0xb5b6b4)continue;_0x442e76+=0x1;let _0x3767a9={'$inc':{'unionInfo.$.totalDraw':0x1,'unionInfo.$.weekDraw':0x1}};_0x253e06[_0x43bb1c(0x219)](_0x545a50)!==-0x1&&(_0x3767a9[_0x43bb1c(0x1f2)][_0x43bb1c(0x1ab)]=0x1);let _0x25c7b0=_0x43bd1b[_0x545a50]||0x0,_0x17ebe0=_0x1996b5[_0x545a50]||0x0,_0x57a542=_0x3c39e8[_0x545a50]||0x0,_0x396a36=_0x25c7b0+_0x17ebe0+_0x57a542;if(_0x396a36>0x0){let _0x39fba9=_0x396a36;_0x3767a9[_0x43bb1c(0x1f2)][_0x43bb1c(0x1da)]=-_0x39fba9;}logger[_0x43bb1c(0x1c0)]('['+_0x5389a8+']['+_0x37ab60+_0x43bb1c(0x1fc)+_0x545a50+_0x43bb1c(0x1c5)+_0xb5b6b4[_0x43bb1c(0x200)]+_0x43bb1c(0x208)+_0x396a36+_0x2fc03d(0x1a1)+_0x57a542+_0x43bb1c(0x222)+_0x25c7b0+_0x43bb1c(0x1ef)+_0x17ebe0+'\x20');let _0x34a64e=await userDao[_0x43bb1c(0x1d9)]({'uid':_0x545a50,'unionInfo.unionID':_0x5389a8},_0x3767a9);!_0x34a64e&&_0xb5b6b4['userInfo'][_0x43bb1c(0x1fa)]&&(_0x34a64e=await userDao['getUserDataByUid'](_0x545a50)),_0x34a64e[_0x43bb1c(0x1b4)]&&await userInfoServices['updateUserDataNotify'](_0x34a64e[_0x43bb1c(0x1de)],_0x34a64e[_0x2fc03d(0x1bf)],{'unionInfo':_0x34a64e[_0x43bb1c(0x221)]})[_0x2fc03d(0x200)](_0x1dde53=>{});let _0x3b5970=_0x34a64e[_0x43bb1c(0x221)][_0x43bb1c(0x1bd)](function(_0x1c4b93){const _0x1b52bd=_0x43bb1c;return _0x1c4b93[_0x1b52bd(0x1d1)]===_0x5389a8;}[_0x2fc03d(0x210)](this));_0x3b5970=_0x3b5970?_0x3b5970:{},_0x3b5970[_0x2fc03d(0x1be)]==0x1&&(_0x576b5b+=0x1);if(_0x396a36>0x0){let _0x476b58={'uid':_0x34a64e[_0x43bb1c(0x1de)],'nickname':_0x34a64e['nickname'],'unionID':_0x5389a8,'changeCount':-_0x396a36,'leftCount':_0x3b5970[_0x43bb1c(0x225)],'leftSafeBoxCount':_0x3b5970[_0x2fc03d(0x1b6)],'leftSaveBoxCount':_0x3b5970[_0x2fc03d(0x1ca)],'gameType':_0x55199a,'changeType':enumeration[_0x43bb1c(0x22c)][_0x43bb1c(0x1fe)],'describe':_0x43bb1c(0x207)+_0x396a36,'createTime':Date[_0x43bb1c(0x1e6)]()};await dao[_0x43bb1c(0x224)](_0x43bb1c(0x228),_0x476b58)['catch'](_0x5c4b66=>{const _0xc7ca8b=_0x43bb1c;logger[_0xc7ca8b(0x226)](_0x5c4b66[_0xc7ca8b(0x1dd)]);});}_0x57a542>0x0&&(await services[_0x43bb1c(0x1f4)](_0x57a542,_0x34a64e,_0x5389a8,_0x37ab60,_0x55199a),logger[_0x2fc03d(0x202)]('['+_0x5389a8+']['+_0x37ab60+_0x43bb1c(0x1ec)+_0x57a542+_0x2fc03d(0x214)+_0x545a50+'\x20'),_0x104c32[_0x43bb1c(0x1c8)]({'uid':_0x34a64e[_0x43bb1c(0x1de)],'nickname':_0x34a64e[_0x43bb1c(0x21d)],'unionID':_0x5389a8,'changeCount':-_0x57a542,'leftCount':_0x3b5970[_0x43bb1c(0x225)]||0x0,'leftSafeBoxCount':_0x3b5970[_0x43bb1c(0x1d0)]||0x0,'leftSaveBoxCount':_0x3b5970['saveScore'],'gameType':_0x55199a,'changeType':enumeration[_0x43bb1c(0x22c)][_0x43bb1c(0x1cd)],'describe':_0x43bb1c(0x1cc)+_0x57a542,'createTime':moment()[_0x43bb1c(0x21e)]('x')}));if(_0x25c7b0+_0x17ebe0>0x0){let _0x4a17df=_0x25c7b0,_0x411e82=Math[_0x43bb1c(0x1b9)](_0x25c7b0/_0x61ff0*0x64)/0x64,_0x5bf0a3=Math[_0x43bb1c(0x1b9)](_0x17ebe0/_0x61ff0*0x64)/0x64,_0x4f5db6=[],_0x17d3d6=[],_0x49e1fe=_0x17ebe0;for(let _0x359b4c=0x0;_0x359b4c<_0x61ff0;_0x359b4c++){_0x359b4c==_0x61ff0-0x1?(_0x4f5db6[_0x359b4c]=_0x4a17df,_0x17d3d6[_0x359b4c]=_0x49e1fe):(_0x4a17df>_0x411e82?(_0x4f5db6[_0x359b4c]=_0x411e82,_0x4a17df=parseFloat((_0x4a17df-_0x411e82)[_0x43bb1c(0x1d3)](0x2))):(_0x4f5db6[_0x359b4c]=_0x4a17df,_0x4a17df=0x0),_0x49e1fe>_0x5bf0a3?(_0x17d3d6[_0x359b4c]=_0x5bf0a3,_0x49e1fe=parseFloat((_0x49e1fe-_0x5bf0a3)[_0x43bb1c(0x1d3)](0x2))):(_0x49e1fe[_0x359b4c]=_0x49e1fe,_0x49e1fe=0x0));}logger['info']('['+_0x5389a8+']['+_0x37ab60+_0x43bb1c(0x1d6)+_0x17ebe0+_0x2fc03d(0x1b7)+_0x5bf0a3+_0x43bb1c(0x1f5)+JSON[_0x43bb1c(0x1e2)](_0x17d3d6)+_0x43bb1c(0x222)+_0x25c7b0+_0x43bb1c(0x1b5)+_0x411e82+_0x43bb1c(0x1b7)+_0x545a50+_0x2fc03d(0x1f4)+_0x61ff0+_0x43bb1c(0x1fb)+JSON[_0x2fc03d(0x1fb)](_0x4f5db6));for(let _0x31ed69 in _0x37ad2a){if(_0x37ad2a[_0x43bb1c(0x214)](_0x31ed69)){let _0x5bf986=_0x37ad2a[_0x31ed69];if(_0x5bf986[_0x43bb1c(0x227)]&&_0x5bf986[_0x43bb1c(0x227)][_0x43bb1c(0x216)]&&_0x5bf986[_0x43bb1c(0x227)][_0x43bb1c(0x216)]!=''){let _0x3cd123=_0x17d3d6[_0x43bb1c(0x205)]()||0x0;_0x3cd123>0x0&&(_0x104c32[_0x43bb1c(0x1c8)]({'uid':_0x34a64e[_0x43bb1c(0x1de)],'nickname':_0x34a64e[_0x2fc03d(0x1ef)],'unionID':_0x5389a8,'changeCount':-_0x3cd123,'leftCount':_0x3b5970[_0x43bb1c(0x225)]||0x0,'leftSafeBoxCount':_0x3b5970[_0x43bb1c(0x1d0)]||0x0,'leftSaveBoxCount':_0x3b5970[_0x2fc03d(0x1ca)],'gameType':_0x55199a,'changeType':enumeration[_0x43bb1c(0x22c)][_0x2fc03d(0x1eb)],'describe':_0x43bb1c(0x1e9)+_0x3cd123,'createTime':moment()[_0x43bb1c(0x21e)]('x')}),await services['execFixRebate'](_0x5389a8,_0x37ab60,_0x55199a,_0x5bf986[_0x2fc03d(0x1a6)],_0x3cd123));let _0x13fdb9=_0x4f5db6[_0x43bb1c(0x205)]()||0x0;_0x13fdb9>0x0&&(_0x104c32[_0x43bb1c(0x1c8)]({'uid':_0x34a64e[_0x43bb1c(0x1de)],'nickname':_0x34a64e[_0x43bb1c(0x21d)],'unionID':_0x5389a8,'changeCount':-_0x13fdb9,'leftCount':_0x3b5970[_0x43bb1c(0x225)]||0x0,'leftSafeBoxCount':_0x3b5970[_0x43bb1c(0x1d0)]||0x0,'leftSaveBoxCount':_0x3b5970[_0x43bb1c(0x1b6)],'gameType':_0x55199a,'changeType':enumeration[_0x43bb1c(0x22c)][_0x43bb1c(0x1fe)],'describe':_0x43bb1c(0x1dc)+_0x13fdb9,'createTime':moment()[_0x43bb1c(0x21e)]('x')}),await services[_0x43bb1c(0x229)](_0x5389a8,_0x37ab60,_0x55199a,_0x5bf986[_0x43bb1c(0x227)],null,null,_0x31ed69,_0x13fdb9,_0x253e06['indexOf'](_0x31ed69)!==-0x1));}}}}}catch(_0x5475c9){logger[_0x43bb1c(0x226)](_0x5475c9[_0x43bb1c(0x1dd)]);}}_0x104c32[_0x43bb1c(0x1bf)]>0x0&&await dao[_0x43bb1c(0x203)](_0x43bb1c(0x1ed),_0x104c32)[_0x43bb1c(0x1ad)](_0x304496=>{const _0x527cbe=_0x43bb1c;logger[_0x527cbe(0x226)](_0x304496[_0x527cbe(0x1dd)]);});},services[a0_0xc7957a(0x1f4)]=async function(_0x207e4d,_0x503b81,_0x731542,_0x61e57f,_0x1dec11){const _0x1bfaff=a0_0x4db625,_0x47cb65=a0_0xc7957a;let _0x587be7=await pomelo[_0x1bfaff(0x1a3)][_0x47cb65(0x1f8)][_0x1bfaff(0x209)](_0x731542),_0x56f3a2=_0x587be7['getOwnerUid'](),_0x49fcf2={'$inc':{'unionInfo.$.safeScore':_0x207e4d,'unionInfo.$.todayRebate':_0x207e4d,'unionInfo.$.totalRebate':_0x207e4d}},_0x48d0e0=await userDao[_0x47cb65(0x1d9)]({'uid':_0x56f3a2,'unionInfo.unionID':_0x731542},_0x49fcf2);_0x48d0e0[_0x47cb65(0x1b4)]&&await userInfoServices[_0x47cb65(0x209)](_0x48d0e0[_0x47cb65(0x1de)],_0x48d0e0[_0x47cb65(0x1b4)],{'unionInfo':_0x48d0e0[_0x47cb65(0x221)]})[_0x1bfaff(0x200)](_0x425130=>{});let _0x1afb71={'uid':_0x56f3a2,'roomID':_0x61e57f,'gameType':_0x1dec11,'unionID':_0x731542,'playerUid':_0x503b81['uid'],'playerNickname':_0x503b81[_0x1bfaff(0x1ef)],'playerAvatar':_0x503b81['avatar'],'totalCount':_0x207e4d,'gainCount':_0x207e4d,'start':!![],'type':enumeration[_0x47cb65(0x22c)][_0x47cb65(0x1cd)],'createTime':Date['now']()};await dao[_0x47cb65(0x224)](_0x47cb65(0x1e7),_0x1afb71)[_0x47cb65(0x1ad)](_0x31decd=>{const _0x49e7e1=_0x47cb65;logger[_0x49e7e1(0x226)](_0x31decd[_0x49e7e1(0x1dd)]);});},services[a0_0xc7957a(0x1f6)]=async function(_0x1eb6e6,_0x4d5880,_0x49d67c,_0x62cb4,_0x1bd5c6){const _0x4bbb47=a0_0x4db625,_0x13f348=a0_0xc7957a;let _0x45772c=await pomelo[_0x4bbb47(0x1a3)][_0x13f348(0x1f8)][_0x4bbb47(0x209)](_0x49d67c),_0x4bd2da=_0x45772c[_0x4bbb47(0x1c9)](),_0x278297={'$inc':{'unionInfo.$.safeScore':_0x1eb6e6,'unionInfo.$.todayRebate':_0x1eb6e6,'unionInfo.$.totalRebate':_0x1eb6e6}},_0x5e3877=await userDao[_0x13f348(0x1d9)]({'uid':_0x4bd2da,'unionInfo.unionID':_0x49d67c},_0x278297);_0x5e3877[_0x13f348(0x1b4)]&&await userInfoServices[_0x13f348(0x209)](_0x5e3877[_0x13f348(0x1de)],_0x5e3877[_0x13f348(0x1b4)],{'unionInfo':_0x5e3877[_0x13f348(0x221)]})[_0x13f348(0x1ad)](_0x24b28b=>{});let _0x582841={'uid':_0x4bd2da,'roomID':_0x62cb4,'gameType':_0x1bd5c6,'unionID':_0x49d67c,'playerUid':_0x4d5880['uid'],'playerNickname':_0x4d5880[_0x13f348(0x21d)],'playerAvatar':_0x4d5880['avatar'],'totalCount':_0x1eb6e6,'gainCount':_0x1eb6e6,'start':!![],'type':enumeration[_0x13f348(0x22c)][_0x13f348(0x21b)],'createTime':Date[_0x4bbb47(0x1f9)]()};await dao[_0x13f348(0x224)](_0x13f348(0x1e7),_0x582841)[_0x13f348(0x1ad)](_0x422d91=>{const _0x55d086=_0x13f348;logger[_0x55d086(0x226)](_0x422d91[_0x55d086(0x1dd)]);});},services[a0_0x4db625(0x191)]=async function(_0x35952f,_0x521aad,_0x32d076,_0x3aef28,_0x6fe5bf){const _0x1256ee=a0_0x4db625,_0x48675f=a0_0xc7957a;if(_0x6fe5bf<=0x0)return;logger[_0x48675f(0x1c0)]('['+_0x35952f+']['+_0x521aad+_0x48675f(0x1ac)+_0x35952f+_0x48675f(0x1cb)+_0x521aad+_0x48675f(0x1ea)+_0x3aef28[_0x48675f(0x1de)]+_0x48675f(0x1d2)+_0x6fe5bf+'\x20');let _0x4494dd=await userInfoServices[_0x48675f(0x20e)](_0x3aef28[_0x48675f(0x1de)],_0x35952f);_0x4494dd[_0x48675f(0x1b8)]((_0x509fc7,_0x4b01e4)=>_0x4b01e4[_0x48675f(0x20d)]-_0x509fc7['count']);let _0x3e84d2=[],_0x3673e9=![];if(_0x3673e9){logger[_0x48675f(0x1c0)]('['+_0x35952f+']['+_0x521aad+_0x48675f(0x1ca));let _0x38981b=_0x4494dd[0x0],_0xd2c1ad={'uid':_0x38981b[_0x1256ee(0x1ab)],'count':_0x6fe5bf,'lowUid':_0x3aef28[_0x48675f(0x1de)]};_0x3e84d2['push'](_0xd2c1ad);}else{logger[_0x48675f(0x1c0)]('['+_0x35952f+']['+_0x521aad+_0x1256ee(0x19d));let _0x4c4c5a=_0x6fe5bf;if(_0x4494dd[_0x48675f(0x1bf)]>0x0)for(let _0x276a26=0x0;_0x276a26<_0x4494dd[_0x48675f(0x1bf)];_0x276a26++){let _0x8dce23=_0x4494dd[_0x276a26];if(!_0x8dce23)continue;let _0x5eb2cd=_0x4494dd['find'](_0x3d4ed8=>_0x3d4ed8[_0x48675f(0x216)]&&_0x3d4ed8[_0x48675f(0x216)][_0x1256ee(0x197)]()==_0x8dce23[_0x48675f(0x22e)][_0x48675f(0x1ff)]());if(_0x5eb2cd){let _0x2caed3=_0x5eb2cd[_0x48675f(0x1c4)];if(_0x4c4c5a<0.1||_0x2caed3<=0x0){let _0x2de5da={'uid':_0x8dce23[_0x48675f(0x22e)],'count':_0x4c4c5a,'lowUid':_0x5eb2cd[_0x48675f(0x22e)]};_0x3e84d2[_0x48675f(0x1c8)](_0x2de5da);break;}else{let _0x38b867=Math[_0x48675f(0x1b9)](_0x4c4c5a*(0x64-_0x2caed3))/0x64,_0x4dd95e={'uid':_0x8dce23[_0x48675f(0x22e)],'count':_0x38b867,'lowUid':_0x5eb2cd[_0x48675f(0x22e)]};_0x3e84d2['push'](_0x4dd95e),_0x4c4c5a=Math[_0x48675f(0x1b9)]((_0x4c4c5a-_0x38b867)*0x64)/0x64;}}else{let _0x26084a={'uid':_0x8dce23[_0x48675f(0x22e)],'count':_0x4c4c5a,'lowUid':_0x8dce23[_0x48675f(0x22e)]};_0x3e84d2[_0x48675f(0x1c8)](_0x26084a);break;}}else logger[_0x1256ee(0x1b1)]('['+_0x35952f+']['+_0x521aad+_0x48675f(0x1b1)+_0x35952f+_0x48675f(0x1cb)+_0x521aad+'\x20userID\x20=\x20'+_0x3aef28[_0x48675f(0x1de)]+_0x48675f(0x201)+JSON[_0x1256ee(0x1fb)](_0x4494dd)+'\x20');}logger[_0x48675f(0x1c0)]('['+_0x35952f+']['+_0x521aad+_0x48675f(0x1be)+JSON[_0x48675f(0x1e2)](_0x3e84d2)+'\x20');for(let _0x52c438=0x0;_0x52c438<_0x3e84d2[_0x48675f(0x1bf)];_0x52c438++){let _0x386aa4=_0x3e84d2[_0x52c438],_0xfac640=_0x386aa4[_0x48675f(0x20d)]||0x0,_0x3dbfab={'$inc':{'unionInfo.$.safeScore':_0xfac640,'unionInfo.$.todayRebate':_0xfac640,'unionInfo.$.totalRebate':_0xfac640}},_0x18588d=await userDao[_0x48675f(0x1d9)]({'uid':_0x386aa4['uid'],'unionInfo.unionID':_0x35952f},_0x3dbfab);!!_0x18588d[_0x48675f(0x1b4)]&&await userInfoServices[_0x48675f(0x209)](_0x18588d[_0x48675f(0x1de)],_0x18588d[_0x48675f(0x1b4)],{'unionInfo':_0x18588d[_0x1256ee(0x1e9)]})[_0x48675f(0x1ad)](_0x341605=>{}),!!_0x386aa4[_0x1256ee(0x213)]&&await userDao[_0x48675f(0x1d9)]({'uid':_0x386aa4[_0x48675f(0x1c3)],'unionInfo.unionID':_0x35952f},{'$inc':{'unionInfo.$.todayProvideRebate':_0xfac640}});let _0x3dde3a={'uid':_0x18588d[_0x48675f(0x1de)],'nickname':_0x18588d[_0x48675f(0x21d)],'avatar':_0x18588d[_0x48675f(0x1c7)],'roomID':_0x521aad,'gameType':_0x32d076,'unionID':_0x35952f,'playerUid':_0x3aef28[_0x48675f(0x1de)],'playerNickname':_0x3aef28[_0x48675f(0x21d)],'playerAvatar':_0x3aef28[_0x1256ee(0x1ad)],'totalCount':_0x6fe5bf,'gainCount':_0xfac640,'start':!![],'type':enumeration[_0x1256ee(0x1f1)][_0x48675f(0x21b)],'createTime':Date[_0x1256ee(0x1f9)]()};await dao[_0x48675f(0x224)]('userRebateRecordModel',_0x3dde3a)[_0x48675f(0x1ad)](_0x2194b2=>{const _0x4baf94=_0x48675f;logger[_0x4baf94(0x226)](_0x2194b2[_0x4baf94(0x1dd)]);});}},services[a0_0xc7957a(0x21c)]=async function(_0x2a643c,_0x2b38e6,_0x4b9b88,_0x169cf0,_0x2fcfe1){const _0x3ae19e=a0_0xc7957a;if(_0x2b38e6[_0x3ae19e(0x1e1)]===undefined||_0x2b38e6[_0x3ae19e(0x1e1)]===null||_0x2b38e6[_0x3ae19e(0x1e1)]<=0x0)return;let _0x48a9ea=parseFloat(_0x2b38e6[_0x3ae19e(0x1e1)]),_0x42350c=[];for(let _0x4e1b7d in _0x4b9b88){let _0x2ff477=_0x4b9b88[_0x4e1b7d];if(!_0x2ff477)continue;let _0x2aafdf={'$inc':{'unionInfo.$.score':-_0x48a9ea}},_0xae8cfd=await userDao[_0x3ae19e(0x1d9)]({'uid':_0x4e1b7d,'unionInfo.unionID':_0x2a643c},_0x2aafdf);_0xae8cfd[_0x3ae19e(0x1b4)]&&userInfoServices[_0x3ae19e(0x209)](_0xae8cfd[_0x3ae19e(0x1de)],_0xae8cfd['frontendId'],{'unionInfo':_0xae8cfd[_0x3ae19e(0x221)]})[_0x3ae19e(0x1ad)](_0x153e59=>{});let _0x33b1c6=_0xae8cfd[_0x3ae19e(0x221)][_0x3ae19e(0x1bd)](function(_0x4b5708){const _0x88d0e=_0x3ae19e;return _0x4b5708[_0x88d0e(0x1d1)]===_0x2a643c;}[_0x3ae19e(0x218)](this));_0x42350c[_0x3ae19e(0x1c8)]({'uid':_0xae8cfd['uid'],'nickname':_0xae8cfd[_0x3ae19e(0x21d)],'unionID':_0x2a643c,'changeCount':-_0x48a9ea,'leftCount':_0x33b1c6[_0x3ae19e(0x225)],'leftSafeBoxCount':_0x33b1c6[_0x3ae19e(0x1d0)],'leftSaveBoxCount':_0x33b1c6[_0x3ae19e(0x1b6)],'gameType':_0x2fcfe1,'changeType':enumeration[_0x3ae19e(0x22c)][_0x3ae19e(0x1af)],'describe':_0x3ae19e(0x1e3)+_0x48a9ea,'createTime':Date[_0x3ae19e(0x1e6)]()}),await services[_0x3ae19e(0x1a9)](_0x2a643c,_0x169cf0,_0x2fcfe1,_0x2ff477[_0x3ae19e(0x227)],_0x48a9ea);}_0x42350c[_0x3ae19e(0x1bf)]>0x0&&(await dao[_0x3ae19e(0x203)](_0x3ae19e(0x1ed),_0x42350c)['catch'](_0x6179c3=>{const _0xf49ee9=_0x3ae19e;logger[_0xf49ee9(0x226)](_0x6179c3[_0xf49ee9(0x1dd)]);}),await dao[_0x3ae19e(0x203)]('userScoreDetailModel',_0x42350c)[_0x3ae19e(0x1ad)](_0x4331ff=>{const _0x5218eb=a0_0x1521,_0x35626b=_0x3ae19e;logger[_0x35626b(0x226)](_0x4331ff[_0x5218eb(0x1aa)]);}));},services[a0_0xc7957a(0x1a9)]=async function(_0x295838,_0x2df5eb,_0x33a8ba,_0x2cf6ec,_0x376387){const _0xc6a678=a0_0x4db625,_0x2a6eee=a0_0xc7957a;if(_0x376387<=0x0)return;logger[_0x2a6eee(0x1c0)]('['+_0x295838+']['+_0x2df5eb+_0x2a6eee(0x1f0)+_0x295838+_0x2a6eee(0x1cb)+_0x2df5eb+_0x2a6eee(0x1ea)+_0x2cf6ec[_0x2a6eee(0x1de)]+_0x2a6eee(0x1d2)+_0x376387+'\x20');let _0x1ffd4a=await userInfoServices[_0x2a6eee(0x20e)](_0x2cf6ec[_0x2a6eee(0x1de)],_0x295838);_0x1ffd4a[_0x2a6eee(0x1b8)]((_0x3f1591,_0x1876b1)=>_0x1876b1[_0x2a6eee(0x20d)]-_0x3f1591[_0x2a6eee(0x20d)]);let _0x3d15ca=[],_0x66503f=!![];if(_0x66503f){logger[_0x2a6eee(0x1c0)]('['+_0x295838+']['+_0x2df5eb+_0x2a6eee(0x1ee));let _0x3cd3a0=_0x1ffd4a[0x0],_0x46181f={'uid':_0x3cd3a0[_0x2a6eee(0x22e)],'count':_0x376387,'lowUid':_0x2cf6ec[_0x2a6eee(0x1de)]};_0x3d15ca['push'](_0x46181f);}else{logger[_0x2a6eee(0x1c0)]('['+_0x295838+']['+_0x2df5eb+_0x2a6eee(0x1f1));let _0x163d97=_0x376387;if(_0x1ffd4a[_0x2a6eee(0x1bf)]>0x0)for(let _0x2a6fb3=0x0;_0x2a6fb3<_0x1ffd4a[_0xc6a678(0x1c3)];_0x2a6fb3++){let _0x4f9014=_0x1ffd4a[_0x2a6fb3];if(!_0x4f9014)continue;let _0x2b33a7=_0x1ffd4a[_0x2a6eee(0x1bd)](_0x15d77b=>_0x15d77b['spreaderID']&&_0x15d77b[_0x2a6eee(0x216)][_0x2a6eee(0x1ff)]()==_0x4f9014[_0x2a6eee(0x22e)][_0xc6a678(0x197)]());if(_0x2b33a7){let _0x473fa9=_0x2b33a7[_0x2a6eee(0x21a)];if(_0x163d97<0.1||_0x473fa9<=0x0){let _0x336a1d={'uid':_0x4f9014[_0x2a6eee(0x22e)],'count':_0x163d97,'lowUid':_0x2b33a7[_0x2a6eee(0x22e)]};_0x3d15ca[_0x2a6eee(0x1c8)](_0x336a1d);break;}else{let _0x41456d=Math[_0xc6a678(0x1bb)](_0x163d97*(0x1-_0x473fa9)*0x64)/0x64,_0x1b7d01={'uid':_0x4f9014[_0xc6a678(0x1ab)],'count':_0x41456d,'lowUid':_0x2b33a7[_0x2a6eee(0x22e)]};_0x3d15ca[_0x2a6eee(0x1c8)](_0x1b7d01),_0x163d97=Math[_0x2a6eee(0x1b9)]((_0x163d97-_0x41456d)*0x64)/0x64;}}else{let _0x380111={'uid':_0x4f9014[_0x2a6eee(0x22e)],'count':_0x163d97,'lowUid':_0x4f9014[_0xc6a678(0x1ab)]};_0x3d15ca[_0x2a6eee(0x1c8)](_0x380111);break;}}else logger[_0x2a6eee(0x226)]('['+_0x295838+']['+_0x2df5eb+_0x2a6eee(0x1b2)+_0x295838+_0x2a6eee(0x1cb)+_0x2df5eb+_0x2a6eee(0x1ea)+_0x2cf6ec[_0xc6a678(0x1bc)]+_0x2a6eee(0x201)+JSON[_0x2a6eee(0x1e2)](_0x1ffd4a)+'\x20');}logger[_0x2a6eee(0x1c0)]('['+_0x295838+']['+_0x2df5eb+_0x2a6eee(0x1db)+JSON[_0x2a6eee(0x1e2)](_0x3d15ca)+'\x20');for(let _0x2c0ad3=0x0;_0x2c0ad3<_0x3d15ca['length'];_0x2c0ad3++){let _0x5d5989=_0x3d15ca[_0x2c0ad3],_0x14de55=_0x5d5989[_0xc6a678(0x1ba)]||0x0,_0x1eed72={'$inc':{'unionInfo.$.safeScore':_0x14de55,'unionInfo.$.todayRebate':_0x14de55,'unionInfo.$.totalRebate':_0x14de55}},_0x2ee60c=await userDao[_0x2a6eee(0x1d9)]({'uid':_0x5d5989[_0x2a6eee(0x1de)],'unionInfo.unionID':_0x295838},_0x1eed72);!!_0x2ee60c[_0x2a6eee(0x1b4)]&&await userInfoServices[_0x2a6eee(0x209)](_0x2ee60c[_0x2a6eee(0x1de)],_0x2ee60c[_0x2a6eee(0x1b4)],{'unionInfo':_0x2ee60c[_0x2a6eee(0x221)]})[_0x2a6eee(0x1ad)](_0x2ca9bd=>{}),!!_0x5d5989[_0x2a6eee(0x1c3)]&&await userDao[_0x2a6eee(0x1d9)]({'uid':_0x5d5989[_0x2a6eee(0x1c3)],'unionInfo.unionID':_0x295838},{'$inc':{'unionInfo.$.todayProvideRebate':_0x14de55}});let _0x45fc6f={'uid':_0x2ee60c[_0x2a6eee(0x1de)],'nickname':_0x2ee60c['nickname'],'avatar':_0x2ee60c[_0x2a6eee(0x1c7)],'roomID':_0x2df5eb,'gameType':_0x33a8ba,'unionID':_0x295838,'playerUid':_0x2cf6ec[_0x2a6eee(0x1de)],'playerNickname':_0x2cf6ec[_0x2a6eee(0x21d)],'playerAvatar':_0x2cf6ec[_0xc6a678(0x1ad)],'totalCount':_0x376387,'gainCount':_0x14de55,'start':!![],'type':enumeration[_0x2a6eee(0x22c)][_0x2a6eee(0x1af)],'createTime':Date[_0x2a6eee(0x1e6)]()};await dao[_0x2a6eee(0x224)](_0x2a6eee(0x1e7),_0x45fc6f)[_0x2a6eee(0x1ad)](_0x99b19a=>{const _0x1494c2=_0x2a6eee;logger[_0x1494c2(0x226)](_0x99b19a[_0x1494c2(0x1dd)]);});}};function a0_0x4db1(){const _0x1e0e8b=['5JBuMAw','moment','safeScore','\x20fixAvgScore\x20=\x20','minScore','spreaderID','count','floor','uid','808158yzgEkl','todayDraw','frontendId',']\x20pay\x20serverFee\x20=\x20','\x20userSpreadList\x20=\x20','userScoreDetailModel','length','updateUserDataNotify','fixScore','../constant/code','1304432qMLvxb','clone','getOwnerUid','saveScore','pomelo-logger','\x20scoreList\x20=\x20','11fHRqSD','253548QuddbT',']\x20获取门票会层级返利\x20','UNION_SERVICE','ticketRate','getSPreadLevelAsync','\x20roomID\x20=\x20','addServerScore','roomPayRule','169816ZXlURr',']\x20pay\x20serverScore\x20=\x20','getBigWinUidArr','2402056tKfhoL','userRebateRecordModel','2158470HQayFM','userScoreChangeRecordModel','$inc','percentMinWinScore',']\x20single\x20rebate\x20detail\x20\x20serverScore\x20=\x20','execTicketRebate','\x20userID\x20=\x20','2400219gaOfRJ','format','ladderScore','../constant/enumeration','shift','unionInfo.$.memberTodayDraw','\x20fixScoreList\x20=\x20','unionInfo','274757IcSEwC','FIX_SCORE',']\x20门票返利明细\x20rebateRateList\x20=\x20','rebateRate','createData','nickname','./userInfoServices','scoreChangeType','unionInfo.$.memberTodayBigWinDraw',']\x20返利获取失败\x20unionID\x20=\x20','\x20\x20totalSpreaderCount\x20=\x20','4511056zxJRxE',']\x20只有盟主收取保底\x20','toFixed','rebateScore','now','14uQLcGK','stringify',']\x20uid\x20=\x20','\x20fixedScoreList\x20=\x20','58422BSQZCr','363696qkYoIt','catch','3LSgNSB','info','抽取门票','isRobot','\x20rebateTotal\x20=\x20','winScore','push','GAME_START_UNION_CHOU','getUnion',']\x20获取保底返利\x20unionID\x20=\x20','%\x20\x20serverScoreFee\x20=\x20','fixScoreType','maxScore','\x20winScore\x20=\x20','12loApgZ','bind','rebateDouble','\x20getFixedScore\x20=\x20','lowUid','\x20uid\x20=\x20','%\x20serverScoreFee\x20=\x20','rebate','execFixRebate','ticketScore','createDataArr','GAME_WIN_CHOU','sort','exports','toString','percentScore','../dao/userDao','1lVuXVL','\x20rebateCount\x20=\x20','unionID',']\x20获取保底会层级返利\x20','hasOwnProperty','抽取保底',']\x20pay\x20fixedScore\x20=\x20','\x20serverFee\x20=\x20','pop','app','保底抽分','\x20count\x20=\x20','userInfo','updateUserData','9ifubHi','pomelo','stack','userId','rebateSingle','avatar','70926KZiawp','addFixedScore',']\x20rebateRateList\x20=\x20','error','score',']\x20fixScore\x20=\x20'];a0_0x4db1=function(){return _0x1e0e8b;};return a0_0x4db1();}